import{iS as c,iT as y,iO as A,iP as F,dg as f}from"./chunk-CuaFhuP3.js";import{a as S,K as p,b as u,q as m,i as h}from"./chunk-mCK8WXPa.js";import{l as s}from"./chunk-Dnu95T0i.js";import{R as d,i as w}from"./chunk-C7WHcUmR.js";import"./chunk-Dpk1TJd9.js";import"./chunk-iOPJXyP1.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */import"./chunk-DGmg3LSc.js";import"./chunk-BPVd6ESQ.js";import"./chunk-Dwg2b3X_.js";import"./chunk-CjfP9KU1.js";import"./chunk-DHiB1uzW.js";import"./chunk-DqYIo1DU.js";import"./chunk-CcEbRgUF.js";async function e(r,i,t,a){if(t.length===1){if(c(t[0]))return s(r,t[0],m(t[1],-1));if(u(t[0]))return s(r,t[0].toArray(),m(t[1],-1))}else if(t.length===2){if(c(t[0]))return s(r,t[0],m(t[1],-1));if(u(t[0]))return s(r,t[0].toArray(),m(t[1],-1));if(p(t[0])){const n=await t[0].load(),o=await g(d.create(t[1],{fieldsIndex:n.getFieldsIndex(),timeZone:n.dateFieldsTimeZoneDefaultUTC}),a,i);return l(i,await t[0].calculateStatistic(r,o,m(t[2],1e3),i.abortSignal))}}else if(t.length===3&&p(t[0])){const n=await t[0].load(),o=await g(d.create(t[1],{fieldsIndex:n.getFieldsIndex(),timeZone:n.dateFieldsTimeZoneDefaultUTC}),a,i);return l(i,await t[0].calculateStatistic(r,o,m(t[2],1e3),i.abortSignal))}return s(r,t,-1)}function l(r,i){return i instanceof w?f.fromReaderAsTimeStampOffset(i.toStorageFormat()):i instanceof Date?f.dateJSAndZoneToArcadeDate(i,h(r)):i}async function g(r,i,t){const a=r.getVariables();if(a.length>0){const n={};for(const o of a)n[o]=i.evaluateIdentifier(t,{name:o});r.parameters=n}return r}function At(r){r.mode==="async"&&(r.functions.stdev=function(i,t){return r.standardFunctionAsync(i,t,((a,n,o)=>e("stdev",i,o,r)))},r.functions.variance=function(i,t){return r.standardFunctionAsync(i,t,((a,n,o)=>e("variance",i,o,r)))},r.functions.average=function(i,t){return r.standardFunctionAsync(i,t,((a,n,o)=>e("mean",i,o,r)))},r.functions.mean=function(i,t){return r.standardFunctionAsync(i,t,((a,n,o)=>e("mean",i,o,r)))},r.functions.sum=function(i,t){return r.standardFunctionAsync(i,t,((a,n,o)=>e("sum",i,o,r)))},r.functions.min=function(i,t){return r.standardFunctionAsync(i,t,((a,n,o)=>e("min",i,o,r)))},r.functions.max=function(i,t){return r.standardFunctionAsync(i,t,((a,n,o)=>e("max",i,o,r)))},r.functions.count=function(i,t){return r.standardFunctionAsync(i,t,(async(a,n,o)=>{if(S(o,1,1,i,t),p(o[0]))return o[0].count(a.abortSignal);if(c(o[0])||y(o[0]))return o[0].length;if(u(o[0]))return o[0].length();throw new A(i,F.InvalidParameter,t)}))})}export{At as registerFunctions};
