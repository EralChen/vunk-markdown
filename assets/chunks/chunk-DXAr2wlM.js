import{af as s,ag as i,ai as g,s as v,g9 as x,j as E,aL as $,$ as p,ga as D,gb as F}from"./chunk-CuaFhuP3.js";import"./chunk-Dpk1TJd9.js";import{i as N}from"./chunk-PM-0Myzz.js";const O=c=>{let e=class extends c{constructor(){super(...arguments),this.view=null}get timeExtent(){return N(this.layer,this.view?.timeExtent,this._get("timeExtent"))}async fetchPopupFeaturesAtLocation(o,n){const{layer:r}=this;if(!o)throw new v("imagerylayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:r});const{popupEnabled:m}=r,l=x(r,n);if(!m||l==null)return[];const y=await l.getRequiredFields();E(n);const t=new $;t.timeExtent=this.timeExtent,t.geometry=o,t.outFields=y,t.outSpatialReference=o.spatialReference;const{resolution:a,spatialReference:u}=this.view,h=this.view.type==="2d"?new p(a,a,u):new p(.5*a,.5*a,u),{returnTopmostRaster:w,showNoDataRecords:d}=l.layerOptions||{returnTopmostRaster:!0,showNoDataRecords:!1},R={returnDomainValues:!0,returnTopmostRaster:w,pixelSize:h,showNoDataRecords:d,signal:n?.signal};return r.queryVisibleRasters(t,R).then((f=>f))}async getSourceScale(){return await F(),await this.layer.load(),D(this.layer.serviceRasterInfo,this.view.spatialReference)}canResume(){return!!super.canResume()&&!this.timeExtent?.isEmpty}};return s([i()],e.prototype,"layer",void 0),s([i()],e.prototype,"suspended",void 0),s([i({readOnly:!0})],e.prototype,"timeExtent",null),s([i()],e.prototype,"view",void 0),e=s([g("esri.views.layers.ImageryLayerView")],e),e};export{O as m};
