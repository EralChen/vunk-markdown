import{hg as s,hd as y,cn as f}from"./chunk-DB7j5ecc.js";import{a as F,r as A}from"./chunk-D6UyxDs2.js";import{u as h,B as u,g as p,z as c,J as m,K as w}from"./chunk-wSb2rIUu.js";import{D as d,i as S}from"./chunk-BQ69bEEn.js";import"./chunk-BtTM1THp.js";import"./chunk-mTyH_f-_.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */import"./chunk-BPVd6ESQ.js";import"./chunk-DYpSdmE1.js";import"./chunk-x0z5gPKM.js";import"./chunk-Dn80I-W3.js";import"./chunk-CcEbRgUF.js";async function e(i,r,t,a){if(t.length===1){if(s(t[0]))return c(i,t[0],m(t[1],-1));if(p(t[0]))return c(i,t[0].toArray(),m(t[1],-1))}else if(t.length===2){if(s(t[0]))return c(i,t[0],m(t[1],-1));if(p(t[0]))return c(i,t[0].toArray(),m(t[1],-1));if(u(t[0])){const n=await t[0].load(),o=await g(d.create(t[1],{fieldsIndex:n.getFieldsIndex(),timeZone:n.dateFieldsTimeZoneDefaultUTC}),a,r);return l(r,await t[0].calculateStatistic(i,o,m(t[2],1e3),r.abortSignal))}}else if(t.length===3&&u(t[0])){const n=await t[0].load(),o=await g(d.create(t[1],{fieldsIndex:n.getFieldsIndex(),timeZone:n.dateFieldsTimeZoneDefaultUTC}),a,r);return l(r,await t[0].calculateStatistic(i,o,m(t[2],1e3),r.abortSignal))}return c(i,t,-1)}function l(i,r){return r instanceof S?f.fromReaderAsTimeStampOffset(r.toStorageFormat()):r instanceof Date?f.dateJSAndZoneToArcadeDate(r,w(i)):r}async function g(i,r,t){const a=i.getVariables();if(a.length>0){const n={};for(const o of a)n[o]=r.evaluateIdentifier(t,{name:o});i.parameters=n}return i}function gt(i){i.mode==="async"&&(i.functions.stdev=function(r,t){return i.standardFunctionAsync(r,t,(a,n,o)=>e("stdev",r,o,i))},i.functions.variance=function(r,t){return i.standardFunctionAsync(r,t,(a,n,o)=>e("variance",r,o,i))},i.functions.average=function(r,t){return i.standardFunctionAsync(r,t,(a,n,o)=>e("mean",r,o,i))},i.functions.mean=function(r,t){return i.standardFunctionAsync(r,t,(a,n,o)=>e("mean",r,o,i))},i.functions.sum=function(r,t){return i.standardFunctionAsync(r,t,(a,n,o)=>e("sum",r,o,i))},i.functions.min=function(r,t){return i.standardFunctionAsync(r,t,(a,n,o)=>e("min",r,o,i))},i.functions.max=function(r,t){return i.standardFunctionAsync(r,t,(a,n,o)=>e("max",r,o,i))},i.functions.count=function(r,t){return i.standardFunctionAsync(r,t,async(a,n,o)=>{if(h(o,1,1,r,t),u(o[0]))return o[0].count(a.abortSignal);if(s(o[0])||y(o[0]))return o[0].length;if(p(o[0]))return o[0].length();throw new F(r,A.InvalidParameter,t)})})}export{gt as registerFunctions};
