import{cP as D,_ as m,cQ as S,cR as w,cS as p,cT as E,cU as b,cV as $,cW as y,b0 as i,cr as T,cX as U,cY as R,bm as h,cZ as k,c_ as F,c$ as C,ct as x,d0 as _,d1 as A,d2 as H,bZ as I,d3 as q,d4 as G,b2 as K,b1 as Z}from"./chunk-B0S82j6z.js";import{D as j}from"./chunk-B30TyPpj.js";function z(e,r){return M(e,()=>r)}function L(e){return M(e,r=>r.plane)}function M(e,r){const t=i(),l=i();let s=!1;return n=>{const c=r(n);if(n.action==="start"){const o=p(n.screenStart,E(b.get())),u=$(e.state.camera,o,g);u!=null&&(s=y(c,u,t))}if(!s)return null;const a=p(n.screenEnd,E(b.get())),d=$(e.state.camera,a,g);return d==null?null:y(c,d,l)?{...n,renderStart:t,renderEnd:l,plane:c,ray:d}:null}}function B(e,r,t=0,l=null,s=null){let n=null;return c=>{if(c.action==="start"&&(n=e.sceneIntersectionHelper.intersectElevationFromScreen(S(c.screenStart.x,c.screenStart.y),r,t,s),n!=null&&l!=null&&!w(n,n,l))||n==null)return null;const a=e.sceneIntersectionHelper.intersectElevationFromScreen(S(c.screenEnd.x,c.screenEnd.y),r,t,s);return a!=null&&(l==null||w(a,a,l))?{...c,mapStart:n,mapEnd:a}:null}}function J(e,r,t,l=null,s=null){return B(e,t,D(r,e,t),l,s)}function N(e,r,t,l){const s=t.toMap(e.screenStart);return s!=null?J(r,s,t.elevationInfo,l):null}function O(e,r){const t=P,l=v,s=F();e.renderCoordsHelper.worldUpAtPosition(r,t);const n=C(_(s),t,x(l,r,e.state.camera.eye));return C(n,n,t),A(r,n,s)}function nn(e,r,t){let l=null;const s=new j;return s.next(z(e,O(e,r))).next(Q(e,r)).next(V(e,t)).next(n=>{n.mapEnd.x=n.mapStart.x,n.mapEnd.y=n.mapStart.y,l=n}),n=>(l=null,s.execute(n),l)}function Q(e,r){const t=i(),l=H(r);e.renderCoordsHelper.worldUpAtPosition(r,t);const s=i(),n=i(),c=a=>(x(a,a,r),q(t,a,a),e.viewingMode==="global"&&H(a)*Math.sign(G(t,a))<.001-l&&x(a,K(a,t,.001),r),Z(a,a,r),a);return a=>(a.renderStart=c(I(s,a.renderStart)),a.renderEnd=c(I(n,a.renderEnd)),a)}function en(e,r){const t=l=>{const s=p(l,E(W)),n=$(e.state.camera,s,g);return n==null?null:k(r,n,P,v)?.[0]};return l=>{const s=t(l.screenStart);if(s==null)return null;const n=t(l.screenEnd);return n==null?null:{...l,renderStart:s,renderEnd:n}}}function V(e,r){const t=e.renderCoordsHelper;return l=>{const s=t.fromRenderCoords(l.renderStart,new m({spatialReference:r})),n=t.fromRenderCoords(l.renderEnd,new m({spatialReference:r}));return s!=null&&n!=null?{...l,mapStart:s,mapEnd:n}:null}}function tn(e){let r=null;return t=>{switch(t.action){case"start":r=e.disableDisplay();break;case"end":case"cancel":r!=null&&(r.remove(),r=null)}return t}}function rn(e,r=null){const t=new U(e.state.viewingMode);t.options.selectionMode=!0,t.options.store=0,t.options.hud=!1;const l=S(),s={requiresGroundFeedback:!0,enableDraped:!0,exclude:new Set},n=i(),c=r??e.spatialReference,a=o=>{e.map.ground&&e.map.ground.opacity<1?s.exclude.add(R):s.exclude.delete(R),e.sceneIntersectionHelper.intersectIntersectorScreen(p(o,l),t,s);const u=t.results.min;let f;if(u.getIntersectionPoint(n))f=u.intersector===7?0:1;else{if(!t.results.ground.getIntersectionPoint(n))return null;f=0}return{location:e.renderCoordsHelper.fromRenderCoords(n,new m({spatialReference:c})),surfaceType:f}};let d;return o=>{if(o.action==="start"){const f=a(o.screenStart);d=f!=null?f.location:null}if(d==null)return null;const u=a(o.screenEnd);return u?.location!=null?{...o,mapStart:d,mapEnd:u.location,surfaceType:u.surfaceType}:null}}const W=h(),P=i(),v=i(),g=T();export{en as D,tn as G,J as M,rn as O,z as P,L as R,nn as T,N as k,V as q};
