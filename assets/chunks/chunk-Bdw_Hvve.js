import{j3 as c,j4 as y,i$ as A,j0 as F,dp as f}from"./chunk-XGpVqsM_.js";import{a as h,K as p,b as u,q as m,i as w}from"./chunk-DSxbTks2.js";import{l as s}from"./chunk-CUUe8C2d.js";import{R as d,i as S}from"./chunk-DhzMXUWC.js";import"./chunk-DyqHK6XP.js";import"./chunk-Dix477Sg.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */import"./chunk-CrMA_peF.js";import"./chunk-BPVd6ESQ.js";import"./chunk-QEYgYKcA.js";import"./chunk-CZe87vnm.js";import"./chunk-DHiB1uzW.js";import"./chunk-DEIF0xBl.js";import"./chunk-CcEbRgUF.js";async function e(i,r,t,a){if(t.length===1){if(c(t[0]))return s(i,t[0],m(t[1],-1));if(u(t[0]))return s(i,t[0].toArray(),m(t[1],-1))}else if(t.length===2){if(c(t[0]))return s(i,t[0],m(t[1],-1));if(u(t[0]))return s(i,t[0].toArray(),m(t[1],-1));if(p(t[0])){const n=await t[0].load(),o=await g(d.create(t[1],{fieldsIndex:n.getFieldsIndex(),timeZone:n.dateFieldsTimeZoneDefaultUTC}),a,r);return l(r,await t[0].calculateStatistic(i,o,m(t[2],1e3),r.abortSignal))}}else if(t.length===3&&p(t[0])){const n=await t[0].load(),o=await g(d.create(t[1],{fieldsIndex:n.getFieldsIndex(),timeZone:n.dateFieldsTimeZoneDefaultUTC}),a,r);return l(r,await t[0].calculateStatistic(i,o,m(t[2],1e3),r.abortSignal))}return s(i,t,-1)}function l(i,r){return r instanceof S?f.fromReaderAsTimeStampOffset(r.toStorageFormat()):r instanceof Date?f.dateJSAndZoneToArcadeDate(r,w(i)):r}async function g(i,r,t){const a=i.getVariables();if(a.length>0){const n={};for(const o of a)n[o]=r.evaluateIdentifier(t,{name:o});i.parameters=n}return i}function At(i){i.mode==="async"&&(i.functions.stdev=function(r,t){return i.standardFunctionAsync(r,t,((a,n,o)=>e("stdev",r,o,i)))},i.functions.variance=function(r,t){return i.standardFunctionAsync(r,t,((a,n,o)=>e("variance",r,o,i)))},i.functions.average=function(r,t){return i.standardFunctionAsync(r,t,((a,n,o)=>e("mean",r,o,i)))},i.functions.mean=function(r,t){return i.standardFunctionAsync(r,t,((a,n,o)=>e("mean",r,o,i)))},i.functions.sum=function(r,t){return i.standardFunctionAsync(r,t,((a,n,o)=>e("sum",r,o,i)))},i.functions.min=function(r,t){return i.standardFunctionAsync(r,t,((a,n,o)=>e("min",r,o,i)))},i.functions.max=function(r,t){return i.standardFunctionAsync(r,t,((a,n,o)=>e("max",r,o,i)))},i.functions.count=function(r,t){return i.standardFunctionAsync(r,t,(async(a,n,o)=>{if(h(o,1,1,r,t),p(o[0]))return o[0].count(a.abortSignal);if(c(o[0])||y(o[0]))return o[0].length;if(u(o[0]))return o[0].length();throw new A(r,F.InvalidParameter,t)}))})}export{At as registerFunctions};
