class w extends Error{constructor(e,r){super(`${e} at position ${r}`),this.position=r}}const q=32,ae=10,H=9,P=13,de=160,pe=8192,he=8202,ge=8239,we=8287,me=12288;function Ce(n){return/^[0-9A-Fa-f]$/.test(n)}function d(n){return n>="0"&&n<="9"}function be(n){return n>=" "}function E(n){return`,:[]/{}()
+`.includes(n)}function L(n){return n>="a"&&n<="z"||n>="A"&&n<="Z"||n==="_"||n==="$"}function F(n){return n>="a"&&n<="z"||n>="A"&&n<="Z"||n==="_"||n==="$"||n>="0"&&n<="9"}const M=/^(http|https|ftp|mailto|file|data|irc):\/\/$/,R=/^[A-Za-z0-9-._~:/?#@!$&'()*+;=]$/;function Z(n){return`,[]/{}
+`.includes(n)}function _(n){return O(n)||Se.test(n)}const Se=/^[[{\w-]$/;function ke(n){return n===`
`||n==="\r"||n==="	"||n==="\b"||n==="\f"}function p(n,e){const r=n.charCodeAt(e);return r===q||r===ae||r===H||r===P}function Ne(n,e){const r=n.charCodeAt(e);return r===q||r===H||r===P}function $e(n,e){const r=n.charCodeAt(e);return r===de||r>=pe&&r<=he||r===ge||r===we||r===me}function O(n){return G(n)||I(n)}function G(n){return n==='"'||n==="“"||n==="”"}function z(n){return n==='"'}function I(n){return n==="'"||n==="‘"||n==="’"||n==="`"||n==="´"}function T(n){return n==="'"}function S(n,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const k=n.lastIndexOf(e);return k!==-1?n.substring(0,k)+(r?"":n.substring(k+1)):n}function l(n,e){let r=n.length;if(!p(n,r-1))return n+e;for(;p(n,r-1);)r--;return n.substring(0,r)+e+n.substring(r)}function Ae(n,e,r){return n.substring(0,e)+n.substring(e+r)}function Ee(n){return/[,\n][ \t\r]*$/.test(n)}const Oe={"\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t"},ye={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"};function We(n){let e=0,r="";U(["```","[```","{```"]),m()||ce(),U(["```","```]","```}"]);const y=C(",");for(y&&t(),_(n[e])&&Ee(r)?(y||(r=l(r,",")),re()):y&&(r=S(r,","));n[e]==="}"||n[e]==="]";)e++,t();if(e>=n.length)return r;te();function m(){t();const i=ee()||ne()||h()||ie()||se()||B(!1)||ue();return t(),i}function t(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const s=e;let u=Q(i);do u=X(),u&&(u=Q(i));while(u);return e>s}function Q(i){const s=i?p:Ne;let u="";for(;;)if(s(n,e))u+=n[e],e++;else if($e(n,e))u+=" ",e++;else break;return u.length>0?(r+=u,!0):!1}function X(){if(n[e]==="/"&&n[e+1]==="*"){for(;e<n.length&&!ve(n,e);)e++;return e+=2,!0}if(n[e]==="/"&&n[e+1]==="/"){for(;e<n.length&&n[e]!==`
`;)e++;return!0}return!1}function U(i){if(Y(i)){if(L(n[e]))for(;e<n.length&&F(n[e]);)e++;return t(),!0}return!1}function Y(i){for(const s of i){const u=e+s.length;if(n.slice(e,u)===s)return e=u,!0}return!1}function C(i){return n[e]===i?(r+=n[e],e++,!0):!1}function N(i){return n[e]===i?(e++,!0):!1}function x(){return N("\\")}function V(){return t(),n[e]==="."&&n[e+1]==="."&&n[e+2]==="."?(e+=3,t(),N(","),!0):!1}function ee(){if(n[e]==="{"){r+="{",e++,t(),N(",")&&t();let i=!0;for(;e<n.length&&n[e]!=="}";){let s;if(i?(s=!0,i=!1):(s=C(","),s||(r=l(r,",")),t()),V(),!(h()||B(!0))){n[e]==="}"||n[e]==="{"||n[e]==="]"||n[e]==="["||n[e]===void 0?r=S(r,","):le();break}t();const A=C(":"),a=e>=n.length;A||(_(n[e])||a?r=l(r,":"):J()),m()||(A||a?r+="null":J())}return n[e]==="}"?(r+="}",e++):r=l(r,"}"),!0}return!1}function ne(){if(n[e]==="["){r+="[",e++,t(),N(",")&&t();let i=!0;for(;e<n.length&&n[e]!=="]";)if(i?i=!1:C(",")||(r=l(r,",")),V(),!m()){r=S(r,",");break}return n[e]==="]"?(r+="]",e++):r=l(r,"]"),!0}return!1}function re(){let i=!0,s=!0;for(;s;)i?i=!1:C(",")||(r=l(r,",")),s=m();s||(r=S(r,",")),r=`[
${r}
]`}function h(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,u=n[e]==="\\";if(u&&(e++,u=!0),O(n[e])){const A=z(n[e])?z:T(n[e])?T:I(n[e])?I:G,a=e,b=r.length;let o='"';for(e++;;){if(e>=n.length){const c=D(e-1);return!i&&E(n.charAt(c))?(e=a,r=r.substring(0,b),h(!0)):(o=l(o,'"'),r+=o,!0)}if(e===s)return o=l(o,'"'),r+=o,!0;if(A(n[e])){const c=e,W=o.length;if(o+='"',e++,r+=o,t(!1),i||e>=n.length||E(n[e])||O(n[e])||d(n[e]))return j(),!0;const f=D(c-1),K=n.charAt(f);if(K===",")return e=a,r=r.substring(0,b),h(!1,f);if(E(K))return e=a,r=r.substring(0,b),h(!0);r=r.substring(0,b),e=c+1,o=`${o.substring(0,W)}\\${o.substring(W)}`}else if(i&&Z(n[e])){if(n[e-1]===":"&&M.test(n.substring(a+1,e+2)))for(;e<n.length&&R.test(n[e]);)o+=n[e],e++;return o=l(o,'"'),r+=o,j(),!0}else if(n[e]==="\\"){const c=n.charAt(e+1);if(ye[c]!==void 0)o+=n.slice(e,e+2),e+=2;else if(c==="u"){let f=2;for(;f<6&&Ce(n[e+f]);)f++;f===6?(o+=n.slice(e,e+6),e+=6):e+f>=n.length?e=n.length:fe()}else o+=c,e+=2}else{const c=n.charAt(e);c==='"'&&n[e-1]!=="\\"?(o+=`\\${c}`,e++):ke(c)?(o+=Oe[c],e++):(be(c)||oe(c),o+=c,e++)}u&&x()}}return!1}function j(){let i=!1;for(t();n[e]==="+";){i=!0,e++,t(),r=S(r,'"',!0);const s=r.length;h()?r=Ae(r,s,1):r=l(r,'"')}return i}function ie(){const i=e;if(n[e]==="-"){if(e++,$())return v(i),!0;if(!d(n[e]))return e=i,!1}for(;d(n[e]);)e++;if(n[e]==="."){if(e++,$())return v(i),!0;if(!d(n[e]))return e=i,!1;for(;d(n[e]);)e++}if(n[e]==="e"||n[e]==="E"){if(e++,(n[e]==="-"||n[e]==="+")&&e++,$())return v(i),!0;if(!d(n[e]))return e=i,!1;for(;d(n[e]);)e++}if(!$())return e=i,!1;if(e>i){const s=n.slice(i,e),u=/^0\d/.test(s);return r+=u?`"${s}"`:s,!0}return!1}function se(){return g("true","true")||g("false","false")||g("null","null")||g("True","true")||g("False","false")||g("None","null")}function g(i,s){return n.slice(e,e+i.length)===i?(r+=s,e+=i.length,!0):!1}function B(i){const s=e;if(L(n[e])){for(;e<n.length&&F(n[e]);)e++;let u=e;for(;p(n,u);)u++;if(n[u]==="(")return e=u+1,m(),n[e]===")"&&(e++,n[e]===";"&&e++),!0}for(;e<n.length&&!Z(n[e])&&!O(n[e])&&(!i||n[e]!==":");)e++;if(n[e-1]===":"&&M.test(n.substring(s,e+2)))for(;e<n.length&&R.test(n[e]);)e++;if(e>s){for(;p(n,e-1)&&e>0;)e--;const u=n.slice(s,e);return r+=u==="undefined"?"null":JSON.stringify(u),n[e]==='"'&&e++,!0}}function ue(){if(n[e]==="/"){const i=e;for(e++;e<n.length&&(n[e]!=="/"||n[e-1]==="\\");)e++;return e++,r+=`"${n.substring(i,e)}"`,!0}}function D(i){let s=i;for(;s>0&&p(n,s);)s--;return s}function $(){return e>=n.length||E(n[e])||p(n,e)}function v(i){r+=`${n.slice(i,e)}0`}function oe(i){throw new w(`Invalid character ${JSON.stringify(i)}`,e)}function te(){throw new w(`Unexpected character ${JSON.stringify(n[e])}`,e)}function ce(){throw new w("Unexpected end of json string",n.length)}function le(){throw new w("Object key expected",e)}function J(){throw new w("Colon expected",e)}function fe(){const i=n.slice(e,e+6);throw new w(`Invalid unicode character "${i}"`,e)}}function ve(n,e){return n[e]==="*"&&n[e+1]==="/"}export{We as j};
