import{b as Ce,C as w1,f as M1,D as A1,u as T1,E as y1,G as B1,d as R1,y as E1,i as C1,o as m1,H as Qe,c as k1,a as L1,I as I1,J as D1,k as Me,K as g1,L as b1,T as O1,w as H1,M as F1,N as N1,O as V1,P as P1}from"./chunk-CjSkIgyx.js";import"./chunk-DB56luzt.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */const Be={fatal:0,error:0,warn:1,log:2,info:3,success:3,fail:3,debug:4,trace:5,verbose:Number.POSITIVE_INFINITY},d1={silent:{level:-1},fatal:{level:Be.fatal},error:{level:Be.error},warn:{level:Be.warn},log:{level:Be.log},info:{level:Be.info},success:{level:Be.success},fail:{level:Be.fail},ready:{level:Be.info},start:{level:Be.info},box:{level:Be.info},debug:{level:Be.debug},trace:{level:Be.trace},verbose:{level:Be.verbose}};function Je(K){if(K===null||typeof K!="object")return!1;const G=Object.getPrototypeOf(K);return G!==null&&G!==Object.prototype&&Object.getPrototypeOf(G)!==null||Symbol.iterator in K?!1:Symbol.toStringTag in K?Object.prototype.toString.call(K)==="[object Module]":!0}function n1(K,G,$=".",j){if(!Je(G))return n1(K,{},$);const s0=Object.assign({},G);for(const V0 in K){if(V0==="__proto__"||V0==="constructor")continue;const T=K[V0];T!=null&&(Array.isArray(T)&&Array.isArray(s0[V0])?s0[V0]=[...T,...s0[V0]]:Je(T)&&Je(s0[V0])?s0[V0]=n1(T,s0[V0],($?`${$}.`:"")+V0.toString()):s0[V0]=T)}return s0}function X1(K){return(...G)=>G.reduce(($,j)=>n1($,j,""),{})}const Y1=X1();function q1(K){return Object.prototype.toString.call(K)==="[object Object]"}function j1(K){return!(!q1(K)||!K.message&&!K.args||K.stack)}let $e=!1;const p1=[];class Se{options;_lastLog;_mockFn;constructor(G={}){const $=G.types||d1;this.options=Y1({...G,defaults:{...G.defaults},level:e1(G.level,$),reporters:[...G.reporters||[]]},{types:d1,throttle:1e3,throttleMin:5,formatOptions:{date:!0,colors:!1,compact:!0}});for(const j in $){const s0={type:j,...this.options.defaults,...$[j]};this[j]=this._wrapLogFn(s0),this[j].raw=this._wrapLogFn(s0,!0)}this.options.mockFn&&this.mockTypes(),this._lastLog={}}get level(){return this.options.level}set level(G){this.options.level=e1(G,this.options.types,this.options.level)}prompt(G,$){if(!this.options.prompt)throw new Error("prompt is not supported!");return this.options.prompt(G,$)}create(G){const $=new Se({...this.options,...G});return this._mockFn&&$.mockTypes(this._mockFn),$}withDefaults(G){return this.create({...this.options,defaults:{...this.options.defaults,...G}})}withTag(G){return this.withDefaults({tag:this.options.defaults.tag?this.options.defaults.tag+":"+G:G})}addReporter(G){return this.options.reporters.push(G),this}removeReporter(G){if(G){const $=this.options.reporters.indexOf(G);if($!==-1)return this.options.reporters.splice($,1)}else this.options.reporters.splice(0);return this}setReporters(G){return this.options.reporters=Array.isArray(G)?G:[G],this}wrapAll(){this.wrapConsole(),this.wrapStd()}restoreAll(){this.restoreConsole(),this.restoreStd()}wrapConsole(){for(const G in this.options.types)console["__"+G]||(console["__"+G]=console[G]),console[G]=this[G].raw}restoreConsole(){for(const G in this.options.types)console["__"+G]&&(console[G]=console["__"+G],delete console["__"+G])}wrapStd(){this._wrapStream(this.options.stdout,"log"),this._wrapStream(this.options.stderr,"log")}_wrapStream(G,$){G&&(G.__write||(G.__write=G.write),G.write=j=>{this[$].raw(String(j).trim())})}restoreStd(){this._restoreStream(this.options.stdout),this._restoreStream(this.options.stderr)}_restoreStream(G){G&&G.__write&&(G.write=G.__write,delete G.__write)}pauseLogs(){$e=!0}resumeLogs(){$e=!1;const G=p1.splice(0);for(const $ of G)$[0]._logFn($[1],$[2])}mockTypes(G){const $=G||this.options.mockFn;if(this._mockFn=$,typeof $=="function")for(const j in this.options.types)this[j]=$(j,this.options.types[j])||this[j],this[j].raw=this[j]}_wrapLogFn(G,$){return(...j)=>{if($e){p1.push([this,G,j,$]);return}return this._logFn(G,j,$)}}_logFn(G,$,j){if((G.level||0)>this.level)return!1;const s0={date:new Date,args:[],...G,level:e1(G.level,this.options.types)};!j&&$.length===1&&j1($[0])?Object.assign(s0,$[0]):s0.args=[...$],s0.message&&(s0.args.unshift(s0.message),delete s0.message),s0.additional&&(Array.isArray(s0.additional)||(s0.additional=s0.additional.split(`
`)),s0.args.push(`
`+s0.additional.join(`
`)),delete s0.additional),s0.type=typeof s0.type=="string"?s0.type.toLowerCase():"log",s0.tag=typeof s0.tag=="string"?s0.tag:"";const V0=(X=!1)=>{const M0=(this._lastLog.count||0)-this.options.throttleMin;if(this._lastLog.object&&M0>0){const o0=[...this._lastLog.object.args];M0>1&&o0.push(`(repeated ${M0} times)`),this._log({...this._lastLog.object,args:o0}),this._lastLog.count=1}X&&(this._lastLog.object=s0,this._log(s0))};clearTimeout(this._lastLog.timeout);const T=this._lastLog.time&&s0.date?s0.date.getTime()-this._lastLog.time.getTime():0;if(this._lastLog.time=s0.date,T<this.options.throttle)try{const X=JSON.stringify([s0.type,s0.tag,s0.args]),M0=this._lastLog.serialized===X;if(this._lastLog.serialized=X,M0&&(this._lastLog.count=(this._lastLog.count||0)+1,this._lastLog.count>this.options.throttleMin)){this._lastLog.timeout=setTimeout(V0,this.options.throttle);return}}catch{}V0(!0)}_log(G){for(const $ of this.options.reporters)$.log(G,{options:this.options})}}function e1(K,G={},$=3){return K===void 0?$:typeof K=="number"?K:G[K]&&G[K].level!==void 0?G[K].level:$}Se.prototype.add=Se.prototype.addReporter;Se.prototype.remove=Se.prototype.removeReporter;Se.prototype.clear=Se.prototype.removeReporter;Se.prototype.withScope=Se.prototype.withTag;Se.prototype.mock=Se.prototype.mockTypes;Se.prototype.pause=Se.prototype.pauseLogs;Se.prototype.resume=Se.prototype.resumeLogs;function G1(K={}){return new Se(K)}class U1{options;defaultColor;levelColorMap;typeColorMap;constructor(G){this.options={...G},this.defaultColor="#7f8c8d",this.levelColorMap={0:"#c0392b",1:"#f39c12",3:"#00BCD4"},this.typeColorMap={success:"#2ecc71"}}_getLogFn(G){return G<1?console.__error||console.error:G===1?console.__warn||console.warn:console.__log||console.log}log(G){const $=this._getLogFn(G.level),j=G.type==="log"?"":G.type,s0=G.tag||"",T=`
      background: ${this.typeColorMap[G.type]||this.levelColorMap[G.level]||this.defaultColor};
      border-radius: 0.5em;
      color: white;
      font-weight: bold;
      padding: 2px 0.5em;
    `,X=`%c${[s0,j].filter(Boolean).join(":")}`;typeof G.args[0]=="string"?$(`${X}%c ${G.args[0]}`,T,"",...G.args.slice(1)):$(X,T,...G.args)}}function z1(K={}){return G1({reporters:K.reporters||[new U1({})],prompt($,j={}){return j.type==="confirm"?Promise.resolve(confirm($)):Promise.resolve(prompt($))},...K})}const t1=z1();function W1(K){return K&&K.__esModule&&Object.prototype.hasOwnProperty.call(K,"default")?K.default:K}var S1={exports:{}};(function(K){(function(G){var $=typeof window=="object"&&!!window.document,j=$?window:Object;G(j,$),K.exports&&(K.exports=j.Recorder)})(function(G,$){var j=function(){},s0=function(x){return typeof x=="number"},V0=function(x){return JSON.stringify(x)},T=function(x){return new ve(x)},X=T.LM="2025-01-11 09:28",M0="https://github.com/xiangyuecn/Recorder",o0="Recorder",C0="getUserMedia",U0="srcSampleRate",d0="sampleRate",T0="bitRate",P="catch",W=G[o0];if(W&&W.LM==X){W.CLog(W.i18n.$T("K8zP::重复导入{1}",0,o0),3);return}T.IsOpen=function(){var x=T.Stream;if(x){var B=W0(x),r=B[0];if(r){var O=r.readyState;return O=="live"||O==r.LIVE}}return!1},T.BufferSize=4096,T.Destroy=function(){O0(o0+" Destroy"),_0();for(var x in c0)c0[x]()};var c0={};T.BindDestroy=function(x,B){c0[x]=B},T.Support=function(){if(!$)return!1;var x=navigator.mediaDevices||{};return x[C0]||(x=navigator,x[C0]||(x[C0]=x.webkitGetUserMedia||x.mozGetUserMedia||x.msGetUserMedia)),!(!x[C0]||(T.Scope=x,!T.GetContext()))},T.GetContext=function(x){if(!$)return null;var B=window.AudioContext;if(B||(B=window.webkitAudioContext),!B)return null;var r=T.Ctx,O=0;return r||(r=T.Ctx=new B,O=1,T.NewCtxs=T.NewCtxs||[],T.BindDestroy("Ctx",function(){var z=T.Ctx;z&&z.close&&(L0(z),T.Ctx=0);var i0=T.NewCtxs;T.NewCtxs=[];for(var a0=0;a0<i0.length;a0++)L0(i0[a0])})),x&&r.close&&(O||(r._useC||L0(r),r=new B),r._useC=1,T.NewCtxs.push(r)),r},T.CloseNewCtx=function(x){if(x&&x.close){L0(x);for(var B=T.NewCtxs||[],r=B.length,O=0;O<B.length;O++)if(B[O]==x){B.splice(O,1);break}O0(h0("mSxV::剩{1}个GetContext未close",0,r+"-1="+B.length),B.length?3:0)}};var L0=function(x){if(x&&x.close&&!x._isC&&(x._isC=1,x.state!="closed"))try{x.close()}catch(B){O0("ctx close err",1,B)}},U=T.ResumeCtx=function(x,B,r,O){var z=0,i0=0,a0=0,A0=0,B0="EventListener",R0="ResumeCtx ",m0=function(z0,D0){i0&&re(),z||(z=1,z0&&O(z0,A0),D0&&r(A0)),D0&&(!x._LsSC&&x["add"+B0]&&x["add"+B0]("statechange",j0),x._LsSC=1,a0=1)},re=function(z0){if(!(z0&&i0)){i0=z0?1:0;for(var D0=["focus","mousedown","mouseup","touchstart","touchend"],Q0=0;Q0<D0.length;Q0++)window[(z0?"add":"remove")+B0](D0[Q0],j0,!0)}},j0=function(){var z0=x.state,D0=I0(z0);if(!z&&!B(D0?++A0:A0))return m0();D0?(a0&&O0(R0+"sc "+z0,3),re(1),x.resume().then(function(){a0&&O0(R0+"sc "+x.state),m0(0,1)})[P](function(Q0){O0(R0+"error",1,Q0),I0(x.state)||m0(Q0.message||"error")})):z0=="closed"?(a0&&!x._isC&&O0(R0+"sc "+z0,1),m0("ctx closed")):m0(0,1)};j0()},I0=T.CtxSpEnd=function(x){return x=="suspended"||x=="interrupted"},n0=function(x){var B=x.state,r="ctx.state="+B;return I0(B)&&(r+=h0("nMIy::（注意：ctx不是running状态，rec.open和start至少要有一个在用户操作(触摸、点击等)时进行调用，否则将在rec.start时尝试进行ctx.resume，可能会产生兼容性问题(仅iOS)，请参阅文档中runningContext配置）")),r},S0="ConnectEnableWebM";T[S0]=!0;var r0="ConnectEnableWorklet";T[r0]=!1;var y0=function(x){var B=x.BufferSize||T.BufferSize,r=x.Stream,O=r._c,z=O[d0],i0={},a0=W0(r),A0=a0[0],B0=null,R0="";if(A0&&A0.getSettings){B0=A0.getSettings();var m0=B0[d0];m0&&m0!=z&&(R0=h0("eS8i::Stream的采样率{1}不等于{2}，将进行采样率转换（注意：音质不会变好甚至可能变差），主要在移动端未禁用回声消除时会产生此现象，浏览器有回声消除时可能只会返回16k采样率的音频数据，",0,m0,z))}r._ts=B0,O0(R0+"Stream TrackSet: "+V0(B0),R0?3:0);var re=function(w){var S=r._m=O.createMediaStreamSource(r),l=O.destination,v="createMediaStreamDestination";O[v]&&(l=r._d=O[v]()),S.connect(w),w.connect(l)},j0,z0,D0,Q0="",f=r._call,L=function(w,S){for(var l in f){if(S!=z){i0.index=0,i0=T.SampleData([w],S,z,i0,{_sum:1});var v=i0.data,b=i0._sum}else{i0={};for(var d=w.length,v=new Int16Array(d),b=0,o=0;o<d;o++){var c=Math.max(-1,Math.min(1,w[o]));c=c<0?c*32768:c*32767,v[o]=c,b+=Math.abs(c)}}for(var e in f)f[e](v,b);return}},H="ScriptProcessor",m="audioWorklet",Q=o0+" "+m,A="RecProc",R="MediaRecorder",e0=R+".WebM.PCM",C=O.createScriptProcessor||O.createJavaScriptNode,N=h0("ZGlf::。由于{1}内部1秒375次回调，在移动端可能会有性能问题导致回调丢失录音变短，PC端无影响，暂不建议开启{1}。",0,m),s=function(){z0=r.isWorklet=!1,H0(r),O0(h0("7TU0::Connect采用老的{1}，",0,H)+ce.get(T[r0]?h0("JwCL::但已设置{1}尝试启用{2}",2):h0("VGjB::可设置{1}尝试启用{2}",2),[o0+"."+r0+"=true",m])+Q0+N,3);var w=r._p=C.call(O,B,1,1);re(w),w.onaudioprocess=function(S){var l=S.inputBuffer.getChannelData(0);L(l,z)}},y=function(){j0=r.isWebM=!1,x0(r),z0=r.isWorklet=!C||T[r0];var w=window.AudioWorkletNode;if(!(z0&&O[m]&&w)){s();return}var S=function(){var o=function(e){return e.toString().replace(/^function|DEL_/g,"").replace(/\$RA/g,Q)},c="class "+A+" extends AudioWorkletProcessor{";return c+="constructor "+o(function(e){DEL_super(e);var M=this,h=e.processorOptions.bufferSize;M.bufferSize=h,M.buffer=new Float32Array(h*2),M.pos=0,M.port.onmessage=function(g){g.data.kill&&(M.kill=!0,$C.log("$RA kill call"))},$C.log("$RA .ctor call",e)}),c+="process "+o(function(e,M,h){var g=this,_=g.bufferSize,i=g.buffer,u=g.pos;if(e=(e[0]||[])[0]||[],e.length){i.set(e,u),u+=e.length;var p=~~(u/_)*_;if(p){this.port.postMessage({val:i.slice(0,p)});var k=i.subarray(p,u);i=new Float32Array(_*2),i.set(k),u=k.length,g.buffer=i}g.pos=u}return!g.kill}),c+='}try{registerProcessor("'+A+'", '+A+')}catch(e){$C.error("'+Q+' Reg Error",e)}',c=c.replace(/\$C\./g,"console."),"data:text/javascript;base64,"+btoa(unescape(encodeURIComponent(c)))},l=function(){return z0&&r._na},v=r._na=function(){D0!==""&&(clearTimeout(D0),D0=setTimeout(function(){D0=0,l()&&(O0(h0("MxX1::{1}未返回任何音频，恢复使用{2}",0,m,H),3),C&&s())},500))},b=function(){if(l()){var o=r._n=new w(O,A,{processorOptions:{bufferSize:B}});re(o),o.port.onmessage=function(c){D0&&(clearTimeout(D0),D0=""),l()?L(c.data.val,z):z0||O0(h0("XUap::{1}多余回调",0,m),3)},O0(h0("yOta::Connect采用{1}，设置{2}可恢复老式{3}",0,m,o0+"."+r0+"=false",H)+Q0+N,3)}},d=function(){if(l()){if(O[A]){b();return}var o=S();O[m].addModule(o).then(function(c){l()&&(O[A]=1,b(),D0&&v())})[P](function(c){O0(m+".addModule Error",1,c),l()&&s()})}};U(O,function(){return l()},d,d)},a=function(){var w=window[R],S="ondataavailable",l="audio/webm; codecs=pcm";j0=r.isWebM=T[S0];var v=w&&S in w.prototype&&w.isTypeSupported(l);if(Q0=v?"":h0("VwPd::（此浏览器不支持{1}）",0,e0),!j0||!v){y();return}var b=function(){return j0&&r._ra};r._ra=function(){D0!==""&&(clearTimeout(D0),D0=setTimeout(function(){b()&&(O0(h0("vHnb::{1}未返回任何音频，降级使用{2}",0,R,m),3),y())},500))};var d=Object.assign({mimeType:l},T.ConnectWebMOptions),o=r._r=new w(r,d),c=r._rd={};o[S]=function(e){var M=new FileReader;M.onloadend=function(){if(b()){var h=Ae(new Uint8Array(M.result),c);if(!h)return;if(h==-1){y();return}D0&&(clearTimeout(D0),D0=""),L(h,c.webmSR)}else j0||O0(h0("O9P7::{1}多余回调",0,R),3)},M.readAsArrayBuffer(e.data)};try{o.start(~~(B/48)),O0(h0("LMEm::Connect采用{1}，设置{2}可恢复使用{3}或老式{4}",0,e0,o0+"."+S0+"=false",m,H))}catch(e){O0("mr start err",1,e),y()}};a()},g0=function(x){x._na&&x._na(),x._ra&&x._ra()},H0=function(x){x._na=null,x._n&&(x._n.port.postMessage({kill:!0}),x._n.disconnect(),x._n=null)},x0=function(x){if(x._ra=null,x._r){try{x._r.stop()}catch(B){O0("mr stop err",1,B)}x._r=null}},_0=function(x){x=x||T;var B=x==T,r=x.Stream;r&&(r._m&&(r._m.disconnect(),r._m=null),!r._RC&&r._c&&T.CloseNewCtx(r._c),r._RC=null,r._c=null,r._d&&(D(r._d.stream),r._d=null),r._p&&(r._p.disconnect(),r._p.onaudioprocess=r._p=null),H0(r),x0(r),B&&D(r)),x.Stream=0},D=T.StopS_=function(x){for(var B=W0(x),r=0;r<B.length;r++){var O=B[r];O.stop&&O.stop()}x.stop&&x.stop()},W0=function(x){var B=0,r=0,O=[];x.getAudioTracks&&(B=x.getAudioTracks(),r=x.getVideoTracks()),B||(B=x.audioTracks,r=x.videoTracks);for(var z=0,i0=B?B.length:0;z<i0;z++)O.push(B[z]);for(var z=0,i0=r?r.length:0;z<i0;z++)O.push(r[z]);return O};T.SampleData=function(x,B,r,O,z){var i0="SampleData";O||(O={});var a0=O.index||0,A0=O.offset||0,B0=O.raisePrev||0,R0=O.filter;if(R0&&R0.fn&&(R0.sr&&R0.sr!=B||R0.srn&&R0.srn!=r)&&(R0=null,O0(h0("d48C::{1}的filter采样率变了，重设滤波",0,i0),3)),!R0)if(r<=B){var m0=r>B*3/4?0:r/2*3/4;R0={fn:m0?T.IIRFilter(!0,B,m0):0}}else{var m0=B>r*3/4?0:B/2*3/4;R0={fn:m0?T.IIRFilter(!0,r,m0):0}}R0.sr=B,R0.srn=r;var re=R0.fn,j0=O.frameNext||[];z||(z={});var z0=z.frameSize||1;z.frameType&&(z0=z.frameType=="mp3"?1152:1);var D0=z._sum,Q0=0,f=x.length;a0>f+1&&O0(h0("tlbC::{1}似乎传入了未重置chunk {2}",0,i0,a0+">"+f),3);for(var L=0,H=a0;H<f;H++)L+=x[H].length;var m=B/r;if(m>1)L=Math.max(0,L-Math.floor(A0)),L=Math.floor(L/m);else if(m<1){var Q=1/m;L=Math.floor(L*Q)}L+=j0.length;for(var A=new Int16Array(L),R=0,H=0;H<j0.length;H++)A[R]=j0[H],R++;for(;a0<f;a0++){var e0=x[a0],C=e0 instanceof Float32Array,H=A0,N=e0.length,s=re&&re.Embed,y=0,a=0,w=0,S=0;if(m<1){for(var l=R+H,v=B0,b=0;b<N;b++){var d=e0[b];C&&(d=Math.max(-1,Math.min(1,d)),d=d<0?d*32768:d*32767);var o=Math.floor(l);l+=Q;for(var c=Math.floor(l),e=(d-v)/(c-o),M=1;o<c;o++,M++){var h=Math.floor(v+M*e);s?(w=h,S=s.b0*w+s.b1*s.x1+s.b0*s.x2-s.a1*s.y1-s.a2*s.y2,s.x2=s.x1,s.x1=w,s.y2=s.y1,s.y1=S,h=S):h=re?re(h):h,h>32767?h=32767:h<-32768&&(h=-32768),D0&&(Q0+=Math.abs(h)),A[o]=h,R++}v=B0=d,H+=Q}A0=H%1;continue}for(var b=0,g=0;b<N;b++,g++){if(g<N){var d=e0[g];C&&(d=Math.max(-1,Math.min(1,d)),d=d<0?d*32768:d*32767),s?(w=d,S=s.b0*w+s.b1*s.x1+s.b0*s.x2-s.a1*s.y1-s.a2*s.y2,s.x2=s.x1,s.x1=w,s.y2=s.y1,s.y1=S):S=re?re(d):d}if(y=a,a=S,g==0){b--;continue}var _=Math.floor(H);if(b==_){var i=Math.ceil(H),u=H-_,p=y,k=i<N?a:p,t=p+(k-p)*u;t>32767?t=32767:t<-32768&&(t=-32768),D0&&(Q0+=Math.abs(t)),A[R]=t,R++,H+=m}}A0=Math.max(0,H-N)}m<1&&R+1==L&&(L--,A=new Int16Array(A.buffer.slice(0,L*2))),R-1!=L&&R!=L&&O0(i0+" idx:"+R+" != size:"+L,3),j0=null;var n=L%z0;if(n>0){var Y=(L-n)*2;j0=new Int16Array(A.buffer.slice(Y)),A=new Int16Array(A.buffer.slice(0,Y))}var E={index:a0,offset:A0,raisePrev:B0,filter:R0,frameNext:j0,sampleRate:r,data:A};return D0&&(E._sum=Q0),E},T.IIRFilter=function(x,B,r){var O=2*Math.PI*r/B,z=Math.sin(O),i0=Math.cos(O),a0=z/2,A0=1+a0,B0=-2*i0/A0,R0=(1-a0)/A0;if(x)var m0=(1-i0)/2/A0,re=(1-i0)/A0;else var m0=(1+i0)/2/A0,re=-(1+i0)/A0;var j0=0,z0=0,D0=0,Q0=0,f=0,L=function(H){return D0=m0*H+re*j0+m0*z0-B0*Q0-R0*f,z0=j0,j0=H,f=Q0,Q0=D0,D0};return L.Embed={x1:0,x2:0,y1:0,y2:0,b0:m0,b1:re,a1:B0,a2:R0},L},T.PowerLevel=function(x,B){var r=x/B||0,O;return r<1251?O=Math.round(r/1250*10):O=Math.round(Math.min(100,Math.max(0,(1+Math.log(r/1e4)/Math.log(10))*100))),O},T.PowerDBFS=function(x){var B=Math.max(.1,x||0),r=32767;return B=Math.min(B,r),B=20*Math.log(B/r)/Math.log(10),Math.max(-100,Math.round(B))},T.CLog=function(x,B){if(typeof console=="object"){var r=new Date,O=("0"+r.getMinutes()).substr(-2)+":"+("0"+r.getSeconds()).substr(-2)+"."+("00"+r.getMilliseconds()).substr(-3),z=this&&this.envIn&&this.envCheck&&this.id,i0=["["+O+" "+o0+(z?":"+z:"")+"]"+x],a0=arguments,A0=T.CLog,B0=2,R0=A0.log||console.log;for(s0(B)?R0=B==1?A0.error||console.error:B==3?A0.warn||console.warn:R0:B0=1;B0<a0.length;B0++)i0.push(a0[B0]);q0?R0&&R0("[IsLoser]"+i0[0],i0.length>1?i0:""):R0.apply(console,i0)}};var O0=function(){T.CLog.apply(this,arguments)},q0=!0;try{q0=!console.log.apply}catch{}var me=0;function ve(x){var B=this;B.id=++me,Pe();var r={type:"mp3",onProcess:j};for(var O in x)r[O]=x[O];B.set=r;var z=r[T0],i0=r[d0];(z&&!s0(z)||i0&&!s0(i0))&&B.CLog(h0.G("IllegalArgs-1",[h0("VtS4::{1}和{2}必须是数值",0,d0,T0)]),1,x),r[T0]=+z||16,r[d0]=+i0||16e3,B.state=0,B._S=9,B.Sync={O:9,C:9}}T.Sync={O:9,C:9},T.prototype=ve.prototype={CLog:O0,_streamStore:function(){return this.set.sourceStream?this:T},_streamGet:function(){return this._streamStore().Stream},_streamCtx:function(){var x=this._streamGet();return x&&x._c},open:function(x,B){var r=this,O=r.set,z=r._streamStore(),i0=0;x=x||j;var a0=function(C,N){N=!!N,r.CLog(h0("5tWi::录音open失败：")+C+",isUserNotAllow:"+N,1),i0&&T.CloseNewCtx(i0),B&&B(C,N)};r._streamTag=C0;var A0=function(){r.CLog("open ok, id:"+r.id+" stream:"+r._streamTag),x(),r._SO=0},B0=z.Sync,R0=++B0.O,m0=B0.C;r._O=r._O_=R0,r._SO=r._S;var re=function(){if(m0!=B0.C||!r._O){var C=h0("dFm8::open被取消");return R0==B0.O?r.close():C=h0("VtJO::open被中断"),a0(C),!0}};if(!$){a0(h0.G("NonBrowser-1",["open"])+h0("EMJq::，可尝试使用RecordApp解决方案")+"("+M0+"/tree/master/app-support-sample)");return}var j0=r.envCheck({envName:"H5",canProcess:!0});if(j0){a0(h0("A5bm::不能录音：")+j0);return}var z0,D0=function(){z0=O.runningContext,z0||(z0=i0=T.GetContext(!0))};if(O.sourceStream){if(r._streamTag="set.sourceStream",!T.GetContext()){a0(h0("1iU7::不支持此浏览器从流中获取录音"));return}D0(),_0(z);var Q0=r.Stream=O.sourceStream;Q0._c=z0,Q0._RC=O.runningContext,Q0._call={};try{y0(z)}catch(C){_0(z),a0(h0("BTW2::从流中打开录音失败：")+C.message);return}A0();return}var f=function(C,N){try{window.top.a}catch{a0(h0("Nclz::无权录音(跨域，请尝试给iframe添加麦克风访问策略，如{1})",0,'allow="camera;microphone"'));return}L(1,C)&&(/Found/i.test(C)?a0(N+h0("jBa9::，无可用麦克风")):a0(N))},L=function(C,N){if(/Permission|Allow/i.test(N))C&&a0(h0("gyO5::用户拒绝了录音权限"),!0);else if(window.isSecureContext===!1)C&&a0(h0("oWNo::浏览器禁止不安全页面录音，可开启https解决"));else return 1};if(T.IsOpen()){A0();return}if(!T.Support()){f("",h0("COxc::此浏览器不支持录音"));return}D0();var H=function(C){setTimeout(function(){C._call={};var N=T.Stream;N&&(_0(),C._call=N._call),T.Stream=C,C._c=z0,C._RC=O.runningContext,!re()&&(T.IsOpen()?(N&&r.CLog(h0("upb8::发现同时多次调用open"),1),y0(z),A0()):a0(h0("Q1GA::录音功能无效：无音频流")))},100)},m=function(C){var N=C.name||C.message||C.code+":"+C,s="";Q==1&&L(0,N)&&(s=h0("KxE2::，将尝试禁用回声消除后重试"));var y=h0("xEQR::请求录音权限错误"),a=h0("bDOG::无法录音：");r.CLog(y+s+"|"+C,s||R?3:1,C),s?(A=N,R=C,e0(1)):R?(r.CLog(y+"|"+R,1,R),f(A,a+R)):f(N,a+C)},Q=0,A,R,e0=function(C){Q++;var N="audioTrackSet",s="autoGainControl",y="echoCancellation",a="noiseSuppression",w=N+":{"+y+","+a+","+s+"}",S=JSON.parse(V0(O[N]||!0));r.CLog("open... "+Q+" "+N+":"+V0(S)),C&&(typeof S!="object"&&(S={}),S[s]=!1,S[y]=!1,S[a]=!1),S[d0]&&r.CLog(h0("IjL3::注意：已配置{1}参数，可能会出现浏览器不能正确选用麦克风、移动端无法启用回声消除等现象",0,N+"."+d0),3);var l={audio:S,video:O.videoTrackSet||!1};try{var v=T.Scope[C0](l,H,m)}catch(b){r.CLog(C0,3,b),l={audio:!0,video:!1},v=T.Scope[C0](l,H,m)}r.CLog(C0+"("+V0(l)+") "+n0(z0)+h0("RiWe::，未配置 {1} 时浏览器可能会自动启用回声消除，移动端未禁用回声消除时可能会降低系统播放音量（关闭录音后可恢复）和仅提供16k采样率的音频流（不需要回声消除时可明确配置成禁用来获得48k高音质的流），请参阅文档中{2}配置",0,w,N)+"("+M0+") LM:"+X+" UA:"+navigator.userAgent),v&&v.then&&v.then(H)[P](m)};e0()},close:function(x){x=x||j;var B=this,r=B._streamStore();B._stop();var O=" stream:"+B._streamTag,z=r.Sync;if(B._O=0,B._O_!=z.O){B.CLog(h0("hWVz::close被忽略（因为同时open了多个rec，只有最后一个会真正close）")+O,3),x();return}z.C++,_0(r),B.CLog("close,"+O),x()},mock:function(x,B){var r=this;return r._stop(),r.isMock=1,r.mockEnvInfo=null,r.buffers=[x],r.recSize=x.length,r._setSrcSR(B),r._streamTag="mock",r},_setSrcSR:function(x){var B=this,r=B.set,O=r[d0];O>x?r[d0]=x:O=0,B[U0]=x,B.CLog(U0+": "+x+" set."+d0+": "+r[d0]+(O?" "+h0("UHvm::忽略")+": "+O:""),O?3:0)},envCheck:function(x){var B,r=this,O=r.set,z="CPU_BE";if(!B&&!T[z]&&typeof Int8Array=="function"&&!new Int8Array(new Int32Array([1]).buffer)[0]&&(Pe(z),B=h0("Essp::不支持{1}架构",0,z)),!B){var i0=O.type,a0=r[i0+"_envCheck"];O.takeoffEncodeChunk&&(a0?x.canProcess||(B=h0("7uMV::{1}环境不支持实时处理",0,x.envName)):B=h0("2XBl::{1}类型不支持设置takeoffEncodeChunk",0,i0)+(r[i0]?"":h0("LG7e::(未加载编码器)"))),!B&&a0&&(B=r[i0+"_envCheck"](x,O))}return B||""},envStart:function(x,B){var r=this,O=r.set;if(r.isMock=x?1:0,r.mockEnvInfo=x,r.buffers=[],r.recSize=0,x&&(r._streamTag="env$"+x.envName),r.state=1,r.envInLast=0,r.envInFirst=0,r.envInFix=0,r.envInFixTs=[],r._setSrcSR(B),r.engineCtx=0,r[O.type+"_start"]){var z=r.engineCtx=r[O.type+"_start"](O);z&&(z.pcmDatas=[],z.pcmSize=0)}},envResume:function(){this.envInFixTs=[]},envIn:function(x,B){var r=this,O=r.set,z=r.engineCtx;if(r.state!=1){r.state||r.CLog("envIn at state=0",3);return}var i0=r[U0],a0=x.length,A0=T.PowerLevel(B,a0),B0=r.buffers,R0=B0.length;B0.push(x);var m0=B0,re=R0,j0=Date.now(),z0=Math.round(a0/i0*1e3);r.envInLast=j0,r.buffers.length==1&&(r.envInFirst=j0-z0);var D0=r.envInFixTs;D0.splice(0,0,{t:j0,d:z0});for(var Q0=j0,f=0,L=0;L<D0.length;L++){var H=D0[L];if(j0-H.t>3e3){D0.length=L;break}Q0=H.t,f+=H.d}var m=D0[1],Q=j0-Q0,A=Q-f;if(A>Q/3&&(m&&Q>1e3||D0.length>=6)){var R=j0-m.t-z0;if(R>z0/5){var e0=!O.disableEnvInFix;if(r.CLog("["+j0+"]"+ce.get(h0(e0?"4Kfd::补偿{1}ms":"bM5i::未补偿{1}ms",1),[R]),3),r.envInFix+=R,e0){var C=new Int16Array(R*i0/1e3);a0+=C.length,B0.push(C)}}}var N=r.recSize,s=a0,y=N+s;if(r.recSize=y,z){var a=T.SampleData(B0,i0,O[d0],z.chunkInfo);z.chunkInfo=a,N=z.pcmSize,s=a.data.length,y=N+s,z.pcmSize=y,B0=z.pcmDatas,R0=B0.length,B0.push(a.data),i0=a[d0]}var w=Math.round(y/i0*1e3),S=B0.length,l=m0.length,v=function(){for(var e=b?0:-s,M=B0[0]==null,h=R0;h<S;h++){var g=B0[h];g==null?M=1:(e+=g.length,z&&g.length&&r[O.type+"_encode"](z,g))}if(M&&z){var h=re;for(m0[0]&&(h=0);h<l;h++)m0[h]=null}M&&(e=b?s:0,B0[0]=null),z?z.pcmSize+=e:r.recSize+=e},b=0,d="rec.set.onProcess";try{b=O.onProcess(B0,A0,w,i0,R0,v),b=b===!0}catch(e){console.error(d+h0("gFUF::回调出错是不允许的，需保证不会抛异常"),e)}var o=Date.now()-j0;if(o>10&&r.envInFirst-j0>1e3&&r.CLog(d+h0("2ghS::低性能，耗时{1}ms",0,o),3),b){for(var c=0,L=R0;L<S;L++)B0[L]==null?c=1:B0[L]=new Int16Array(0);c?r.CLog(h0("ufqH::未进入异步前不能清除buffers"),3):z?z.pcmSize-=s:r.recSize-=s}else v()},start:function(){var x=this,B=1;if(x.set.sourceStream?x.Stream||(B=0):T.IsOpen()||(B=0),!B){x.CLog(h0("6WmN::start失败：未open"),1);return}var r=x._streamCtx();if(x.CLog(h0("kLDN::start 开始录音，")+n0(r)+" stream:"+x._streamTag),x._stop(),x.envStart(null,r[d0]),x.state=3,x._SO&&x._SO+1!=x._S){x.CLog(h0("Bp2y::start被中断"),3);return}x._SO=0;var O=function(){x.state==3&&(x.state=1,x.resume())},z="AudioContext resume: ",i0=x._streamGet();i0._call[x.id]=function(){x.CLog(z+r.state+"|stream ok"),O()},U(r,function(a0){return a0&&x.CLog(z+"wait..."),x.state==3},function(a0){a0&&x.CLog(z+r.state),O()},function(a0){x.CLog(z+r.state+h0("upkE::，可能无法录音：")+a0,1),O()})},pause:function(){var x=this,B=x._streamGet();x.state&&(x.state=2,x.CLog("pause"),B&&delete B._call[x.id])},resume:function(){var x=this,B=x._streamGet(),r="resume",O=r+"(wait ctx)";if(x.state==3)x.CLog(O);else if(x.state){x.state=1,x.CLog(r),x.envResume(),B&&(B._call[x.id]=function(i0,a0){x.state==1&&x.envIn(i0,a0)},g0(B));var z=x._streamCtx();z&&U(z,function(i0){return i0&&x.CLog(O+"..."),x.state==1},function(i0){i0&&x.CLog(O+z.state),g0(B)},function(i0){x.CLog(O+z.state+"[err]"+i0,1)})}},_stop:function(x){var B=this,r=B.set;B.isMock||B._S++,B.state&&(B.pause(),B.state=0),!x&&B[r.type+"_stop"]&&(B[r.type+"_stop"](B.engineCtx),B.engineCtx=0)},stop:function(x,B,r){var O=this,z=O.set,i0,a0=O.envInLast-O.envInFirst,A0=a0&&O.buffers.length;O.CLog(h0("Xq4s::stop 和start时差:")+(a0?a0+"ms "+h0("3CQP::补偿:")+O.envInFix+"ms envIn:"+A0+" fps:"+(A0/a0*1e3).toFixed(1):"-")+" stream:"+O._streamTag+" ("+M0+") LM:"+X);var B0=function(){O._stop(),r&&O.close()},R0=function(H){O.CLog(h0("u8JG::结束录音失败：")+H,1),B&&B(H),B0()},m0=function(H,m,Q){var A="blob",R="arraybuffer",e0="dataType",C="DefaultDataType",N=O[e0]||T[C]||A,s=e0+"="+N,y=H instanceof ArrayBuffer,a=0,w=y?H.byteLength:H.size;if(N==R?y||(a=1):N==A?typeof Blob!="function"?a=h0.G("NonBrowser-1",[s])+h0("1skY::，请设置{1}",0,o0+"."+C+'="'+R+'"'):(y&&(H=new Blob([H],{type:m})),H instanceof Blob||(a=1),m=H.type||m):a=h0.G("NotSupport-1",[s]),O.CLog(h0("Wv7l::结束录音 编码花{1}ms 音频时长{2}ms 文件大小{3}b",0,Date.now()-i0,Q,w)+" "+s+","+m),a){R0(a!=1?a:h0("Vkbd::{1}编码器返回的不是{2}",0,z.type,N)+", "+s);return}if(z.takeoffEncodeChunk)O.CLog(h0("QWnr::启用takeoffEncodeChunk后stop返回的blob长度为0不提供音频数据"),3);else if(w<Math.max(50,Q/5)){R0(h0("Sz2H::生成的{1}无效",0,z.type));return}x&&x(H,Q,m),B0()};if(!O.isMock){var re=O.state==3;if(!O.state||re){R0(h0("wf9t::未开始录音")+(re?h0("Dl2c::，开始录音前无用户交互导致AudioContext未运行"):""));return}}O._stop(!0);var j0=O.recSize;if(!j0){R0(h0("Ltz3::未采集到录音"));return}if(!O[z.type]){R0(h0("xGuI::未加载{1}编码器，请尝试到{2}的src/engine内找到{1}的编码器并加载",0,z.type,o0));return}if(O.isMock){var z0=O.envCheck(O.mockEnvInfo||{envName:"mock",canProcess:!1});if(z0){R0(h0("AxOH::录音错误：")+z0);return}}var D0=O.engineCtx;if(O[z.type+"_complete"]&&D0){var L=Math.round(D0.pcmSize/z[d0]*1e3);i0=Date.now(),O[z.type+"_complete"](D0,function(m,Q){m0(m,Q,L)},R0);return}if(i0=Date.now(),!O.buffers[0]){R0(h0("xkKd::音频buffers被释放"));return}var Q0=T.SampleData(O.buffers,O[U0],z[d0]);z[d0]=Q0[d0];var f=Q0.data,L=Math.round(f.length/z[d0]*1e3);O.CLog(h0("CxeT::采样:{1} 花:{2}ms",0,j0+"->"+f.length,Date.now()-i0)),setTimeout(function(){i0=Date.now(),O[z.type](f,function(H,m){m0(H,m,L)},function(H){R0(H)})})}};var Ae=function(x,B){B.pos||(B.pos=[0],B.tracks={},B.bytes=[]);var r=B.tracks,O=[B.pos[0]],z=function(){B.pos[0]=O[0]},i0=B.bytes.length,a0=new Uint8Array(i0+x.length);if(a0.set(B.bytes),a0.set(x,i0),B.bytes=a0,!B._ht){if(ee(a0,O),Re(a0,O),!pe(ee(a0,O),[24,83,128,103]))return;for(ee(a0,O);O[0]<a0.length;){var A0=ee(a0,O),B0=Re(a0,O),R0=[0],m0=0;if(!B0)return;if(pe(A0,[22,84,174,107])){for(;R0[0]<B0.length;){var re=ee(B0,R0),j0=Re(B0,R0),z0=[0],D0={channels:0,sampleRate:0};if(pe(re,[174]))for(;z0[0]<j0.length;){var Q0=ee(j0,z0),f=Re(j0,z0),L=[0];if(pe(Q0,[215])){var H=ae(f);D0.number=H,r[H]=D0}else if(pe(Q0,[131])){var H=ae(f);H==1?D0.type="video":H==2?(D0.type="audio",m0||(B.track0=D0),D0.idx=m0++):D0.type="Type-"+H}else if(pe(Q0,[134])){for(var m="",Q=0;Q<f.length;Q++)m+=String.fromCharCode(f[Q]);D0.codec=m}else if(pe(Q0,[225]))for(;L[0]<f.length;){var A=ee(f,L),R=Re(f,L);if(pe(A,[181])){var H=0,e0=new Uint8Array(R.reverse()).buffer;R.length==4?H=new Float32Array(e0)[0]:R.length==8?H=new Float64Array(e0)[0]:O0("WebM Track !Float",1,R),D0[d0]=Math.round(H)}else pe(A,[98,100])?D0.bitDepth=ae(R):pe(A,[159])&&(D0.channels=ae(R))}}}B._ht=1,O0("WebM Tracks",r),z();break}}}var C=B.track0;if(C){var N=C[d0];if(B.webmSR=N,C.bitDepth==16&&/FLOAT/i.test(C.codec)&&(C.bitDepth=32,O0("WebM 16->32 bit",3)),N<8e3||C.bitDepth!=32||C.channels<1||!/(\b|_)PCM\b/i.test(C.codec))return B.bytes=[],B.bad||O0("WebM Track Unexpected",3,B),B.bad=1,-1;for(var s=[],y=0;O[0]<a0.length;){var re=ee(a0,O),j0=Re(a0,O);if(!j0)break;if(pe(re,[163])){var a=j0[0]&15,D0=r[a];if(D0){if(D0.idx===0){for(var w=new Uint8Array(j0.length-4),Q=4;Q<j0.length;Q++)w[Q-4]=j0[Q];s.push(w),y+=w.length}}else return O0("WebM !Track"+a,1,r),-1}z()}if(y){var S=new Uint8Array(a0.length-B.pos[0]);S.set(a0.subarray(B.pos[0])),B.bytes=S,B.pos[0]=0;for(var w=new Uint8Array(y),Q=0,l=0;Q<s.length;Q++)w.set(s[Q],l),l+=s[Q].length;var e0=new Float32Array(w.buffer);if(C.channels>1){for(var v=[],Q=0;Q<e0.length;)v.push(e0[Q]),Q+=C.channels;e0=new Float32Array(v)}return e0}}},pe=function(x,B){if(!x||x.length!=B.length)return!1;if(x.length==1)return x[0]==B[0];for(var r=0;r<x.length;r++)if(x[r]!=B[r])return!1;return!0},ae=function(x){for(var B="",r=0;r<x.length;r++){var O=x[r];B+=(O<16?"0":"")+O.toString(16)}return parseInt(B,16)||0},ee=function(x,B,r){var O=B[0];if(!(O>=x.length)){var z=x[O],i0=("0000000"+z.toString(2)).substr(-8),a0=/^(0*1)(\d*)$/.exec(i0);if(a0){var A0=a0[1].length,B0=[];if(!(O+A0>x.length)){for(var R0=0;R0<A0;R0++)B0[R0]=x[O],O++;return r&&(B0[0]=parseInt(a0[2]||"0",2)),B[0]=O,B0}}}},Re=function(x,B){var r=ee(x,B,1);if(r){var O=ae(r),z=B[0],i0=[];if(O<2147483647){if(z+O>x.length)return;for(var a0=0;a0<O;a0++)i0[a0]=x[z],z++}return B[0]=z,i0}},ce=T.i18n={lang:"zh-CN",alias:{"zh-CN":"zh","en-US":"en"},locales:{},data:{},put:function(x,B){var r=o0+".i18n.put: ",O=x.overwrite;O=O==null||O;var z=x.lang;if(z=ce.alias[z]||z,!z)throw new Error(r+"set.lang?");var i0=ce.locales[z];i0||(i0={},ce.locales[z]=i0);for(var a0=/^([\w\-]+):/,A0,B0=0;B0<B.length;B0++){var m0=B[B0];if(A0=a0.exec(m0),!A0){O0(r+"'key:'? "+m0,3,x);continue}var R0=A0[1],m0=m0.substr(R0.length+1);!O&&i0[R0]||(i0[R0]=m0)}},get:function(){return ce.v_G.apply(null,arguments)},v_G:function(x,B,r){B=B||[],r=r||ce.lang,r=ce.alias[r]||r;var O=ce.locales[r],z=O&&O[x]||"";return!z&&r!="zh"?r=="en"?ce.v_G(x,B,"zh"):ce.v_G(x,B,"en"):(ce.lastLang=r,z=="=Empty"?"":z.replace(/\{(\d+)(\!?)\}/g,function(i0,a0,A0){return a0=+a0||0,i0=B[a0-1],(a0<1||a0>B.length)&&(i0="{?}",O0("i18n["+x+"] no {"+a0+"}: "+z,3)),A0?"":i0}))},$T:function(){return ce.v_T.apply(null,arguments)},v_T:function(){for(var x=arguments,B="",r=[],O=0,z=o0+".i18n.$T:",i0=/^([\w\-]*):/,a0,A0=0;A0<x.length;A0++){var B0=x[A0];if(A0==0){if(a0=i0.exec(B0),B=a0&&a0[1],!B)throw new Error(z+"0 'key:'?");B0=B0.substr(B.length+1)}if(O===-1)r.push(B0);else{if(O)throw new Error(z+" bad args");if(B0===0)O=-1;else if(s0(B0)){if(B0<1)throw new Error(z+" bad args");O=B0}else{var R0=A0==1?"en":A0?"":"zh";if(a0=i0.exec(B0),a0&&(R0=a0[1]||R0,B0=B0.substr(a0[1].length+1)),!a0||!R0)throw new Error(z+A0+" 'lang:'?");ce.put({lang:R0,overwrite:!1},[B+":"+B0])}}}return B?O>0?B:ce.v_G(B,r):""}},h0=ce.$T;h0.G=ce.get,h0("NonBrowser-1::非浏览器环境，不支持{1}",1),h0("IllegalArgs-1::参数错误：{1}",1),h0("NeedImport-2::调用{1}需要先导入{2}",2),h0("NotSupport-1::不支持：{1}",1),T.TrafficImgUrl="//ia.51.la/go1?id=20469973&pvFlag=1";var Pe=T.Traffic=function(x){if($){x=x?"/"+o0+"/Report/"+x:"";var B=T.TrafficImgUrl;if(B){var r=T.Traffic,O=/^(https?:..[^\/#]*\/?)[^#]*/i.exec(location.href)||[],z=O[1]||"http://file/",i0=(O[0]||z)+x;if(B.indexOf("//")==0&&(/^https:/i.test(i0)?B="https:"+B:B="http:"+B),x&&(B=B+"&cu="+encodeURIComponent(z+x)),!r[i0]){r[i0]=1;var a0=new Image;a0.src=B,O0("Traffic Analysis Image: "+(x||o0+".TrafficImgUrl="+T.TrafficImgUrl))}}}};W&&(O0(h0("8HO5::覆盖导入{1}",0,o0),1),W.Destroy()),G[o0]=T})})(S1);var K1=S1.exports,a1=W1(K1);(function(K){var G=typeof window=="object"&&!!window.document,$=G?window:Object,j=$.Recorder,s0=j.i18n;K(j,s0,s0.$T,G)})(function(K,G,$,j){var s0="48000, 44100, 32000, 24000, 22050, 16000, 12000, 11025, 8000",V0="8, 16, 24, 32, 40, 48, 56, 64, 80, 96, 112, 128, 144, 160, 192, 224, 256, 320";K.prototype.enc_mp3={stable:!0,takeEC:"full",getTestMsg:function(){return $("Zm7L::采样率范围：{1}；比特率范围：{2}（不同比特率支持的采样率范围不同，小于32kbps时采样率需小于32000）",0,s0,V0)}};var T=function(P){var W=P.bitRate,c0=P.sampleRate,L0=c0;if((" "+V0+",").indexOf(" "+W+",")==-1&&K.CLog($("eGB9::{1}不在mp3支持的取值范围：{2}",0,"bitRate="+W,V0),3),(" "+s0+",").indexOf(" "+c0+",")==-1){for(var U=s0.split(", "),I0=[],n0=0;n0<U.length;n0++)I0.push({v:+U[n0],s:Math.abs(U[n0]-c0)});I0.sort(function(S0,r0){return S0.s-r0.s}),L0=I0[0].v,P.sampleRate=L0,K.CLog($("zLTa::sampleRate已更新为{1}，因为{2}不在mp3支持的取值范围：{3}",0,L0,c0,s0),3)}},X=function(){return $.G("NeedImport-2",["mp3.js","src/engine/mp3-engine.js"])},M0=j&&typeof Worker=="function";K.prototype.mp3=function(P,W,c0){var L0=this,U=L0.set,I0=P.length;if(!K.lamejs){c0(X());return}if(M0){var n0=L0.mp3_start(U);if(n0){if(n0.isW){L0.mp3_encode(n0,P),L0.mp3_complete(n0,W,c0,1);return}L0.mp3_stop(n0)}}T(U);var S0=new K.lamejs.Mp3Encoder(1,U.sampleRate,U.bitRate),r0=57600,y0=new Int8Array(5e5),g0=0,H0=0,x0=0,_0=function(){try{if(H0<I0)var D=S0.encodeBuffer(P.subarray(H0,H0+r0));else{x0=1;var D=S0.flush()}}catch(ve){if(console.error(ve),!x0)try{S0.flush()}catch(Ae){console.error(Ae)}c0("MP3 Encoder: "+ve.message);return}var W0=D.length;if(W0>0){if(g0+W0>y0.length){var O0=new Int8Array(y0.length+Math.max(5e5,W0));O0.set(y0.subarray(0,g0)),y0=O0}y0.set(D,g0),g0+=W0}if(H0<I0)H0+=r0,setTimeout(_0);else{var q0=[y0.buffer.slice(0,g0)],me=d0.fn(q0,g0,I0,U.sampleRate);T0(me,U),W(q0[0]||new ArrayBuffer(0),"audio/mp3")}};_0()};var o0;K.BindDestroy("mp3Worker",function(){o0&&(K.CLog("mp3Worker Destroy"),o0.terminate(),o0=null)}),K.prototype.mp3_envCheck=function(P,W){var c0="";return W.takeoffEncodeChunk&&(U0()||(c0=$("yhUs::当前浏览器版本太低，无法实时处理"))),!c0&&!K.lamejs&&(c0=X()),c0},K.prototype.mp3_start=function(P){return U0(P)};var C0={id:0},U0=function(P,W){var c0=function(x0){var _0=x0.data,D=I0.wkScope.wk_ctxs,W0=I0.wkScope.wk_lame,O0=I0.wkScope.wk_mp3TrimFix,q0=D[_0.id];if(_0.action=="init")D[_0.id]={sampleRate:_0.sampleRate,bitRate:_0.bitRate,takeoff:_0.takeoff,pcmSize:0,memory:new Int8Array(5e5),mOffset:0,encObj:new W0.Mp3Encoder(1,_0.sampleRate,_0.bitRate)};else if(!q0)return;var me=function(ae){var ee=ae.length;if(q0.mOffset+ee>q0.memory.length){var Re=new Int8Array(q0.memory.length+Math.max(5e5,ee));Re.set(q0.memory.subarray(0,q0.mOffset)),q0.memory=Re}q0.memory.set(ae,q0.mOffset),q0.mOffset+=ee};switch(_0.action){case"stop":if(!q0.isCp)try{q0.encObj.flush()}catch(ae){console.error(ae)}q0.encObj=null,delete D[_0.id];break;case"encode":if(q0.isCp)break;q0.pcmSize+=_0.pcm.length;try{var ve=q0.encObj.encodeBuffer(_0.pcm)}catch(ae){q0.err=ae,console.error(ae)}ve&&ve.length>0&&(q0.takeoff?n0.onmessage({action:"takeoff",id:_0.id,chunk:ve}):me(ve));break;case"complete":q0.isCp=1;try{var ve=q0.encObj.flush()}catch(ae){q0.err=ae,console.error(ae)}if(ve&&ve.length>0&&(q0.takeoff?n0.onmessage({action:"takeoff",id:_0.id,chunk:ve}):me(ve)),q0.err){n0.onmessage({action:_0.action,id:_0.id,err:"MP3 Encoder: "+q0.err.message});break}var Ae=[q0.memory.buffer.slice(0,q0.mOffset)],pe=O0.fn(Ae,q0.mOffset,q0.pcmSize,q0.sampleRate);n0.onmessage({action:_0.action,id:_0.id,blob:Ae[0]||new ArrayBuffer(0),meta:pe});break}},L0=function(x0){n0.onmessage=function(_0){var D=_0;x0&&(D=_0.data);var W0=C0[D.id];W0&&(D.action=="takeoff"?W0.set.takeoffEncodeChunk(new Uint8Array(D.chunk.buffer)):(W0.call&&W0.call(D),W0.call=null))}},U=function(){var x0={worker:n0,set:P};return P?(x0.id=++C0.id,C0[x0.id]=x0,T(P),n0.postMessage({action:"init",id:x0.id,sampleRate:P.sampleRate,bitRate:P.bitRate,takeoff:!!P.takeoffEncodeChunk,x:new Int16Array(5)})):n0.postMessage({x:new Int16Array(5)}),x0},I0,n0=o0;if(W||!M0)return K.CLog($("k9PT::当前环境不支持Web Worker，mp3实时编码器运行在主线程中"),3),n0={postMessage:function(x0){c0({data:x0})}},I0={wkScope:{wk_ctxs:{},wk_lame:K.lamejs,wk_mp3TrimFix:d0}},L0(),U();try{if(!n0){var S0=(c0+"").replace(/[\w\$]+\.onmessage/g,"self.postMessage");S0=S0.replace(/[\w\$]+\.wkScope/g,"wkScope");var r0=");wk_lame();self.onmessage="+S0;r0+=";var wkScope={ wk_ctxs:{},wk_lame:wk_lame",r0+=",wk_mp3TrimFix:{rm:"+d0.rm+",fn:"+d0.fn+"} }";var y0=K.lamejs.toString(),g0=(window.URL||webkitURL).createObjectURL(new Blob(["var wk_lame=(",y0,r0],{type:"text/javascript"}));n0=new Worker(g0),setTimeout(function(){(window.URL||webkitURL).revokeObjectURL(g0)},1e4),L0(1)}var H0=U();return H0.isW=1,o0=n0,H0}catch(x0){return n0&&n0.terminate(),console.error(x0),U0(P,1)}};K.prototype.mp3_stop=function(P){if(P&&P.worker){P.worker.postMessage({action:"stop",id:P.id}),P.worker=null,delete C0[P.id];var W=-1;for(var c0 in C0)W++;W&&K.CLog($("fT6M::mp3 worker剩{1}个未stop",0,W),3)}},K.prototype.mp3_encode=function(P,W){P&&P.worker&&P.worker.postMessage({action:"encode",id:P.id,pcm:W})},K.prototype.mp3_complete=function(P,W,c0,L0){var U=this;P&&P.worker?(P.call=function(I0){L0&&U.mp3_stop(P),I0.err?c0(I0.err):(T0(I0.meta,P.set),W(I0.blob,"audio/mp3"))},P.worker.postMessage({action:"complete",id:P.id})):c0($("mPxH::mp3编码器未start"))},K.mp3ReadMeta=function(P,W){var c0=typeof window<"u"&&window.parseInt||typeof self<"u"&&self.parseInt||parseInt,L0=new Uint8Array(P[0]||[]);if(L0.length<4)return null;var U=function(ae,ee){return("0000000"+((ee||L0)[ae]||0).toString(2)).substr(-8)},I0=U(0)+U(1),n0=U(2)+U(3);if(!/^1{11}/.test(I0))return null;var S0={"00":2.5,10:2,11:1}[I0.substr(11,2)],r0={"01":3}[I0.substr(13,2)],y0={1:[44100,48e3,32e3],2:[22050,24e3,16e3],"2.5":[11025,12e3,8e3]}[S0];y0&&(y0=y0[c0(n0.substr(4,2),2)]);var g0=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320]][S0==1?1:0][c0(n0.substr(0,4),2)];if(!S0||!r0||!g0||!y0)return null;for(var H0=Math.round(W*8/g0),x0=r0==1?384:r0==2||S0==1?1152:576,_0=x0/y0*1e3,D=Math.floor(x0*g0/8/y0*1e3),W0=0,O0=0,q0=0;q0<P.length;q0++){var me=P[q0];if(O0+=me.byteLength,O0>=D+3){var ve=new Uint8Array(me),Ae=me.byteLength-(O0-(D+3)+1),pe=U(Ae,ve);W0=pe.charAt(6)=="1";break}}return W0&&D++,{version:S0,layer:r0,sampleRate:y0,bitRate:g0,duration:H0,size:W,hasPadding:W0,frameSize:D,frameDurationFloat:_0}};var d0={rm:K.mp3ReadMeta,fn:function(P,W,c0,L0){var U=this.rm(P,W);if(!U)return{size:W,err:"mp3 unknown format"};var I0=Math.round(c0/L0*1e3),n0=Math.floor((U.duration-I0)/U.frameDurationFloat);if(n0>0){var S0=n0*U.frameSize-(U.hasPadding?1:0);W-=S0;for(var r0=0,y0=[],g0=0;g0<P.length;g0++){var H0=P[g0];if(S0<=0)break;S0>=H0.byteLength?(S0-=H0.byteLength,y0.push(H0),P.splice(g0,1),g0--):(P[g0]=H0.slice(S0),r0=H0,S0=0)}var x0=this.rm(P,W);if(!x0){r0&&(P[0]=r0);for(var g0=0;g0<y0.length;g0++)P.splice(g0,0,y0[g0]);U.err="mp3 fix error: 已还原，错误原因不明"}var _0=U.trimFix={};_0.remove=n0,_0.removeDuration=Math.round(n0*U.frameDurationFloat),_0.duration=Math.round(W*8/U.bitRate)}return U}},T0=function(P,W){var c0="MP3 Info: ";(P.sampleRate&&P.sampleRate!=W.sampleRate||P.bitRate&&P.bitRate!=W.bitRate)&&(K.CLog(c0+$("uY9i::和设置的不匹配{1}，已更新成{2}",0,"set:"+W.bitRate+"kbps "+W.sampleRate+"hz","set:"+P.bitRate+"kbps "+P.sampleRate+"hz"),3,W),W.sampleRate=P.sampleRate,W.bitRate=P.bitRate);var L0=P.trimFix;L0?(c0+=$("iMSm::Fix移除{1}帧",0,L0.remove)+" "+L0.removeDuration+"ms -> "+L0.duration+"ms",L0.remove>2&&(P.err=(P.err?P.err+", ":"")+$("b9zm::移除帧数过多"))):c0+=(P.duration||"-")+"ms",P.err?K.CLog(c0,P.size?1:0,P.err,P):K.CLog(c0,P)}});(function(K){var G=typeof window=="object"&&!!window.document,$=G?window:Object,j=$.Recorder,s0=j.i18n;K(j,s0,s0.$T,G)})(function(K,G,$,j){K.prototype.enc_wav={stable:!0,fast:!0,getTestMsg:function(){return $("gPSE::支持位数8位、16位（填在比特率里面），采样率取值无限制；此编码器仅在pcm数据前加了一个44字节的wav头，编码出来的16位wav文件去掉开头的44字节即可得到pcm（注：其他wav编码器可能不是44字节）")}};var s0=function(V0){var T=V0.bitRate,X=T==8?8:16;T!=X&&K.CLog($("wyw9::WAV Info: 不支持{1}位，已更新成{2}位",0,T,X),3),V0.bitRate=X};K.prototype.wav=function(V0,T,X){var M0=this,o0=M0.set;s0(o0);var C0=V0.length,U0=o0.sampleRate,d0=o0.bitRate,T0=C0*(d0/8),P=K.wav_header(1,1,U0,d0,T0),W=P.length,c0=new Uint8Array(W+T0);if(c0.set(P),d0==8)for(var L0=0;L0<C0;L0++){var U=(V0[L0]>>8)+128;c0[W++]=U}else c0=new Int16Array(c0.buffer),c0.set(V0,W/2);T(c0.buffer,"audio/wav")},K.wav_header=function(V0,T,X,M0,o0){var C0=V0==1?0:2,U0=new ArrayBuffer(44+C0),d0=new DataView(U0),T0=0,P=function(L0){for(var U=0;U<L0.length;U++,T0++)d0.setUint8(T0,L0.charCodeAt(U))},W=function(L0){d0.setUint16(T0,L0,!0),T0+=2},c0=function(L0){d0.setUint32(T0,L0,!0),T0+=4};return P("RIFF"),c0(36+C0+o0),P("WAVE"),P("fmt "),c0(16+C0),W(V0),W(T),c0(X),c0(X*(T*M0/8)),W(T*M0/8),W(M0),V0!=1&&W(0),P("data"),c0(o0),new Uint8Array(U0)}});(function(K){var G=typeof window=="object"&&!!window.document,$=G?window:Object,j=$.Recorder;K(j)})(function(K){function G(){var $=function(f){return Math.log(f)/Math.log(10)},j=function(f){throw new Error("abort("+f+")")};function s0(f){return new Int8Array(f)}function V0(f){return new Int16Array(f)}function T(f){return new Int32Array(f)}function X(f){return new Float32Array(f)}function M0(f){return new Float64Array(f)}function o0(f){if(f.length==1)return X(f[0]);var L=f[0];f=f.slice(1);for(var H=[],m=0;m<L;m++)H.push(o0(f));return H}function C0(f){if(f.length==1)return T(f[0]);var L=f[0];f=f.slice(1);for(var H=[],m=0;m<L;m++)H.push(C0(f));return H}function U0(f){if(f.length==1)return V0(f[0]);var L=f[0];f=f.slice(1);for(var H=[],m=0;m<L;m++)H.push(U0(f));return H}function d0(f){if(f.length==1)return new Array(f[0]);var L=f[0];f=f.slice(1);for(var H=[],m=0;m<L;m++)H.push(d0(f));return H}var T0={};T0.fill=function(f,L,H,m){if(arguments.length==2)for(var Q=0;Q<f.length;Q++)f[Q]=arguments[1];else for(var Q=L;Q<H;Q++)f[Q]=m};var P={};P.arraycopy=function(f,L,H,m,Q){for(var A=L+Q;L<A;)H[m++]=f[L++]};var W={};W.SQRT2=1.4142135623730951,W.FAST_LOG10=function(f){return $(f)},W.FAST_LOG10_X=function(f,L){return $(f)*L};function c0(f){this.ordinal=f}c0.short_block_allowed=new c0(0),c0.short_block_coupled=new c0(1),c0.short_block_dispensed=new c0(2),c0.short_block_forced=new c0(3);var L0={};L0.MAX_VALUE=34028235e31;function U(f){this.ordinal=f}U.vbr_off=new U(0),U.vbr_mt=new U(1),U.vbr_rh=new U(2),U.vbr_abr=new U(3),U.vbr_mtrh=new U(4),U.vbr_default=U.vbr_mtrh;function I0(f){var L=f;this.ordinal=function(){return L}}I0.STEREO=new I0(0),I0.JOINT_STEREO=new I0(1),I0.DUAL_CHANNEL=new I0(2),I0.MONO=new I0(3),I0.NOT_SET=new I0(4);function n0(){var f=3,L=98,H=4;this.getLameShortVersion=function(){return f+"."+L+"."+H}}function S0(){var f=null;this.qupvt=null,this.setModules=function(_){this.qupvt=_,f=_};function L(_){this.bits=0|_}var H=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[1,1],[1,1],[1,2],[2,2],[2,3],[2,3],[3,4],[3,4],[3,4],[4,5],[4,5],[4,6],[5,6],[5,6],[5,7],[6,7],[6,7]];function m(_,i,u,p,k,t){var n=.5946/i;for(_=_>>1;_--!=0;)k[t++]=n>u[p++]?0:1,k[t++]=n>u[p++]?0:1}function Q(_,i,u,p,k,t){_=_>>1;var n=_%2;for(_=_>>1;_--!=0;){var Y,E,V,J,t0,l0,k0,P0;Y=u[p++]*i,E=u[p++]*i,t0=0|Y,V=u[p++]*i,l0=0|E,J=u[p++]*i,k0=0|V,Y+=f.adj43[t0],P0=0|J,E+=f.adj43[l0],k[t++]=0|Y,V+=f.adj43[k0],k[t++]=0|E,J+=f.adj43[P0],k[t++]=0|V,k[t++]=0|J}if(n!=0){var Y,E,t0,l0;Y=u[p++]*i,E=u[p++]*i,t0=0|Y,l0=0|E,Y+=f.adj43[t0],E+=f.adj43[l0],k[t++]=0|Y,k[t++]=0|E}}function A(_,i,u,p,k){var t,n,Y=0,E,V=0,J=0,t0=0,l0=i,k0=0,P0=l0,F0=0,_e=_,ue=0;for(E=k!=null&&p.global_gain==k.global_gain,p.block_type==r.SHORT_TYPE?n=38:n=21,t=0;t<=n;t++){var ne=-1;if((E||p.block_type==r.NORM_TYPE)&&(ne=p.global_gain-(p.scalefac[t]+(p.preflag!=0?f.pretab[t]:0)<<p.scalefac_scale+1)-p.subblock_gain[p.window[t]]*8),E&&k.step[t]==ne)V!=0&&(Q(V,u,_e,ue,P0,F0),V=0),J!=0&&j();else{var le=p.width[t];if(Y+p.width[t]>p.max_nonzero_coeff){var he;he=p.max_nonzero_coeff-Y+1,T0.fill(i,p.max_nonzero_coeff,576,0),le=he,le<0&&(le=0),t=n+1}if(V==0&&J==0&&(P0=l0,F0=k0,_e=_,ue=t0),k!=null&&k.sfb_count1>0&&t>=k.sfb_count1&&k.step[t]>0&&ne>=k.step[t]?(V!=0&&(Q(V,u,_e,ue,P0,F0),V=0,P0=l0,F0=k0,_e=_,ue=t0),J+=le):(J!=0&&(m(J,u,_e,ue,P0,F0),J=0,P0=l0,F0=k0,_e=_,ue=t0),V+=le),le<=0){J!=0&&j(),V!=0&&j();break}}t<=n&&(k0+=p.width[t],t0+=p.width[t],Y+=p.width[t])}V!=0&&(Q(V,u,_e,ue,P0,F0),V=0),J!=0&&j()}function R(_,i,u){var p=0,k=0;do{var t=_[i++],n=_[i++];p<t&&(p=t),k<n&&(k=n)}while(i<u);return p<k&&(p=k),p}function e0(_,i,u,p,k,t){var n=D.ht[p].xlen*65536+D.ht[k].xlen,Y=0,E;do{var V=_[i++],J=_[i++];V!=0&&(V>14&&(V=15,Y+=n),V*=16),J!=0&&(J>14&&(J=15,Y+=n),V+=J),Y+=D.largetbl[V]}while(i<u);return E=Y&65535,Y>>=16,Y>E&&(Y=E,p=k),t.bits+=Y,p}function C(_,i,u,p){var k=0,t=D.ht[1].hlen;do{var n=_[i+0]*2+_[i+1];i+=2,k+=t[n]}while(i<u);return p.bits+=k,1}function N(_,i,u,p,k){var t=0,n,Y=D.ht[p].xlen,E;p==2?E=D.table23:E=D.table56;do{var V=_[i+0]*Y+_[i+1];i+=2,t+=E[V]}while(i<u);return n=t&65535,t>>=16,t>n&&(t=n,p++),k.bits+=t,p}function s(_,i,u,p,k){var t=0,n=0,Y=0,E=D.ht[p].xlen,V=D.ht[p].hlen,J=D.ht[p+1].hlen,t0=D.ht[p+2].hlen;do{var l0=_[i+0]*E+_[i+1];i+=2,t+=V[l0],n+=J[l0],Y+=t0[l0]}while(i<u);var k0=p;return t>n&&(t=n,k0++),t>Y&&(t=Y,k0=p+2),k.bits+=t,k0}var y=[1,2,5,7,7,10,10,13,13,13,13,13,13,13,13];function a(_,i,u,p){var k=R(_,i,u);switch(k){case 0:return k;case 1:return C(_,i,u,p);case 2:case 3:return N(_,i,u,y[k-1],p);case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:return s(_,i,u,y[k-1],p);default:k>ee.IXMAX_VAL&&j(),k-=15;var t;for(t=24;t<32&&!(D.ht[t].linmax>=k);t++);var n;for(n=t-8;n<24&&!(D.ht[n].linmax>=k);n++);return e0(_,i,u,n,t,p)}}this.noquant_count_bits=function(_,i,u){var p=i.l3_enc,k=Math.min(576,i.max_nonzero_coeff+2>>1<<1);for(u!=null&&(u.sfb_count1=0);k>1&&(p[k-1]|p[k-2])==0;k-=2);i.count1=k;for(var t=0,n=0;k>3;k-=4){var Y;if(((p[k-1]|p[k-2]|p[k-3]|p[k-4])&2147483647)>1)break;Y=((p[k-4]*2+p[k-3])*2+p[k-2])*2+p[k-1],t+=D.t32l[Y],n+=D.t33l[Y]}var E=t;if(i.count1table_select=0,t>n&&(E=n,i.count1table_select=1),i.count1bits=E,i.big_values=k,k==0)return E;if(i.block_type==r.SHORT_TYPE)t=3*_.scalefac_band.s[3],t>i.big_values&&(t=i.big_values),n=i.big_values;else if(i.block_type==r.NORM_TYPE){if(t=i.region0_count=_.bv_scf[k-2],n=i.region1_count=_.bv_scf[k-1],n=_.scalefac_band.l[t+n+2],t=_.scalefac_band.l[t+1],n<k){var V=new L(E);i.table_select[2]=a(p,n,k,V),E=V.bits}}else i.region0_count=7,i.region1_count=r.SBMAX_l-1-7-1,t=_.scalefac_band.l[8],n=k,t>n&&(t=n);if(t=Math.min(t,k),n=Math.min(n,k),0<t){var V=new L(E);i.table_select[0]=a(p,0,t,V),E=V.bits}if(t<n){var V=new L(E);i.table_select[1]=a(p,t,n,V),E=V.bits}if(_.use_best_huffman==2&&j(),u!=null&&i.block_type==r.NORM_TYPE){for(var J=0;_.scalefac_band.l[J]<i.big_values;)J++;u.sfb_count1=J}return E},this.count_bits=function(_,i,u,p){var k=u.l3_enc,t=ee.IXMAX_VAL/f.IPOW20(u.global_gain);return u.xrpow_max>t?ee.LARGE_BITS:(A(i,k,f.IPOW20(u.global_gain),u,p),(_.substep_shaping&2)!=0&&j(),this.noquant_count_bits(_,u,p))};function w(_,i,u,p,k,t,n){for(var Y=i.big_values,E=0;E<=22;E++)p[E]=ee.LARGE_BITS;for(var E=0;E<16;E++){var V=_.scalefac_band.l[E+1];if(V>=Y)break;var J=0,t0=new L(J),l0=a(u,0,V,t0);J=t0.bits;for(var k0=0;k0<8;k0++){var P0=_.scalefac_band.l[E+k0+2];if(P0>=Y)break;var F0=J;t0=new L(F0);var _e=a(u,V,P0,t0);F0=t0.bits,p[E+k0]>F0&&(p[E+k0]=F0,k[E+k0]=E,t[E+k0]=l0,n[E+k0]=_e)}}}function S(_,i,u,p,k,t,n,Y){for(var E=i.big_values,V=2;V<r.SBMAX_l+1;V++){var J=_.scalefac_band.l[V];if(J>=E)break;var t0=k[V-2]+i.count1bits;if(u.part2_3_length<=t0)break;var l0=new L(t0),k0=a(p,J,E,l0);t0=l0.bits,!(u.part2_3_length<=t0)&&(u.assign(i),u.part2_3_length=t0,u.region0_count=t[V-2],u.region1_count=V-2-t[V-2],u.table_select[0]=n[V-2],u.table_select[1]=Y[V-2],u.table_select[2]=k0)}}this.best_huffman_divide=function(_,i){var u=new ce,p=i.l3_enc,k=T(23),t=T(23),n=T(23),Y=T(23);if(!(i.block_type==r.SHORT_TYPE&&_.mode_gr==1)){u.assign(i),i.block_type==r.NORM_TYPE&&(w(_,i,p,k,t,n,Y),S(_,u,i,p,k,t,n,Y));var E=u.big_values;if(!(E==0||(p[E-2]|p[E-1])>1)&&(E=i.count1+2,!(E>576))){u.assign(i),u.count1=E;for(var V=0,J=0;E>u.big_values;E-=4){var t0=((p[E-4]*2+p[E-3])*2+p[E-2])*2+p[E-1];V+=D.t32l[t0],J+=D.t33l[t0]}if(u.big_values=E,u.count1table_select=0,V>J&&(V=J,u.count1table_select=1),u.count1bits=V,u.block_type==r.NORM_TYPE)S(_,u,i,p,k,t,n,Y);else{if(u.part2_3_length=V,V=_.scalefac_band.l[8],V>E&&(V=E),V>0){var l0=new L(u.part2_3_length);u.table_select[0]=a(p,0,V,l0),u.part2_3_length=l0.bits}if(E>V){var l0=new L(u.part2_3_length);u.table_select[1]=a(p,V,E,l0),u.part2_3_length=l0.bits}i.part2_3_length>u.part2_3_length&&i.assign(u)}}}};var l=[1,1,1,1,8,2,2,2,4,4,4,8,8,8,16,16],v=[1,2,4,8,1,2,4,8,2,4,8,2,4,8,4,8],b=[0,0,0,0,3,1,1,1,2,2,2,3,3,3,4,4],d=[0,1,2,3,0,1,2,3,1,2,3,1,2,3,2,3];S0.slen1_tab=b,S0.slen2_tab=d;function o(_,i){for(var u,p=i.tt[1][_],k=i.tt[0][_],t=0;t<D.scfsi_band.length-1;t++){for(u=D.scfsi_band[t];u<D.scfsi_band[t+1]&&!(k.scalefac[u]!=p.scalefac[u]&&p.scalefac[u]>=0);u++);if(u==D.scfsi_band[t+1]){for(u=D.scfsi_band[t];u<D.scfsi_band[t+1];u++)p.scalefac[u]=-1;i.scfsi[_][t]=1}}var n=0,Y=0;for(u=0;u<11;u++)p.scalefac[u]!=-1&&(Y++,n<p.scalefac[u]&&(n=p.scalefac[u]));for(var E=0,V=0;u<r.SBPSY_l;u++)p.scalefac[u]!=-1&&(V++,E<p.scalefac[u]&&(E=p.scalefac[u]));for(var t=0;t<16;t++)if(n<l[t]&&E<v[t]){var J=b[t]*Y+d[t]*V;p.part2_length>J&&(p.part2_length=J,p.scalefac_compress=t)}}this.best_scalefac_store=function(_,i,u,p){var k=p.tt[i][u],t,n,Y,E,V=0;for(Y=0,t=0;t<k.sfbmax;t++){var J=k.width[t];for(Y+=J,E=-J;E<0&&k.l3_enc[E+Y]==0;E++);E==0&&(k.scalefac[t]=V=-2)}if(k.scalefac_scale==0&&k.preflag==0){var t0=0;for(t=0;t<k.sfbmax;t++)k.scalefac[t]>0&&(t0|=k.scalefac[t]);if((t0&1)==0&&t0!=0){for(t=0;t<k.sfbmax;t++)k.scalefac[t]>0&&(k.scalefac[t]>>=1);k.scalefac_scale=V=1}}if(k.preflag==0&&k.block_type!=r.SHORT_TYPE&&_.mode_gr==2){for(t=11;t<r.SBPSY_l&&!(k.scalefac[t]<f.pretab[t]&&k.scalefac[t]!=-2);t++);if(t==r.SBPSY_l){for(t=11;t<r.SBPSY_l;t++)k.scalefac[t]>0&&(k.scalefac[t]-=f.pretab[t]);k.preflag=V=1}}for(n=0;n<4;n++)p.scfsi[u][n]=0;for(_.mode_gr==2&&i==1&&p.tt[0][u].block_type!=r.SHORT_TYPE&&p.tt[1][u].block_type!=r.SHORT_TYPE&&(o(u,p),V=0),t=0;t<k.sfbmax;t++)k.scalefac[t]==-2&&(k.scalefac[t]=0);V!=0&&(_.mode_gr==2?this.scale_bitcount(k):this.scale_bitcount_lsf(_,k))};var c=[0,18,36,54,54,36,54,72,54,72,90,72,90,108,108,126],e=[0,18,36,54,51,35,53,71,52,70,88,69,87,105,104,122],M=[0,10,20,30,33,21,31,41,32,42,52,43,53,63,64,74];this.scale_bitcount=function(_){var i,u,p=0,k=0,t,n=_.scalefac;if(_.block_type==r.SHORT_TYPE)t=c,_.mixed_block_flag!=0&&(t=e);else if(t=M,_.preflag==0){for(u=11;u<r.SBPSY_l&&!(n[u]<f.pretab[u]);u++);if(u==r.SBPSY_l)for(_.preflag=1,u=11;u<r.SBPSY_l;u++)n[u]-=f.pretab[u]}for(u=0;u<_.sfbdivide;u++)p<n[u]&&(p=n[u]);for(;u<_.sfbmax;u++)k<n[u]&&(k=n[u]);for(_.part2_length=ee.LARGE_BITS,i=0;i<16;i++)p<l[i]&&k<v[i]&&_.part2_length>t[i]&&(_.part2_length=t[i],_.scalefac_compress=i);return _.part2_length==ee.LARGE_BITS};var h=[[15,15,7,7],[15,15,7,0],[7,3,0,0],[15,31,31,0],[7,7,7,0],[3,3,0,0]];this.scale_bitcount_lsf=function(_,i){var u,p,k,t,n,Y,E,V,J=T(4),t0=i.scalefac;for(i.preflag!=0?u=2:u=0,E=0;E<4;E++)J[E]=0;if(i.block_type==r.SHORT_TYPE){p=1;var l0=f.nr_of_sfb_block[u][p];for(V=0,k=0;k<4;k++)for(t=l0[k]/3,E=0;E<t;E++,V++)for(n=0;n<3;n++)t0[V*3+n]>J[k]&&(J[k]=t0[V*3+n])}else{p=0;var l0=f.nr_of_sfb_block[u][p];for(V=0,k=0;k<4;k++)for(t=l0[k],E=0;E<t;E++,V++)t0[V]>J[k]&&(J[k]=t0[V])}for(Y=!1,k=0;k<4;k++)J[k]>h[u][k]&&(Y=!0);if(!Y){var k0,P0,F0,_e;for(i.sfb_partition_table=f.nr_of_sfb_block[u][p],k=0;k<4;k++)i.slen[k]=g[J[k]];switch(k0=i.slen[0],P0=i.slen[1],F0=i.slen[2],_e=i.slen[3],u){case 0:i.scalefac_compress=(k0*5+P0<<4)+(F0<<2)+_e;break;case 1:i.scalefac_compress=400+(k0*5+P0<<2)+F0;break;case 2:i.scalefac_compress=500+k0*3+P0;break}}if(!Y)for(i.part2_length=0,k=0;k<4;k++)i.part2_length+=i.slen[k]*i.sfb_partition_table[k];return Y};var g=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];this.huffman_init=function(_){for(var i=2;i<=576;i+=2){for(var u=0,p;_.scalefac_band.l[++u]<i;);for(p=H[u][0];_.scalefac_band.l[p+1]>i;)p--;for(p<0&&(p=H[u][0]),_.bv_scf[i-2]=p,p=H[u][1];_.scalefac_band.l[p+_.bv_scf[i-2]+2]>i;)p--;p<0&&(p=H[u][1]),_.bv_scf[i-1]=p}}}r0.STEPS_per_dB=100,r0.MAX_dB=120,r0.GAIN_NOT_ENOUGH_SAMPLES=-24601,r0.GAIN_ANALYSIS_ERROR=0,r0.GAIN_ANALYSIS_OK=1,r0.INIT_GAIN_ANALYSIS_ERROR=0,r0.INIT_GAIN_ANALYSIS_OK=1,r0.YULE_ORDER=10,r0.MAX_ORDER=r0.YULE_ORDER,r0.MAX_SAMP_FREQ=48e3,r0.RMS_WINDOW_TIME_NUMERATOR=1,r0.RMS_WINDOW_TIME_DENOMINATOR=20,r0.MAX_SAMPLES_PER_WINDOW=r0.MAX_SAMP_FREQ*r0.RMS_WINDOW_TIME_NUMERATOR/r0.RMS_WINDOW_TIME_DENOMINATOR+1;function r0(){}function y0(){function f(A,R,e0,C,N,s,y,a,w,S,l,v,b,d){this.quant_comp=R,this.quant_comp_s=e0,this.safejoint=C,this.nsmsfix=N,this.st_lrm=s,this.st_s=y,this.nsbass=a,this.scale=w,this.masking_adj=S,this.ath_lower=l,this.ath_curve=v,this.interch=b,this.sfscale=d}var L;this.setModules=function(A){L=A};function H(A,R,e0){j()}var m=[new f(8,9,9,0,0,6.6,145,0,.95,0,-30,11,.0012,1),new f(16,9,9,0,0,6.6,145,0,.95,0,-25,11,.001,1),new f(24,9,9,0,0,6.6,145,0,.95,0,-20,11,.001,1),new f(32,9,9,0,0,6.6,145,0,.95,0,-15,11,.001,1),new f(40,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new f(48,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new f(56,9,9,0,0,6.6,145,0,.95,0,-6,11,8e-4,1),new f(64,9,9,0,0,6.6,145,0,.95,0,-2,11,8e-4,1),new f(80,9,9,0,0,6.6,145,0,.95,0,0,8,7e-4,1),new f(96,9,9,0,2.5,6.6,145,0,.95,0,1,5.5,6e-4,1),new f(112,9,9,0,2.25,6.6,145,0,.95,0,2,4.5,5e-4,1),new f(128,9,9,0,1.95,6.4,140,0,.95,0,3,4,2e-4,1),new f(160,9,9,1,1.79,6,135,0,.95,-2,5,3.5,0,1),new f(192,9,9,1,1.49,5.6,125,0,.97,-4,7,3,0,0),new f(224,9,9,1,1.25,5.2,125,0,.98,-6,9,2,0,0),new f(256,9,9,1,.97,5.2,125,0,1,-8,10,1,0,0),new f(320,9,9,1,.9,5.2,125,0,1,-10,12,0,0,0)];function Q(A,R,e0){var C=R,N=L.nearestBitrateFullIndex(R);if(A.VBR=U.vbr_abr,A.VBR_mean_bitrate_kbps=C,A.VBR_mean_bitrate_kbps=Math.min(A.VBR_mean_bitrate_kbps,320),A.VBR_mean_bitrate_kbps=Math.max(A.VBR_mean_bitrate_kbps,8),A.brate=A.VBR_mean_bitrate_kbps,A.VBR_mean_bitrate_kbps>320&&(A.disable_reservoir=!0),m[N].safejoint>0&&(A.exp_nspsytune=A.exp_nspsytune|2),m[N].sfscale>0&&(A.internal_flags.noise_shaping=2),Math.abs(m[N].nsbass)>0){var s=int(m[N].nsbass*4);s<0&&(s+=64),A.exp_nspsytune=A.exp_nspsytune|s<<2}return e0!=0?A.quant_comp=m[N].quant_comp:Math.abs(A.quant_comp- -1)>0||(A.quant_comp=m[N].quant_comp),e0!=0?A.quant_comp_short=m[N].quant_comp_s:Math.abs(A.quant_comp_short- -1)>0||(A.quant_comp_short=m[N].quant_comp_s),e0!=0?A.msfix=m[N].nsmsfix:Math.abs(A.msfix- -1)>0||(A.msfix=m[N].nsmsfix),e0!=0?A.internal_flags.nsPsy.attackthre=m[N].st_lrm:Math.abs(A.internal_flags.nsPsy.attackthre- -1)>0||(A.internal_flags.nsPsy.attackthre=m[N].st_lrm),e0!=0?A.internal_flags.nsPsy.attackthre_s=m[N].st_s:Math.abs(A.internal_flags.nsPsy.attackthre_s- -1)>0||(A.internal_flags.nsPsy.attackthre_s=m[N].st_s),e0!=0?A.scale=m[N].scale:Math.abs(A.scale- -1)>0||(A.scale=m[N].scale),e0!=0?A.maskingadjust=m[N].masking_adj:Math.abs(A.maskingadjust-0)>0||(A.maskingadjust=m[N].masking_adj),m[N].masking_adj>0?e0!=0?A.maskingadjust_short=m[N].masking_adj*.9:Math.abs(A.maskingadjust_short-0)>0||(A.maskingadjust_short=m[N].masking_adj*.9):e0!=0?A.maskingadjust_short=m[N].masking_adj*1.1:Math.abs(A.maskingadjust_short-0)>0||(A.maskingadjust_short=m[N].masking_adj*1.1),e0!=0?A.ATHlower=-m[N].ath_lower/10:Math.abs(-A.ATHlower*10-0)>0||(A.ATHlower=-m[N].ath_lower/10),e0!=0?A.ATHcurve=m[N].ath_curve:Math.abs(A.ATHcurve- -1)>0||(A.ATHcurve=m[N].ath_curve),e0!=0?A.interChRatio=m[N].interch:Math.abs(A.interChRatio- -1)>0||(A.interChRatio=m[N].interch),R}this.apply_preset=function(A,R,e0){switch(R){case m0.R3MIX:{R=m0.V3,A.VBR=U.vbr_mtrh;break}case m0.MEDIUM:{R=m0.V4,A.VBR=U.vbr_rh;break}case m0.MEDIUM_FAST:{R=m0.V4,A.VBR=U.vbr_mtrh;break}case m0.STANDARD:{R=m0.V2,A.VBR=U.vbr_rh;break}case m0.STANDARD_FAST:{R=m0.V2,A.VBR=U.vbr_mtrh;break}case m0.EXTREME:{R=m0.V0,A.VBR=U.vbr_rh;break}case m0.EXTREME_FAST:{R=m0.V0,A.VBR=U.vbr_mtrh;break}case m0.INSANE:return R=320,A.preset=R,Q(A,R,e0),A.VBR=U.vbr_off,R}switch(A.preset=R,R){case m0.V9:return H(),R;case m0.V8:return H(),R;case m0.V7:return H(),R;case m0.V6:return H(),R;case m0.V5:return H(),R;case m0.V4:return H(),R;case m0.V3:return H(),R;case m0.V2:return H(),R;case m0.V1:return H(),R;case m0.V0:return H(),R}return 8<=R&&R<=320?Q(A,R,e0):(A.preset=0,R)}}function g0(){var f;this.setModules=function(L){f=L},this.ResvFrameBegin=function(L,H){var m=L.internal_flags,Q,A=m.l3_side,R=f.getframebits(L);H.bits=(R-m.sideinfo_len*8)/m.mode_gr;var e0=8*256*m.mode_gr-8;L.brate>320?j():(Q=8*1440,L.strict_ISO&&j()),m.ResvMax=Q-R,m.ResvMax>e0&&(m.ResvMax=e0),(m.ResvMax<0||L.disable_reservoir)&&(m.ResvMax=0);var C=H.bits*m.mode_gr+Math.min(m.ResvSize,m.ResvMax);return C>Q&&(C=Q),A.resvDrain_pre=0,m.pinfo!=null&&j(),C},this.ResvMaxBits=function(L,H,m,Q){var A=L.internal_flags,R,e0=A.ResvSize,C=A.ResvMax;Q!=0&&(e0+=H),(A.substep_shaping&1)!=0&&(C*=.9),m.bits=H,e0*10>C*9?(R=e0-C*9/10,m.bits+=R,A.substep_shaping|=128):(R=0,A.substep_shaping&=127,!L.disable_reservoir&&(A.substep_shaping&1)==0&&(m.bits-=.1*H));var N=e0<A.ResvMax*6/10?e0:A.ResvMax*6/10;return N-=R,N<0&&(N=0),N},this.ResvAdjust=function(L,H){L.ResvSize-=H.part2_3_length+H.part2_length},this.ResvFrameEnd=function(L,H){var m,Q=L.l3_side;L.ResvSize+=H*L.mode_gr;var A=0;Q.resvDrain_post=0,Q.resvDrain_pre=0,(m=L.ResvSize%8)!=0&&(A+=m),m=L.ResvSize-A-L.ResvMax,m>0&&(A+=m);{var R=Math.min(Q.main_data_begin*8,A)/8;Q.resvDrain_pre+=8*R,A-=8*R,L.ResvSize-=8*R,Q.main_data_begin-=R}Q.resvDrain_post+=A,L.ResvSize-=A}}H0.NUMTOCENTRIES=100,H0.MAXFRAMESIZE=2880;function H0(){this.setModules=function(H,m,Q){};var f=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];function L(H,m){var Q=m^H;return m=m>>8^f[Q&255],m}this.updateMusicCRC=function(H,m,Q,A){for(var R=0;R<A;++R)H[0]=L(m[Q+R],H[0])}}x0.EQ=function(f,L){return Math.abs(f)>Math.abs(L)?Math.abs(f-L)<=Math.abs(f)*1e-6:Math.abs(f-L)<=Math.abs(L)*1e-6},x0.NEQ=function(f,L){return!x0.EQ(f,L)};function x0(){var f=this,L=null,H=null;this.setModules=function(o,c,e,M){L=e,H=M};var m=null,Q=0,A=0,R=0;this.getframebits=function(o){var c=o.internal_flags,e;c.bitrate_index!=0?e=D.bitrate_table[o.version][c.bitrate_index]:e=o.brate;var M=0|(o.version+1)*72e3*e/o.out_samplerate+c.padding;return 8*M};function e0(o){P.arraycopy(o.header[o.w_ptr].buf,0,m,A,o.sideinfo_len),A+=o.sideinfo_len,Q+=o.sideinfo_len*8,o.w_ptr=o.w_ptr+1&A0.MAX_HEADER_BUF-1}function C(o,c,e){for(;e>0;){var M;R==0&&(R=8,A++,o.header[o.w_ptr].write_timing==Q&&e0(o),m[A]=0),M=Math.min(e,R),e-=M,R-=M,m[A]|=c>>e<<R,Q+=M}}function N(o,c){var e=o.internal_flags,M;if(c>=8&&(C(e,76,8),c-=8),c>=8&&(C(e,65,8),c-=8),c>=8&&(C(e,77,8),c-=8),c>=8&&(C(e,69,8),c-=8),c>=32){var h=L.getLameShortVersion();if(c>=32)for(M=0;M<h.length&&c>=8;++M)c-=8,C(e,h.charCodeAt(M),8)}for(;c>=1;c-=1)C(e,e.ancillary_flag,1),e.ancillary_flag^=o.disable_reservoir?0:1}function s(o,c,e){for(var M=o.header[o.h_ptr].ptr;e>0;){var h=Math.min(e,8-(M&7));e-=h,o.header[o.h_ptr].buf[M>>3]|=c>>e<<8-(M&7)-h,M+=h}o.header[o.h_ptr].ptr=M}function y(o,c){var e=o.internal_flags,M,h,g;if(M=e.l3_side,e.header[e.h_ptr].ptr=0,T0.fill(e.header[e.h_ptr].buf,0,e.sideinfo_len,0),o.out_samplerate<16e3?s(e,4094,12):s(e,4095,12),s(e,o.version,1),s(e,1,2),s(e,o.error_protection?0:1,1),s(e,e.bitrate_index,4),s(e,e.samplerate_index,2),s(e,e.padding,1),s(e,o.extension,1),s(e,o.mode.ordinal(),2),s(e,e.mode_ext,2),s(e,o.copyright,1),s(e,o.original,1),s(e,o.emphasis,2),o.error_protection&&s(e,0,16),o.version==1){for(s(e,M.main_data_begin,9),e.channels_out==2?s(e,M.private_bits,3):s(e,M.private_bits,5),g=0;g<e.channels_out;g++){var _;for(_=0;_<4;_++)s(e,M.scfsi[g][_],1)}for(h=0;h<2;h++)for(g=0;g<e.channels_out;g++){var i=M.tt[h][g];s(e,i.part2_3_length+i.part2_length,12),s(e,i.big_values/2,9),s(e,i.global_gain,8),s(e,i.scalefac_compress,4),i.block_type!=r.NORM_TYPE?(s(e,1,1),s(e,i.block_type,2),s(e,i.mixed_block_flag,1),i.table_select[0]==14&&(i.table_select[0]=16),s(e,i.table_select[0],5),i.table_select[1]==14&&(i.table_select[1]=16),s(e,i.table_select[1],5),s(e,i.subblock_gain[0],3),s(e,i.subblock_gain[1],3),s(e,i.subblock_gain[2],3)):(s(e,0,1),i.table_select[0]==14&&(i.table_select[0]=16),s(e,i.table_select[0],5),i.table_select[1]==14&&(i.table_select[1]=16),s(e,i.table_select[1],5),i.table_select[2]==14&&(i.table_select[2]=16),s(e,i.table_select[2],5),s(e,i.region0_count,4),s(e,i.region1_count,3)),s(e,i.preflag,1),s(e,i.scalefac_scale,1),s(e,i.count1table_select,1)}}else for(s(e,M.main_data_begin,8),s(e,M.private_bits,e.channels_out),h=0,g=0;g<e.channels_out;g++){var i=M.tt[h][g];s(e,i.part2_3_length+i.part2_length,12),s(e,i.big_values/2,9),s(e,i.global_gain,8),s(e,i.scalefac_compress,9),i.block_type!=r.NORM_TYPE?(s(e,1,1),s(e,i.block_type,2),s(e,i.mixed_block_flag,1),i.table_select[0]==14&&(i.table_select[0]=16),s(e,i.table_select[0],5),i.table_select[1]==14&&(i.table_select[1]=16),s(e,i.table_select[1],5),s(e,i.subblock_gain[0],3),s(e,i.subblock_gain[1],3),s(e,i.subblock_gain[2],3)):(s(e,0,1),i.table_select[0]==14&&(i.table_select[0]=16),s(e,i.table_select[0],5),i.table_select[1]==14&&(i.table_select[1]=16),s(e,i.table_select[1],5),i.table_select[2]==14&&(i.table_select[2]=16),s(e,i.table_select[2],5),s(e,i.region0_count,4),s(e,i.region1_count,3)),s(e,i.scalefac_scale,1),s(e,i.count1table_select,1)}o.error_protection&&j();{var u=e.h_ptr;e.h_ptr=u+1&A0.MAX_HEADER_BUF-1,e.header[e.h_ptr].write_timing=e.header[u].write_timing+c,e.h_ptr==e.w_ptr}}function a(o,c){var e=D.ht[c.count1table_select+32],M,h=0,g=c.big_values,_=c.big_values;for(M=(c.count1-c.big_values)/4;M>0;--M){var i=0,u=0,p;p=c.l3_enc[g+0],p!=0&&(u+=8,c.xr[_+0]<0&&i++),p=c.l3_enc[g+1],p!=0&&(u+=4,i*=2,c.xr[_+1]<0&&i++),p=c.l3_enc[g+2],p!=0&&(u+=2,i*=2,c.xr[_+2]<0&&i++),p=c.l3_enc[g+3],p!=0&&(u++,i*=2,c.xr[_+3]<0&&i++),g+=4,_+=4,C(o,i+e.table[u],e.hlen[u]),h+=e.hlen[u]}return h}function w(o,c,e,M,h){var g=D.ht[c],_=0;if(c==0)return _;for(var i=e;i<M;i+=2){var u=0,p=0,k=g.xlen,t=g.xlen,n=0,Y=h.l3_enc[i],E=h.l3_enc[i+1];if(Y!=0&&(h.xr[i]<0&&n++,u--),c>15){if(Y>14){var V=Y-15;n|=V<<1,p=k,Y=15}if(E>14){var J=E-15;n<<=k,n|=J,p+=k,E=15}t=16}E!=0&&(n<<=1,h.xr[i+1]<0&&n++,u--),Y=Y*t+E,p-=u,u+=g.hlen[Y],C(o,g.table[Y],u),C(o,n,p),_+=u+p}return _}function S(o,c){var e=3*o.scalefac_band.s[3];e>c.big_values&&(e=c.big_values);var M=w(o,c.table_select[0],0,e,c);return M+=w(o,c.table_select[1],e,c.big_values,c),M}function l(o,c){var e,M,h,g;e=c.big_values;var _=c.region0_count+1;return h=o.scalefac_band.l[_],_+=c.region1_count+1,g=o.scalefac_band.l[_],h>e&&(h=e),g>e&&(g=e),M=w(o,c.table_select[0],0,h,c),M+=w(o,c.table_select[1],h,g,c),M+=w(o,c.table_select[2],g,e,c),M}function v(o){var c,e,M,h,g=0,_=o.internal_flags,i=_.l3_side;if(o.version==1)for(c=0;c<2;c++)for(e=0;e<_.channels_out;e++){var u=i.tt[c][e],p=S0.slen1_tab[u.scalefac_compress],k=S0.slen2_tab[u.scalefac_compress];for(h=0,M=0;M<u.sfbdivide;M++)u.scalefac[M]!=-1&&(C(_,u.scalefac[M],p),h+=p);for(;M<u.sfbmax;M++)u.scalefac[M]!=-1&&(C(_,u.scalefac[M],k),h+=k);u.block_type==r.SHORT_TYPE?h+=S(_,u):h+=l(_,u),h+=a(_,u),g+=h}else for(c=0,e=0;e<_.channels_out;e++){var u=i.tt[c][e],t,n,Y=0;if(h=0,M=0,n=0,u.block_type==r.SHORT_TYPE){for(;n<4;n++){var E=u.sfb_partition_table[n]/3,V=u.slen[n];for(t=0;t<E;t++,M++)C(_,Math.max(u.scalefac[M*3+0],0),V),C(_,Math.max(u.scalefac[M*3+1],0),V),C(_,Math.max(u.scalefac[M*3+2],0),V),Y+=3*V}h+=S(_,u)}else{for(;n<4;n++){var E=u.sfb_partition_table[n],V=u.slen[n];for(t=0;t<E;t++,M++)C(_,Math.max(u.scalefac[M],0),V),Y+=V}h+=l(_,u)}h+=a(_,u),g+=Y+h}return g}function b(){this.total=0}function d(o,c){var e=o.internal_flags,M,h,g;return e.w_ptr,g=e.h_ptr-1,g==-1&&(g=A0.MAX_HEADER_BUF-1),M=e.header[g].write_timing-Q,c.total=M,M>=0&&j(),h=f.getframebits(o),M+=h,c.total+=h,c.total%8!=0?c.total=1+c.total/8:c.total=c.total/8,c.total+=A+1,M}this.flush_bitstream=function(o){var c=o.internal_flags,e,M;c.h_ptr-1,e=c.l3_side,!((M=d(o,new b))<0)&&(N(o,M),c.ResvSize=0,e.main_data_begin=0,c.findReplayGain&&j(),c.findPeakSample&&j())},this.format_bitstream=function(o){var c=o.internal_flags,e;e=c.l3_side;var M=this.getframebits(o);N(o,e.resvDrain_pre),y(o,M);var h=8*c.sideinfo_len;if(h+=v(o),N(o,e.resvDrain_post),h+=e.resvDrain_post,e.main_data_begin+=(M-h)/8,d(o,new b)!=c.ResvSize,e.main_data_begin*8!=c.ResvSize&&(c.ResvSize=e.main_data_begin*8),Q>1e9){var g;for(g=0;g<A0.MAX_HEADER_BUF;++g)c.header[g].write_timing-=Q;Q=0}return 0},this.copy_buffer=function(o,c,e,M,h){var g=A+1;if(g<=0)return 0;if(M!=0&&g>M)return-1;if(P.arraycopy(m,0,c,e,g),A=-1,R=0,h!=0){var _=T(1);_[0]=o.nMusicCRC,H.updateMusicCRC(_,c,e,g),o.nMusicCRC=_[0],g>0&&(o.VBR_seek_table.nBytesWritten+=g),o.decode_on_the_fly&&j()}return g},this.init_bit_stream_w=function(o){m=s0(m0.LAME_MAXMP3BUFFER),o.h_ptr=o.w_ptr=0,o.header[o.h_ptr].write_timing=0,A=-1,R=0,Q=0}}function _0(f,L,H,m){this.xlen=f,this.linmax=L,this.table=H,this.hlen=m}var D={};D.t1HB=[1,1,1,0],D.t2HB=[1,2,1,3,1,1,3,2,0],D.t3HB=[3,2,1,1,1,1,3,2,0],D.t5HB=[1,2,6,5,3,1,4,4,7,5,7,1,6,1,1,0],D.t6HB=[7,3,5,1,6,2,3,2,5,4,4,1,3,3,2,0],D.t7HB=[1,2,10,19,16,10,3,3,7,10,5,3,11,4,13,17,8,4,12,11,18,15,11,2,7,6,9,14,3,1,6,4,5,3,2,0],D.t8HB=[3,4,6,18,12,5,5,1,2,16,9,3,7,3,5,14,7,3,19,17,15,13,10,4,13,5,8,11,5,1,12,4,4,1,1,0],D.t9HB=[7,5,9,14,15,7,6,4,5,5,6,7,7,6,8,8,8,5,15,6,9,10,5,1,11,7,9,6,4,1,14,4,6,2,6,0],D.t10HB=[1,2,10,23,35,30,12,17,3,3,8,12,18,21,12,7,11,9,15,21,32,40,19,6,14,13,22,34,46,23,18,7,20,19,33,47,27,22,9,3,31,22,41,26,21,20,5,3,14,13,10,11,16,6,5,1,9,8,7,8,4,4,2,0],D.t11HB=[3,4,10,24,34,33,21,15,5,3,4,10,32,17,11,10,11,7,13,18,30,31,20,5,25,11,19,59,27,18,12,5,35,33,31,58,30,16,7,5,28,26,32,19,17,15,8,14,14,12,9,13,14,9,4,1,11,4,6,6,6,3,2,0],D.t12HB=[9,6,16,33,41,39,38,26,7,5,6,9,23,16,26,11,17,7,11,14,21,30,10,7,17,10,15,12,18,28,14,5,32,13,22,19,18,16,9,5,40,17,31,29,17,13,4,2,27,12,11,15,10,7,4,1,27,12,8,12,6,3,1,0],D.t13HB=[1,5,14,21,34,51,46,71,42,52,68,52,67,44,43,19,3,4,12,19,31,26,44,33,31,24,32,24,31,35,22,14,15,13,23,36,59,49,77,65,29,40,30,40,27,33,42,16,22,20,37,61,56,79,73,64,43,76,56,37,26,31,25,14,35,16,60,57,97,75,114,91,54,73,55,41,48,53,23,24,58,27,50,96,76,70,93,84,77,58,79,29,74,49,41,17,47,45,78,74,115,94,90,79,69,83,71,50,59,38,36,15,72,34,56,95,92,85,91,90,86,73,77,65,51,44,43,42,43,20,30,44,55,78,72,87,78,61,46,54,37,30,20,16,53,25,41,37,44,59,54,81,66,76,57,54,37,18,39,11,35,33,31,57,42,82,72,80,47,58,55,21,22,26,38,22,53,25,23,38,70,60,51,36,55,26,34,23,27,14,9,7,34,32,28,39,49,75,30,52,48,40,52,28,18,17,9,5,45,21,34,64,56,50,49,45,31,19,12,15,10,7,6,3,48,23,20,39,36,35,53,21,16,23,13,10,6,1,4,2,16,15,17,27,25,20,29,11,17,12,16,8,1,1,0,1],D.t15HB=[7,12,18,53,47,76,124,108,89,123,108,119,107,81,122,63,13,5,16,27,46,36,61,51,42,70,52,83,65,41,59,36,19,17,15,24,41,34,59,48,40,64,50,78,62,80,56,33,29,28,25,43,39,63,55,93,76,59,93,72,54,75,50,29,52,22,42,40,67,57,95,79,72,57,89,69,49,66,46,27,77,37,35,66,58,52,91,74,62,48,79,63,90,62,40,38,125,32,60,56,50,92,78,65,55,87,71,51,73,51,70,30,109,53,49,94,88,75,66,122,91,73,56,42,64,44,21,25,90,43,41,77,73,63,56,92,77,66,47,67,48,53,36,20,71,34,67,60,58,49,88,76,67,106,71,54,38,39,23,15,109,53,51,47,90,82,58,57,48,72,57,41,23,27,62,9,86,42,40,37,70,64,52,43,70,55,42,25,29,18,11,11,118,68,30,55,50,46,74,65,49,39,24,16,22,13,14,7,91,44,39,38,34,63,52,45,31,52,28,19,14,8,9,3,123,60,58,53,47,43,32,22,37,24,17,12,15,10,2,1,71,37,34,30,28,20,17,26,21,16,10,6,8,6,2,0],D.t16HB=[1,5,14,44,74,63,110,93,172,149,138,242,225,195,376,17,3,4,12,20,35,62,53,47,83,75,68,119,201,107,207,9,15,13,23,38,67,58,103,90,161,72,127,117,110,209,206,16,45,21,39,69,64,114,99,87,158,140,252,212,199,387,365,26,75,36,68,65,115,101,179,164,155,264,246,226,395,382,362,9,66,30,59,56,102,185,173,265,142,253,232,400,388,378,445,16,111,54,52,100,184,178,160,133,257,244,228,217,385,366,715,10,98,48,91,88,165,157,148,261,248,407,397,372,380,889,884,8,85,84,81,159,156,143,260,249,427,401,392,383,727,713,708,7,154,76,73,141,131,256,245,426,406,394,384,735,359,710,352,11,139,129,67,125,247,233,229,219,393,743,737,720,885,882,439,4,243,120,118,115,227,223,396,746,742,736,721,712,706,223,436,6,202,224,222,218,216,389,386,381,364,888,443,707,440,437,1728,4,747,211,210,208,370,379,734,723,714,1735,883,877,876,3459,865,2,377,369,102,187,726,722,358,711,709,866,1734,871,3458,870,434,0,12,10,7,11,10,17,11,9,13,12,10,7,5,3,1,3],D.t24HB=[15,13,46,80,146,262,248,434,426,669,653,649,621,517,1032,88,14,12,21,38,71,130,122,216,209,198,327,345,319,297,279,42,47,22,41,74,68,128,120,221,207,194,182,340,315,295,541,18,81,39,75,70,134,125,116,220,204,190,178,325,311,293,271,16,147,72,69,135,127,118,112,210,200,188,352,323,306,285,540,14,263,66,129,126,119,114,214,202,192,180,341,317,301,281,262,12,249,123,121,117,113,215,206,195,185,347,330,308,291,272,520,10,435,115,111,109,211,203,196,187,353,332,313,298,283,531,381,17,427,212,208,205,201,193,186,177,169,320,303,286,268,514,377,16,335,199,197,191,189,181,174,333,321,305,289,275,521,379,371,11,668,184,183,179,175,344,331,314,304,290,277,530,383,373,366,10,652,346,171,168,164,318,309,299,287,276,263,513,375,368,362,6,648,322,316,312,307,302,292,284,269,261,512,376,370,364,359,4,620,300,296,294,288,282,273,266,515,380,374,369,365,361,357,2,1033,280,278,274,267,264,259,382,378,372,367,363,360,358,356,0,43,20,19,17,15,13,11,9,7,6,4,7,5,3,1,3],D.t32HB=[1,10,8,20,12,20,16,32,14,12,24,0,28,16,24,16],D.t33HB=[15,28,26,48,22,40,36,64,14,24,20,32,12,16,8,0],D.t1l=[1,4,3,5],D.t2l=[1,4,7,4,5,7,6,7,8],D.t3l=[2,3,7,4,4,7,6,7,8],D.t5l=[1,4,7,8,4,5,8,9,7,8,9,10,8,8,9,10],D.t6l=[3,4,6,8,4,4,6,7,5,6,7,8,7,7,8,9],D.t7l=[1,4,7,9,9,10,4,6,8,9,9,10,7,7,9,10,10,11,8,9,10,11,11,11,8,9,10,11,11,12,9,10,11,12,12,12],D.t8l=[2,4,7,9,9,10,4,4,6,10,10,10,7,6,8,10,10,11,9,10,10,11,11,12,9,9,10,11,12,12,10,10,11,11,13,13],D.t9l=[3,4,6,7,9,10,4,5,6,7,8,10,5,6,7,8,9,10,7,7,8,9,9,10,8,8,9,9,10,11,9,9,10,10,11,11],D.t10l=[1,4,7,9,10,10,10,11,4,6,8,9,10,11,10,10,7,8,9,10,11,12,11,11,8,9,10,11,12,12,11,12,9,10,11,12,12,12,12,12,10,11,12,12,13,13,12,13,9,10,11,12,12,12,13,13,10,10,11,12,12,13,13,13],D.t11l=[2,4,6,8,9,10,9,10,4,5,6,8,10,10,9,10,6,7,8,9,10,11,10,10,8,8,9,11,10,12,10,11,9,10,10,11,11,12,11,12,9,10,11,12,12,13,12,13,9,9,9,10,11,12,12,12,9,9,10,11,12,12,12,12],D.t12l=[4,4,6,8,9,10,10,10,4,5,6,7,9,9,10,10,6,6,7,8,9,10,9,10,7,7,8,8,9,10,10,10,8,8,9,9,10,10,10,11,9,9,10,10,10,11,10,11,9,9,9,10,10,11,11,12,10,10,10,11,11,11,11,12],D.t13l=[1,5,7,8,9,10,10,11,10,11,12,12,13,13,14,14,4,6,8,9,10,10,11,11,11,11,12,12,13,14,14,14,7,8,9,10,11,11,12,12,11,12,12,13,13,14,15,15,8,9,10,11,11,12,12,12,12,13,13,13,13,14,15,15,9,9,11,11,12,12,13,13,12,13,13,14,14,15,15,16,10,10,11,12,12,12,13,13,13,13,14,13,15,15,16,16,10,11,12,12,13,13,13,13,13,14,14,14,15,15,16,16,11,11,12,13,13,13,14,14,14,14,15,15,15,16,18,18,10,10,11,12,12,13,13,14,14,14,14,15,15,16,17,17,11,11,12,12,13,13,13,15,14,15,15,16,16,16,18,17,11,12,12,13,13,14,14,15,14,15,16,15,16,17,18,19,12,12,12,13,14,14,14,14,15,15,15,16,17,17,17,18,12,13,13,14,14,15,14,15,16,16,17,17,17,18,18,18,13,13,14,15,15,15,16,16,16,16,16,17,18,17,18,18,14,14,14,15,15,15,17,16,16,19,17,17,17,19,18,18,13,14,15,16,16,16,17,16,17,17,18,18,21,20,21,18],D.t15l=[3,5,6,8,8,9,10,10,10,11,11,12,12,12,13,14,5,5,7,8,9,9,10,10,10,11,11,12,12,12,13,13,6,7,7,8,9,9,10,10,10,11,11,12,12,13,13,13,7,8,8,9,9,10,10,11,11,11,12,12,12,13,13,13,8,8,9,9,10,10,11,11,11,11,12,12,12,13,13,13,9,9,9,10,10,10,11,11,11,11,12,12,13,13,13,14,10,9,10,10,10,11,11,11,11,12,12,12,13,13,14,14,10,10,10,11,11,11,11,12,12,12,12,12,13,13,13,14,10,10,10,11,11,11,11,12,12,12,12,13,13,14,14,14,10,10,11,11,11,11,12,12,12,13,13,13,13,14,14,14,11,11,11,11,12,12,12,12,12,13,13,13,13,14,15,14,11,11,11,11,12,12,12,12,13,13,13,13,14,14,14,15,12,12,11,12,12,12,13,13,13,13,13,13,14,14,15,15,12,12,12,12,12,13,13,13,13,14,14,14,14,14,15,15,13,13,13,13,13,13,13,13,14,14,14,14,15,15,14,15,13,13,13,13,13,13,13,14,14,14,14,14,15,15,15,15],D.t16_5l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,11,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,11,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,12,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,13,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,12,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,13,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,13,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,13,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,13,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,14,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,13,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,14,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,14,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,14,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,14,11,11,11,12,12,13,13,13,14,14,14,14,14,14,14,12],D.t16l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,10,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,10,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,11,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,12,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,11,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,12,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,12,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,12,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,12,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,13,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,12,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,13,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,13,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,13,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,13,10,10,10,11,11,12,12,12,13,13,13,13,13,13,13,10],D.t24l=[4,5,7,8,9,10,10,11,11,12,12,12,12,12,13,10,5,6,7,8,9,10,10,11,11,11,12,12,12,12,12,10,7,7,8,9,9,10,10,11,11,11,11,12,12,12,13,9,8,8,9,9,10,10,10,11,11,11,11,12,12,12,12,9,9,9,9,10,10,10,10,11,11,11,12,12,12,12,13,9,10,9,10,10,10,10,11,11,11,11,12,12,12,12,12,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,13,9,11,10,10,10,11,11,11,11,12,12,12,12,12,13,13,10,11,11,11,11,11,11,11,11,11,12,12,12,12,13,13,10,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,10,12,11,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,10,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,10,13,12,12,12,12,12,12,13,13,13,13,13,13,13,13,10,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,6],D.t32l=[1,5,5,7,5,8,7,9,5,7,7,9,7,9,9,10],D.t33l=[4,5,5,6,5,6,6,7,5,6,6,7,6,7,7,8],D.ht=[new _0(0,0,null,null),new _0(2,0,D.t1HB,D.t1l),new _0(3,0,D.t2HB,D.t2l),new _0(3,0,D.t3HB,D.t3l),new _0(0,0,null,null),new _0(4,0,D.t5HB,D.t5l),new _0(4,0,D.t6HB,D.t6l),new _0(6,0,D.t7HB,D.t7l),new _0(6,0,D.t8HB,D.t8l),new _0(6,0,D.t9HB,D.t9l),new _0(8,0,D.t10HB,D.t10l),new _0(8,0,D.t11HB,D.t11l),new _0(8,0,D.t12HB,D.t12l),new _0(16,0,D.t13HB,D.t13l),new _0(0,0,null,D.t16_5l),new _0(16,0,D.t15HB,D.t15l),new _0(1,1,D.t16HB,D.t16l),new _0(2,3,D.t16HB,D.t16l),new _0(3,7,D.t16HB,D.t16l),new _0(4,15,D.t16HB,D.t16l),new _0(6,63,D.t16HB,D.t16l),new _0(8,255,D.t16HB,D.t16l),new _0(10,1023,D.t16HB,D.t16l),new _0(13,8191,D.t16HB,D.t16l),new _0(4,15,D.t24HB,D.t24l),new _0(5,31,D.t24HB,D.t24l),new _0(6,63,D.t24HB,D.t24l),new _0(7,127,D.t24HB,D.t24l),new _0(8,255,D.t24HB,D.t24l),new _0(9,511,D.t24HB,D.t24l),new _0(11,2047,D.t24HB,D.t24l),new _0(13,8191,D.t24HB,D.t24l),new _0(0,0,D.t32HB,D.t32l),new _0(0,0,D.t33HB,D.t33l)],D.largetbl=[65540,327685,458759,589832,655369,655370,720906,720907,786443,786444,786444,851980,851980,851980,917517,655370,262149,393222,524295,589832,655369,720906,720906,720907,786443,786443,786444,851980,917516,851980,917516,655370,458759,524295,589832,655369,720905,720906,786442,786443,851979,786443,851979,851980,851980,917516,917517,720905,589832,589832,655369,720905,720906,786442,786442,786443,851979,851979,917515,917516,917516,983052,983052,786441,655369,655369,720905,720906,786442,786442,851978,851979,851979,917515,917516,917516,983052,983052,983053,720905,655370,655369,720906,720906,786442,851978,851979,917515,851979,917515,917516,983052,983052,983052,1048588,786441,720906,720906,720906,786442,851978,851979,851979,851979,917515,917516,917516,917516,983052,983052,1048589,786441,720907,720906,786442,786442,851979,851979,851979,917515,917516,983052,983052,983052,983052,1114125,1114125,786442,720907,786443,786443,851979,851979,851979,917515,917515,983051,983052,983052,983052,1048588,1048589,1048589,786442,786443,786443,786443,851979,851979,917515,917515,983052,983052,983052,983052,1048588,983053,1048589,983053,851978,786444,851979,786443,851979,917515,917516,917516,917516,983052,1048588,1048588,1048589,1114125,1114125,1048589,786442,851980,851980,851979,851979,917515,917516,983052,1048588,1048588,1048588,1048588,1048589,1048589,983053,1048589,851978,851980,917516,917516,917516,917516,983052,983052,983052,983052,1114124,1048589,1048589,1048589,1048589,1179661,851978,983052,917516,917516,917516,983052,983052,1048588,1048588,1048589,1179661,1114125,1114125,1114125,1245197,1114125,851978,917517,983052,851980,917516,1048588,1048588,983052,1048589,1048589,1114125,1179661,1114125,1245197,1114125,1048589,851978,655369,655369,655369,720905,720905,786441,786441,786441,851977,851977,851977,851978,851978,851978,851978,655366],D.table23=[65538,262147,458759,262148,327684,458759,393222,458759,524296],D.table56=[65539,262148,458758,524296,262148,327684,524294,589831,458757,524294,589831,655368,524295,524295,589832,655369],D.bitrate_table=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],[0,8,16,24,32,40,48,56,64,-1,-1,-1,-1,-1,-1,-1]],D.samplerate_table=[[22050,24e3,16e3,-1],[44100,48e3,32e3,-1],[11025,12e3,8e3,-1]],D.scfsi_band=[0,6,11,16,21];function W0(f){this.bits=f}function O0(){this.over_noise=0,this.tot_noise=0,this.max_noise=0,this.over_count=0,this.over_SSD=0,this.bits=0}function q0(){this.setModules=function(f,L){}}function me(){this.useAdjust=0,this.aaSensitivityP=0,this.adjust=0,this.adjustLimit=0,this.decay=0,this.floor=0,this.l=X(r.SBMAX_l),this.s=X(r.SBMAX_s),this.psfb21=X(r.PSFB21),this.psfb12=X(r.PSFB12),this.cb_l=X(r.CBANDS),this.cb_s=X(r.CBANDS),this.eql_w=X(r.BLKSIZE/2)}function ve(){this.class_id=0,this.num_samples=0,this.num_channels=0,this.in_samplerate=0,this.out_samplerate=0,this.scale=0,this.scale_left=0,this.scale_right=0,this.analysis=!1,this.bWriteVbrTag=!1,this.decode_only=!1,this.quality=0,this.mode=I0.STEREO,this.force_ms=!1,this.free_format=!1,this.findReplayGain=!1,this.decode_on_the_fly=!1,this.write_id3tag_automatic=!1,this.brate=0,this.compression_ratio=0,this.copyright=0,this.original=0,this.extension=0,this.emphasis=0,this.error_protection=0,this.strict_ISO=!1,this.disable_reservoir=!1,this.quant_comp=0,this.quant_comp_short=0,this.experimentalY=!1,this.experimentalZ=0,this.exp_nspsytune=0,this.preset=0,this.VBR=null,this.VBR_q_frac=0,this.VBR_q=0,this.VBR_mean_bitrate_kbps=0,this.VBR_min_bitrate_kbps=0,this.VBR_max_bitrate_kbps=0,this.VBR_hard_min=0,this.lowpassfreq=0,this.highpassfreq=0,this.lowpasswidth=0,this.highpasswidth=0,this.maskingadjust=0,this.maskingadjust_short=0,this.ATHonly=!1,this.ATHshort=!1,this.noATH=!1,this.ATHtype=0,this.ATHcurve=0,this.ATHlower=0,this.athaa_type=0,this.athaa_loudapprox=0,this.athaa_sensitivity=0,this.short_blocks=null,this.useTemporal=!1,this.interChRatio=0,this.msfix=0,this.tune=!1,this.tune_value_a=0,this.version=0,this.encoder_delay=0,this.encoder_padding=0,this.framesize=0,this.frameNum=0,this.lame_allocated_gfp=0,this.internal_flags=null}function Ae(f){var L=f;this.quantize=L,this.iteration_loop=function(H,m,Q,A){var R=H.internal_flags,e0=X(h0.SFBMAX),C=X(576),N=T(2),s=0,y=R.l3_side,a=new W0(s);this.quantize.rv.ResvFrameBegin(H,a),s=a.bits;for(var w=0;w<R.mode_gr;w++){this.quantize.qupvt.on_pe(H,m,N,s,w,w),R.mode_ext==r.MPG_MD_MS_LR&&j();for(var S=0;S<R.channels_out;S++){var l,v,b=y.tt[w][S];b.block_type!=r.SHORT_TYPE?(l=0,v=R.PSY.mask_adjust-l):(l=0,v=R.PSY.mask_adjust_short-l),R.masking_lower=Math.pow(10,v*.1),this.quantize.init_outer_loop(R,b),this.quantize.init_xrpow(R,b,C)&&(this.quantize.qupvt.calc_xmin(H,A[w][S],b,e0),this.quantize.outer_loop(H,b,e0,C,S,N[S])),this.quantize.iteration_finish_one(R,w,S)}}this.quantize.rv.ResvFrameEnd(R,s)}}function pe(){}function ae(f,L,H,m){this.l=T(1+r.SBMAX_l),this.s=T(1+r.SBMAX_s),this.psfb21=T(1+r.PSFB21),this.psfb12=T(1+r.PSFB12);var Q=this.l,A=this.s;arguments.length==4&&(this.arrL=arguments[0],this.arrS=arguments[1],this.arr21=arguments[2],this.arr12=arguments[3],P.arraycopy(this.arrL,0,Q,0,Math.min(this.arrL.length,this.l.length)),P.arraycopy(this.arrS,0,A,0,Math.min(this.arrS.length,this.s.length)),P.arraycopy(this.arr21,0,this.psfb21,0,Math.min(this.arr21.length,this.psfb21.length)),P.arraycopy(this.arr12,0,this.psfb12,0,Math.min(this.arr12.length,this.psfb12.length)))}ee.Q_MAX=257,ee.Q_MAX2=116,ee.LARGE_BITS=1e5,ee.IXMAX_VAL=8206;function ee(){var f=null,L=null,H=null;this.setModules=function(d,o,c){f=d,L=o,H=c};function m(d){return y[d+ee.Q_MAX2]}this.IPOW20=function(d){return a[d]};var Q=2220446049250313e-31,A=ee.IXMAX_VAL,R=A+2,e0=ee.Q_MAX,C=ee.Q_MAX2,N=100;this.nr_of_sfb_block=[[[6,5,5,5],[9,9,9,9],[6,9,9,9]],[[6,5,7,3],[9,9,12,6],[6,9,12,6]],[[11,10,0,0],[18,18,0,0],[15,18,0,0]],[[7,7,7,0],[12,12,12,0],[6,15,12,0]],[[6,6,6,3],[12,9,9,6],[6,12,9,6]],[[8,8,5,0],[15,12,9,0],[6,18,9,0]]];var s=[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,3,3,2,0];this.pretab=s,this.sfBandIndex=[new ae([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,24,32,42,56,74,100,132,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new ae([0,6,12,18,24,30,36,44,54,66,80,96,114,136,162,194,232,278,332,394,464,540,576],[0,4,8,12,18,26,36,48,62,80,104,136,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new ae([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new ae([0,4,8,12,16,20,24,30,36,44,52,62,74,90,110,134,162,196,238,288,342,418,576],[0,4,8,12,16,22,30,40,52,66,84,106,136,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new ae([0,4,8,12,16,20,24,30,36,42,50,60,72,88,106,128,156,190,230,276,330,384,576],[0,4,8,12,16,22,28,38,50,64,80,100,126,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new ae([0,4,8,12,16,20,24,30,36,44,54,66,82,102,126,156,194,240,296,364,448,550,576],[0,4,8,12,16,22,30,42,58,78,104,138,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new ae([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0/3,12/3,24/3,36/3,54/3,78/3,108/3,144/3,186/3,240/3,312/3,402/3,522/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new ae([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0/3,12/3,24/3,36/3,54/3,78/3,108/3,144/3,186/3,240/3,312/3,402/3,522/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new ae([0,12,24,36,48,60,72,88,108,132,160,192,232,280,336,400,476,566,568,570,572,574,576],[0/3,24/3,48/3,72/3,108/3,156/3,216/3,288/3,372/3,480/3,486/3,492/3,498/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0])];var y=X(e0+C+1),a=X(e0),w=X(R),S=X(R);this.adj43=S;function l(d,o){var c=H.ATHformula(o,d);return c-=N,c=Math.pow(10,c/10+d.ATHlower),c}function v(d){for(var o=d.internal_flags.ATH.l,c=d.internal_flags.ATH.psfb21,e=d.internal_flags.ATH.s,M=d.internal_flags.ATH.psfb12,h=d.internal_flags,g=d.out_samplerate,_=0;_<r.SBMAX_l;_++){var i=h.scalefac_band.l[_],u=h.scalefac_band.l[_+1];o[_]=L0.MAX_VALUE;for(var p=i;p<u;p++){var k=p*g/1152,t=l(d,k);o[_]=Math.min(o[_],t)}}for(var _=0;_<r.PSFB21;_++){var i=h.scalefac_band.psfb21[_],u=h.scalefac_band.psfb21[_+1];c[_]=L0.MAX_VALUE;for(var p=i;p<u;p++){var k=p*g/1152,t=l(d,k);c[_]=Math.min(c[_],t)}}for(var _=0;_<r.SBMAX_s;_++){var i=h.scalefac_band.s[_],u=h.scalefac_band.s[_+1];e[_]=L0.MAX_VALUE;for(var p=i;p<u;p++){var k=p*g/384,t=l(d,k);e[_]=Math.min(e[_],t)}e[_]*=h.scalefac_band.s[_+1]-h.scalefac_band.s[_]}for(var _=0;_<r.PSFB12;_++){var i=h.scalefac_band.psfb12[_],u=h.scalefac_band.psfb12[_+1];M[_]=L0.MAX_VALUE;for(var p=i;p<u;p++){var k=p*g/384,t=l(d,k);M[_]=Math.min(M[_],t)}M[_]*=h.scalefac_band.s[13]-h.scalefac_band.s[12]}d.noATH&&j(),h.ATH.floor=10*$(l(d,-1))}this.iteration_init=function(d){var o=d.internal_flags,c=o.l3_side,e;if(o.iteration_init_init==0){for(o.iteration_init_init=1,c.main_data_begin=0,v(d),w[0]=0,e=1;e<R;e++)w[e]=Math.pow(e,4/3);for(e=0;e<R-1;e++)S[e]=e+1-Math.pow(.5*(w[e]+w[e+1]),.75);for(S[e]=.5,e=0;e<e0;e++)a[e]=Math.pow(2,(e-210)*-.1875);for(e=0;e<=e0+C;e++)y[e]=Math.pow(2,(e-210-C)*.25);f.huffman_init(o);{var M,h,g,_;for(e=d.exp_nspsytune>>2&63,e>=32&&(e-=64),M=Math.pow(10,e/4/10),e=d.exp_nspsytune>>8&63,e>=32&&(e-=64),h=Math.pow(10,e/4/10),e=d.exp_nspsytune>>14&63,e>=32&&(e-=64),g=Math.pow(10,e/4/10),e=d.exp_nspsytune>>20&63,e>=32&&(e-=64),_=g*Math.pow(10,e/4/10),e=0;e<r.SBMAX_l;e++){var i;e<=6?i=M:e<=13?i=h:e<=20?i=g:i=_,o.nsPsy.longfact[e]=i}for(e=0;e<r.SBMAX_s;e++){var i;e<=5?i=M:e<=10?i=h:e<=11?i=g:i=_,o.nsPsy.shortfact[e]=i}}}},this.on_pe=function(d,o,c,e,M,h){var g=d.internal_flags,_=0,i,u=T(2),p,k=new W0(_),t=L.ResvMaxBits(d,e,k,h);_=k.bits;var n=_+t;for(n>A0.MAX_BITS_PER_GRANULE&&(n=A0.MAX_BITS_PER_GRANULE),i=0,p=0;p<g.channels_out;++p)c[p]=Math.min(A0.MAX_BITS_PER_CHANNEL,_/g.channels_out),u[p]=0|c[p]*o[M][p]/700-c[p],u[p]>e*3/4&&(u[p]=e*3/4),u[p]<0&&(u[p]=0),u[p]+c[p]>A0.MAX_BITS_PER_CHANNEL&&(u[p]=Math.max(0,A0.MAX_BITS_PER_CHANNEL-c[p])),i+=u[p];if(i>t)for(p=0;p<g.channels_out;++p)u[p]=t*u[p]/i;for(p=0;p<g.channels_out;++p)c[p]+=u[p],t-=u[p];for(i=0,p=0;p<g.channels_out;++p)i+=c[p];return i>A0.MAX_BITS_PER_GRANULE&&j(),n},this.athAdjust=function(d,o,c){var e=90.30873362,M=94.82444863,h=W.FAST_LOG10_X(o,10),g=d*d,_=0;return h-=c,g>1e-20&&(_=1+W.FAST_LOG10_X(g,10/e)),_<0&&(_=0),h*=_,h+=c+e-M,Math.pow(10,.1*h)},this.calc_xmin=function(d,o,c,e){var M=0,h=d.internal_flags,g,_=0,i=0,u=h.ATH,p=c.xr,k=d.VBR==U.vbr_mtrh?1:0,t=h.masking_lower;for((d.VBR==U.vbr_mtrh||d.VBR==U.vbr_mt)&&(t=1),g=0;g<c.psy_lmax;g++){var n,Y,E,V,J,t0;d.VBR==U.vbr_rh||d.VBR==U.vbr_mtrh?Y=athAdjust(u.adjust,u.l[g],u.floor):Y=u.adjust*u.l[g],J=c.width[g],E=Y/J,V=Q,t0=J>>1,n=0;do{var l0,k0;l0=p[_]*p[_],n+=l0,V+=l0<E?l0:E,_++,k0=p[_]*p[_],n+=k0,V+=k0<E?k0:E,_++}while(--t0>0);if(n>Y&&i++,g==r.SBPSY_l&&j(),k!=0&&(Y=V),!d.ATHonly){var P0=o.en.l[g];if(P0>0){var F0;F0=n*o.thm.l[g]*t/P0,k!=0&&(F0*=h.nsPsy.longfact[g]),Y<F0&&(Y=F0)}}k!=0?e[M++]=Y:e[M++]=Y*h.nsPsy.longfact[g]}var _e=575;if(c.block_type!=r.SHORT_TYPE)for(var ue=576;ue--!=0&&x0.EQ(p[ue],0);)_e=ue;c.max_nonzero_coeff=_e;for(var ne=c.sfb_smin;g<c.psymax;ne++,g+=3){var J,le,he;for(d.VBR==U.vbr_rh||d.VBR==U.vbr_mtrh?he=athAdjust(u.adjust,u.s[ne],u.floor):he=u.adjust*u.s[ne],J=c.width[g],le=0;le<3;le++){var n=0,Y,E,V,t0=J>>1;E=he/J,V=Q;do{var l0,k0;l0=p[_]*p[_],n+=l0,V+=l0<E?l0:E,_++,k0=p[_]*p[_],n+=k0,V+=k0<E?k0:E,_++}while(--t0>0);if(n>he&&i++,ne==r.SBPSY_s&&j(),k!=0?Y=V:Y=he,!d.ATHonly&&!d.ATHshort){var P0=o.en.s[ne][le];if(P0>0){var F0;F0=n*o.thm.s[ne][le]*t/P0,k!=0&&(F0*=h.nsPsy.shortfact[ne]),Y<F0&&(Y=F0)}}k!=0?e[M++]=Y:e[M++]=Y*h.nsPsy.shortfact[ne]}d.useTemporal&&(e[M-3]>e[M-3+1]&&(e[M-3+1]+=(e[M-3]-e[M-3+1])*h.decay),e[M-3+1]>e[M-3+2]&&(e[M-3+2]+=(e[M-3+1]-e[M-3+2])*h.decay))}return i};function b(d){this.s=d}this.calc_noise_core=function(d,o,c,e){var M=0,h=o.s,g=d.l3_enc;if(h>d.count1)for(;c--!=0;){var _;_=d.xr[h],h++,M+=_*_,_=d.xr[h],h++,M+=_*_}else if(h>d.big_values){var i=X(2);for(i[0]=0,i[1]=e;c--!=0;){var _;_=Math.abs(d.xr[h])-i[g[h]],h++,M+=_*_,_=Math.abs(d.xr[h])-i[g[h]],h++,M+=_*_}}else for(;c--!=0;){var _;_=Math.abs(d.xr[h])-w[g[h]]*e,h++,M+=_*_,_=Math.abs(d.xr[h])-w[g[h]]*e,h++,M+=_*_}return o.s=h,M},this.calc_noise=function(d,o,c,e,M){var h=0,g=0,_,i,u=0,p=0,k=0,t=-20,n=0,Y=d.scalefac,E=0;for(e.over_SSD=0,_=0;_<d.psymax;_++){var V=d.global_gain-(Y[E++]+(d.preflag!=0?s[_]:0)<<d.scalefac_scale+1)-d.subblock_gain[d.window[_]]*8,J=0;if(M!=null&&M.step[_]==V)J=M.noise[_],n+=d.width[_],c[h++]=J/o[g++],J=M.noise_log[_];else{var t0=m(V);if(i=d.width[_]>>1,n+d.width[_]>d.max_nonzero_coeff){var l0;l0=d.max_nonzero_coeff-n+1,l0>0?i=l0>>1:i=0}var k0=new b(n);J=this.calc_noise_core(d,k0,i,t0),n=k0.s,M!=null&&(M.step[_]=V,M.noise[_]=J),J=c[h++]=J/o[g++],J=W.FAST_LOG10(Math.max(J,1e-20)),M!=null&&(M.noise_log[_]=J)}if(M!=null&&(M.global_gain=d.global_gain),k+=J,J>0){var P0;P0=Math.max(0|J*10+.5,1),e.over_SSD+=P0*P0,u++,p+=J}t=Math.max(t,J)}return e.over_count=u,e.tot_noise=k,e.over_noise=p,e.max_noise=t,u}}function Re(){this.global_gain=0,this.sfb_count1=0,this.step=T(39),this.noise=X(39),this.noise_log=X(39)}function ce(){this.xr=X(576),this.l3_enc=T(576),this.scalefac=T(h0.SFBMAX),this.xrpow_max=0,this.part2_3_length=0,this.big_values=0,this.count1=0,this.global_gain=0,this.scalefac_compress=0,this.block_type=0,this.mixed_block_flag=0,this.table_select=T(3),this.subblock_gain=T(4),this.region0_count=0,this.region1_count=0,this.preflag=0,this.scalefac_scale=0,this.count1table_select=0,this.part2_length=0,this.sfb_lmax=0,this.sfb_smin=0,this.psy_lmax=0,this.sfbmax=0,this.psymax=0,this.sfbdivide=0,this.width=T(h0.SFBMAX),this.window=T(h0.SFBMAX),this.count1bits=0,this.sfb_partition_table=null,this.slen=T(4),this.max_nonzero_coeff=0;var f=this;function L(m){return new Int32Array(m)}function H(m){return new Float32Array(m)}this.assign=function(m){f.xr=H(m.xr),f.l3_enc=L(m.l3_enc),f.scalefac=L(m.scalefac),f.xrpow_max=m.xrpow_max,f.part2_3_length=m.part2_3_length,f.big_values=m.big_values,f.count1=m.count1,f.global_gain=m.global_gain,f.scalefac_compress=m.scalefac_compress,f.block_type=m.block_type,f.mixed_block_flag=m.mixed_block_flag,f.table_select=L(m.table_select),f.subblock_gain=L(m.subblock_gain),f.region0_count=m.region0_count,f.region1_count=m.region1_count,f.preflag=m.preflag,f.scalefac_scale=m.scalefac_scale,f.count1table_select=m.count1table_select,f.part2_length=m.part2_length,f.sfb_lmax=m.sfb_lmax,f.sfb_smin=m.sfb_smin,f.psy_lmax=m.psy_lmax,f.sfbmax=m.sfbmax,f.psymax=m.psymax,f.sfbdivide=m.sfbdivide,f.width=L(m.width),f.window=L(m.window),f.count1bits=m.count1bits,f.sfb_partition_table=m.sfb_partition_table.slice(0),f.slen=L(m.slen),f.max_nonzero_coeff=m.max_nonzero_coeff}}var h0={};h0.SFBMAX=r.SBMAX_s*3;function Pe(){this.rv=null;var f;this.qupvt=null;var L,H=new q0,m;this.setModules=function(S,l,v,b){f=l,this.rv=l,L=v,this.qupvt=v,m=b,H.setModules(L,m)};function Q(S,l,v,b){b=0;for(var d=0;d<=v;++d){var o=Math.abs(S.xr[d]);b+=o,l[d]=Math.sqrt(o*Math.sqrt(o)),l[d]>S.xrpow_max&&(S.xrpow_max=l[d])}return b}this.init_xrpow=function(S,l,v){var b=0,d=0|l.max_nonzero_coeff;if(l.xrpow_max=0,T0.fill(v,d,576,0),b=Q(l,v,d,b),b>1e-20){var o=0;(S.substep_shaping&2)!=0&&(o=1);for(var c=0;c<l.psymax;c++)S.pseudohalf[c]=o;return!0}return T0.fill(l.l3_enc,0,576,0),!1};function A(S,l){var v=S.ATH,b=l.xr;if(l.block_type!=r.SHORT_TYPE)for(var d=!1,o=r.PSFB21-1;o>=0&&!d;o--){var c=S.scalefac_band.psfb21[o],e=S.scalefac_band.psfb21[o+1],M=L.athAdjust(v.adjust,v.psfb21[o],v.floor);S.nsPsy.longfact[21]>1e-12&&(M*=S.nsPsy.longfact[21]);for(var h=e-1;h>=c;h--)if(Math.abs(b[h])<M)b[h]=0;else{d=!0;break}}else for(var g=0;g<3;g++)for(var d=!1,o=r.PSFB12-1;o>=0&&!d;o--){var c=S.scalefac_band.s[12]*3+(S.scalefac_band.s[13]-S.scalefac_band.s[12])*g+(S.scalefac_band.psfb12[o]-S.scalefac_band.psfb12[0]),e=c+(S.scalefac_band.psfb12[o+1]-S.scalefac_band.psfb12[o]),_=L.athAdjust(v.adjust,v.psfb12[o],v.floor);S.nsPsy.shortfact[12]>1e-12&&(_*=S.nsPsy.shortfact[12]);for(var h=e-1;h>=c;h--)if(Math.abs(b[h])<_)b[h]=0;else{d=!0;break}}}this.init_outer_loop=function(S,l){l.part2_3_length=0,l.big_values=0,l.count1=0,l.global_gain=210,l.scalefac_compress=0,l.table_select[0]=0,l.table_select[1]=0,l.table_select[2]=0,l.subblock_gain[0]=0,l.subblock_gain[1]=0,l.subblock_gain[2]=0,l.subblock_gain[3]=0,l.region0_count=0,l.region1_count=0,l.preflag=0,l.scalefac_scale=0,l.count1table_select=0,l.part2_length=0,l.sfb_lmax=r.SBPSY_l,l.sfb_smin=r.SBPSY_s,l.psy_lmax=S.sfb21_extra?r.SBMAX_l:r.SBPSY_l,l.psymax=l.psy_lmax,l.sfbmax=l.sfb_lmax,l.sfbdivide=11;for(var v=0;v<r.SBMAX_l;v++)l.width[v]=S.scalefac_band.l[v+1]-S.scalefac_band.l[v],l.window[v]=3;if(l.block_type==r.SHORT_TYPE){var b=X(576);l.sfb_smin=0,l.sfb_lmax=0,l.mixed_block_flag!=0&&j(),l.psymax=l.sfb_lmax+3*((S.sfb21_extra?r.SBMAX_s:r.SBPSY_s)-l.sfb_smin),l.sfbmax=l.sfb_lmax+3*(r.SBPSY_s-l.sfb_smin),l.sfbdivide=l.sfbmax-18,l.psy_lmax=l.sfb_lmax;var d=S.scalefac_band.l[l.sfb_lmax];P.arraycopy(l.xr,0,b,0,576);for(var v=l.sfb_smin;v<r.SBMAX_s;v++)for(var o=S.scalefac_band.s[v],c=S.scalefac_band.s[v+1],e=0;e<3;e++)for(var M=o;M<c;M++)l.xr[d++]=b[3*M+e];for(var h=l.sfb_lmax,v=l.sfb_smin;v<r.SBMAX_s;v++)l.width[h]=l.width[h+1]=l.width[h+2]=S.scalefac_band.s[v+1]-S.scalefac_band.s[v],l.window[h]=0,l.window[h+1]=1,l.window[h+2]=2,h+=3}l.count1bits=0,l.sfb_partition_table=L.nr_of_sfb_block[0][0],l.slen[0]=0,l.slen[1]=0,l.slen[2]=0,l.slen[3]=0,l.max_nonzero_coeff=575,T0.fill(l.scalefac,0),A(S,l)};function R(S){this.ordinal=S}R.BINSEARCH_NONE=new R(0),R.BINSEARCH_UP=new R(1),R.BINSEARCH_DOWN=new R(2);function e0(S,l,v,b,d){var o,c=S.CurrentStep[b],e=!1,M=S.OldValue[b],h=R.BINSEARCH_NONE;for(l.global_gain=M,v-=l.part2_length;;){var g;if(o=m.count_bits(S,d,l,null),c==1||o==v)break;o>v?(h==R.BINSEARCH_DOWN&&(e=!0),e&&(c/=2),h=R.BINSEARCH_UP,g=c):(h==R.BINSEARCH_UP&&(e=!0),e&&(c/=2),h=R.BINSEARCH_DOWN,g=-c),l.global_gain+=g,l.global_gain<0&&j(),l.global_gain>255&&j()}for(;o>v&&l.global_gain<255;)l.global_gain++,o=m.count_bits(S,d,l,null);return S.CurrentStep[b]=M-l.global_gain>=4?4:2,S.OldValue[b]=l.global_gain,l.part2_3_length=o,o}function C(S){for(var l=0;l<S.sfbmax;l++)if(S.scalefac[l]+S.subblock_gain[S.window[l]]==0)return!1;return!0}function N(S,l,v,b,d){var o;switch(S){default:case 9:{l.over_count>0?(o=v.over_SSD<=l.over_SSD,v.over_SSD==l.over_SSD&&(o=v.bits<l.bits)):o=v.max_noise<0&&v.max_noise*10+v.bits<=l.max_noise*10+l.bits;break}case 0:o=v.over_count<l.over_count||v.over_count==l.over_count&&v.over_noise<l.over_noise||v.over_count==l.over_count&&x0.EQ(v.over_noise,l.over_noise)&&v.tot_noise<l.tot_noise;break;case 8:j();case 1:o=v.max_noise<l.max_noise;break;case 2:o=v.tot_noise<l.tot_noise;break;case 3:o=v.tot_noise<l.tot_noise&&v.max_noise<l.max_noise;break;case 4:o=v.max_noise<=0&&l.max_noise>.2||v.max_noise<=0&&l.max_noise<0&&l.max_noise>v.max_noise-.2&&v.tot_noise<l.tot_noise||v.max_noise<=0&&l.max_noise>0&&l.max_noise>v.max_noise-.2&&v.tot_noise<l.tot_noise+l.over_noise||v.max_noise>0&&l.max_noise>-.05&&l.max_noise>v.max_noise-.1&&v.tot_noise+v.over_noise<l.tot_noise+l.over_noise||v.max_noise>0&&l.max_noise>-.1&&l.max_noise>v.max_noise-.15&&v.tot_noise+v.over_noise+v.over_noise<l.tot_noise+l.over_noise+l.over_noise;break;case 5:o=v.over_noise<l.over_noise||x0.EQ(v.over_noise,l.over_noise)&&v.tot_noise<l.tot_noise;break;case 6:o=v.over_noise<l.over_noise||x0.EQ(v.over_noise,l.over_noise)&&(v.max_noise<l.max_noise||x0.EQ(v.max_noise,l.max_noise)&&v.tot_noise<=l.tot_noise);break;case 7:o=v.over_count<l.over_count||v.over_noise<l.over_noise;break}return l.over_count==0&&(o=o&&v.bits<l.bits),o}function s(S,l,v,b,d){var o=S.internal_flags,c;l.scalefac_scale==0?c=1.2968395546510096:c=1.6817928305074292;for(var e=0,M=0;M<l.sfbmax;M++)e<v[M]&&(e=v[M]);var h=o.noise_shaping_amp;switch(h==3&&j(),h){case 2:break;case 1:e>1?e=Math.pow(e,.5):e*=.95;break;case 0:default:e>1?e=1:e*=.95;break}for(var g=0,M=0;M<l.sfbmax;M++){var _=l.width[M],i;if(g+=_,!(v[M]<e)){for((o.substep_shaping&2)!=0&&j(),l.scalefac[M]++,i=-_;i<0;i++)b[g+i]*=c,b[g+i]>l.xrpow_max&&(l.xrpow_max=b[g+i]);if(o.noise_shaping_amp==2)return}}}function y(S,l){for(var v=1.2968395546510096,b=0,d=0;d<S.sfbmax;d++){var o=S.width[d],c=S.scalefac[d];if(S.preflag!=0&&(c+=L.pretab[d]),b+=o,(c&1)!=0){c++;for(var e=-o;e<0;e++)l[b+e]*=v,l[b+e]>S.xrpow_max&&(S.xrpow_max=l[b+e])}S.scalefac[d]=c>>1}S.preflag=0,S.scalefac_scale=1}function a(S,l,v){var b,d=l.scalefac;for(b=0;b<l.sfb_lmax;b++)if(d[b]>=16)return!0;for(var o=0;o<3;o++){var c=0,e=0;for(b=l.sfb_lmax+o;b<l.sfbdivide;b+=3)c<d[b]&&(c=d[b]);for(;b<l.sfbmax;b+=3)e<d[b]&&(e=d[b]);if(!(c<16&&e<8)){if(l.subblock_gain[o]>=7)return!0;l.subblock_gain[o]++;var M=S.scalefac_band.l[l.sfb_lmax];for(b=l.sfb_lmax+o;b<l.sfbmax;b+=3){var h,g=l.width[b],_=d[b];if(_=_-(4>>l.scalefac_scale),_>=0){d[b]=_,M+=g*3;continue}d[b]=0;{var i=210+(_<<l.scalefac_scale+1);h=L.IPOW20(i)}M+=g*(o+1);for(var u=-g;u<0;u++)v[M+u]*=h,v[M+u]>l.xrpow_max&&(l.xrpow_max=v[M+u]);M+=g*(3-o-1)}{var h=L.IPOW20(202);M+=l.width[b]*(o+1);for(var u=-l.width[b];u<0;u++)v[M+u]*=h,v[M+u]>l.xrpow_max&&(l.xrpow_max=v[M+u])}}}return!1}function w(S,l,v,b,d){var o=S.internal_flags;s(S,l,v,b);var c=C(l);return c?!1:(o.mode_gr==2?c=m.scale_bitcount(l):c=m.scale_bitcount_lsf(o,l),c?(o.noise_shaping>1&&(T0.fill(o.pseudohalf,0),l.scalefac_scale==0?(y(l,b),c=!1):l.block_type==r.SHORT_TYPE&&o.subblock_gain>0&&(c=a(o,l,b)||C(l))),c||(o.mode_gr==2?c=m.scale_bitcount(l):c=m.scale_bitcount_lsf(o,l)),!c):!0)}this.outer_loop=function(S,l,v,b,d,o){var c=S.internal_flags,e=new ce,M=X(576),h=X(h0.SFBMAX),g=new O0,_,i=new Re,u=9999999,p=!1,k=!1;if(e0(c,l,o,d,b),c.noise_shaping==0)return 100;L.calc_noise(l,v,h,g,i),g.bits=l.part2_3_length,e.assign(l);var t=0;for(P.arraycopy(b,0,M,0,576);!p;){do{var n=new O0,Y,E=255;if((c.substep_shaping&2)!=0?Y=20:Y=3,c.sfb21_extra&&j(),!w(S,e,h,b))break;e.scalefac_scale!=0&&(E=254);var V=o-e.part2_length;if(V<=0)break;for(;(e.part2_3_length=m.count_bits(c,b,e,i))>V&&e.global_gain<=E;)e.global_gain++;if(e.global_gain>E)break;if(g.over_count==0){for(;(e.part2_3_length=m.count_bits(c,b,e,i))>u&&e.global_gain<=E;)e.global_gain++;if(e.global_gain>E)break}if(L.calc_noise(e,v,h,n,i),n.bits=e.part2_3_length,l.block_type!=r.SHORT_TYPE?_=S.quant_comp:_=S.quant_comp_short,_=N(_,g,n)?1:0,_!=0)u=l.part2_3_length,g=n,l.assign(e),t=0,P.arraycopy(b,0,M,0,576);else if(c.full_outer_loop==0){if(++t>Y&&g.over_count==0)break;c.noise_shaping_amp==3,c.noise_shaping_amp==3}}while(e.global_gain+e.scalefac_scale<255);c.noise_shaping_amp==3?j():p=!0}return S.VBR==U.vbr_rh||S.VBR==U.vbr_mtrh?P.arraycopy(M,0,b,0,576):(c.substep_shaping&1)!=0&&j(),g.over_count},this.iteration_finish_one=function(S,l,v){var b=S.l3_side,d=b.tt[l][v];m.best_scalefac_store(S,l,v,b),S.use_best_huffman==1&&m.best_huffman_divide(S,d),f.ResvAdjust(S,d)}}function x(){var f=[-.1482523854003001,32.308141959636465,296.40344946382766,883.1344870032432,11113.947376231741,1057.2713659324597,305.7402417275812,30.825928907280012,3.8533188138216365,59.42900443849514,709.5899960123345,5281.91112291017,-5829.66483675846,-817.6293103748613,-76.91656988279972,-4.594269939176596,.9063471690191471,.1960342806591213,-.15466694054279598,34.324387823855965,301.8067566458425,817.599602898885,11573.795901679885,1181.2520595540152,321.59731579894424,31.232021761053772,3.7107095756221318,53.650946155329365,684.167428119626,5224.56624370173,-6366.391851890084,-908.9766368219582,-89.83068876699639,-5.411397422890401,.8206787908286602,.3901806440322567,-.16070888947830023,36.147034243915876,304.11815768187864,732.7429163887613,11989.60988270091,1300.012278487897,335.28490093152146,31.48816102859945,3.373875931311736,47.232241542899175,652.7371796173471,5132.414255594984,-6909.087078780055,-1001.9990371107289,-103.62185754286375,-6.104916304710272,.7416505462720353,.5805693545089249,-.16636367662261495,37.751650073343995,303.01103387567713,627.9747488785183,12358.763425278165,1412.2779918482834,346.7496836825721,31.598286663170416,3.1598635433980946,40.57878626349686,616.1671130880391,5007.833007176154,-7454.040671756168,-1095.7960341867115,-118.24411666465777,-6.818469345853504,.6681786379192989,.7653668647301797,-.1716176790982088,39.11551877123304,298.3413246578966,503.5259106886539,12679.589408408976,1516.5821921214542,355.9850766329023,31.395241710249053,2.9164211881972335,33.79716964664243,574.8943997801362,4853.234992253242,-7997.57021486075,-1189.7624067269965,-133.6444792601766,-7.7202770609839915,.5993769336819237,.9427934736519954,-.17645823955292173,40.21879108166477,289.9982036694474,359.3226160751053,12950.259102786438,1612.1013903507662,362.85067106591504,31.045922092242872,2.822222032597987,26.988862316190684,529.8996541764288,4671.371946949588,-8535.899136645805,-1282.5898586244496,-149.58553632943463,-8.643494270763135,.5345111359507916,1.111140466039205,-.36174739330527045,41.04429910497807,277.5463268268618,195.6386023135583,13169.43812144731,1697.6433561479398,367.40983966190305,30.557037410382826,2.531473372857427,20.070154905927314,481.50208566532336,4464.970341588308,-9065.36882077239,-1373.62841526722,-166.1660487028118,-9.58289321133207,.4729647758913199,1.268786568327291,-.36970682634889585,41.393213350082036,261.2935935556502,12.935476055240873,13336.131683328815,1772.508612059496,369.76534388639965,29.751323653701338,2.4023193045459172,13.304795348228817,430.5615775526625,4237.0568611071185,-9581.931701634761,-1461.6913552409758,-183.12733958476446,-10.718010163869403,.41421356237309503,1.414213562373095,-.37677560326535325,41.619486213528496,241.05423794991074,-187.94665032361226,13450.063605744153,1836.153896465782,369.4908799925761,29.001847876923147,2.0714759319987186,6.779591200894186,377.7767837205709,3990.386575512536,-10081.709459700915,-1545.947424837898,-200.3762958015653,-11.864482073055006,.3578057213145241,1.546020906725474,-.3829366947518991,41.1516456456653,216.47684307105183,-406.1569483347166,13511.136535077321,1887.8076599260432,367.3025214564151,28.136213436723654,1.913880671464418,.3829366947518991,323.85365704338597,3728.1472257487526,-10561.233882199509,-1625.2025997821418,-217.62525175416,-13.015432208941645,.3033466836073424,1.66293922460509,-.5822628872992417,40.35639251440489,188.20071124269245,-640.2706748618148,13519.21490106562,1927.6022433578062,362.8197642637487,26.968821921868447,1.7463817695935329,-5.62650678237171,269.3016715297017,3453.386536448852,-11016.145278780888,-1698.6569643425091,-234.7658734267683,-14.16351421663124,.2504869601913055,1.76384252869671,-.5887180101749253,39.23429103868072,155.76096234403798,-889.2492977967378,13475.470561874661,1955.0535223723712,356.4450994756727,25.894952980042156,1.5695032905781554,-11.181939564328772,214.80884394039484,3169.1640829158237,-11443.321309975563,-1765.1588461316153,-251.68908574481912,-15.49755935939164,.198912367379658,1.847759065022573,-.7912582233652842,37.39369355329111,119.699486012458,-1151.0956593239027,13380.446257078214,1970.3952110853447,348.01959814116185,24.731487364283044,1.3850130831637748,-16.421408865300393,161.05030052864092,2878.3322807850063,-11838.991423510031,-1823.985884688674,-268.2854986386903,-16.81724543849939,.1483359875383474,1.913880671464418,-.7960642926861912,35.2322109610459,80.01928065061526,-1424.0212633405113,13235.794061869668,1973.804052543835,337.9908651258184,23.289159354463873,1.3934255946442087,-21.099669467133474,108.48348407242611,2583.700758091299,-12199.726194855148,-1874.2780658979746,-284.2467154529415,-18.11369784385905,.09849140335716425,1.961570560806461,-.998795456205172,32.56307803611191,36.958364584370486,-1706.075448829146,13043.287458812016,1965.3831106103316,326.43182772364605,22.175018750622293,1.198638339011324,-25.371248002043963,57.53505923036915,2288.41886619975,-12522.674544337233,-1914.8400385312243,-299.26241273417224,-19.37805630698734,.04912684976946725,1.990369453344394,.035780907*W.SQRT2*.5/2384e-9,.017876148*W.SQRT2*.5/2384e-9,.003134727*W.SQRT2*.5/2384e-9,.002457142*W.SQRT2*.5/2384e-9,971317e-9*W.SQRT2*.5/2384e-9,218868e-9*W.SQRT2*.5/2384e-9,101566e-9*W.SQRT2*.5/2384e-9,13828e-9*W.SQRT2*.5/2384e-9,12804.797818791945,1945.5515939597317,313.4244966442953,20.801593959731544,1995.1556208053692,9.000838926174497,-29.20218120805369],L=[[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,940084909404969e-27,6423305872147839e-28,2382191739347918e-28,5456116108943412e-27,4878985199565852e-27,4240448995017367e-27,3559909094758252e-27,2858043359288075e-27,2156177623817898e-27,1475637723558783e-27,8371015190102974e-28,2599706096327376e-28,-5456116108943412e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758252e-27,-2858043359288076e-27,-2156177623817898e-27,-1475637723558783e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347923e-28,-6423305872147843e-28,-9400849094049696e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049694e-28,-642330587214784e-27,-2382191739347918e-28],[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,9400849094049688e-28,6423305872147841e-28,2382191739347918e-28,5456116108943413e-27,4878985199565852e-27,4240448995017367e-27,3559909094758253e-27,2858043359288075e-27,2156177623817898e-27,1475637723558782e-27,8371015190102975e-28,2599706096327376e-28,-5461314069809755e-27,-4921085770524055e-27,-4343405037091838e-27,-3732668368707687e-27,-3093523840190885e-27,-2430835727329465e-27,-1734679010007751e-27,-974825365660928e-27,-2797435120168326e-28,0,0,0,0,0,0,-2283748241799531e-28,-4037858874020686e-28,-2146547464825323e-28],[.1316524975873958,.414213562373095,.7673269879789602,1.091308501069271,1.303225372841206,1.56968557711749,1.920982126971166,2.414213562373094,3.171594802363212,4.510708503662055,7.595754112725146,22.90376554843115,.984807753012208,.6427876096865394,.3420201433256688,.9396926207859084,-.1736481776669303,-.7660444431189779,.8660254037844387,.5,-.5144957554275265,-.4717319685649723,-.3133774542039019,-.1819131996109812,-.09457419252642064,-.04096558288530405,-.01419856857247115,-.003699974673760037,.8574929257125442,.8817419973177052,.9496286491027329,.9833145924917901,.9955178160675857,.9991605581781475,.999899195244447,.9999931550702802],[0,0,0,0,0,0,2283748241799531e-28,4037858874020686e-28,2146547464825323e-28,5461314069809755e-27,4921085770524055e-27,4343405037091838e-27,3732668368707687e-27,3093523840190885e-27,2430835727329466e-27,1734679010007751e-27,974825365660928e-27,2797435120168326e-28,-5456116108943413e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758253e-27,-2858043359288075e-27,-2156177623817898e-27,-1475637723558782e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347913e-28,-6423305872147834e-28,-9400849094049688e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049688e-28,-6423305872147841e-28,-2382191739347918e-28]],H=L[r.SHORT_TYPE],m=L[r.SHORT_TYPE],Q=L[r.SHORT_TYPE],A=L[r.SHORT_TYPE],R=[0,1,16,17,8,9,24,25,4,5,20,21,12,13,28,29,2,3,18,19,10,11,26,27,6,7,22,23,14,15,30,31];function e0(s,y,a){for(var w=10,S=y+238-14-286,l=-15;l<0;l++){var v,b,d;v=f[w+-10],b=s[S+-224]*v,d=s[y+224]*v,v=f[w+-9],b+=s[S+-160]*v,d+=s[y+160]*v,v=f[w+-8],b+=s[S+-96]*v,d+=s[y+96]*v,v=f[w+-7],b+=s[S+-32]*v,d+=s[y+32]*v,v=f[w+-6],b+=s[S+32]*v,d+=s[y+-32]*v,v=f[w+-5],b+=s[S+96]*v,d+=s[y+-96]*v,v=f[w+-4],b+=s[S+160]*v,d+=s[y+-160]*v,v=f[w+-3],b+=s[S+224]*v,d+=s[y+-224]*v,v=f[w+-2],b+=s[y+-256]*v,d-=s[S+256]*v,v=f[w+-1],b+=s[y+-192]*v,d-=s[S+192]*v,v=f[w+0],b+=s[y+-128]*v,d-=s[S+128]*v,v=f[w+1],b+=s[y+-64]*v,d-=s[S+64]*v,v=f[w+2],b+=s[y+0]*v,d-=s[S+0]*v,v=f[w+3],b+=s[y+64]*v,d-=s[S+-64]*v,v=f[w+4],b+=s[y+128]*v,d-=s[S+-128]*v,v=f[w+5],b+=s[y+192]*v,d-=s[S+-192]*v,b*=f[w+6],v=d-b,a[30+l*2]=d+b,a[31+l*2]=f[w+7]*v,w+=18,y--,S++}{var b,d,o,c;d=s[y+-16]*f[w+-10],b=s[y+-32]*f[w+-2],d+=(s[y+-48]-s[y+16])*f[w+-9],b+=s[y+-96]*f[w+-1],d+=(s[y+-80]+s[y+48])*f[w+-8],b+=s[y+-160]*f[w+0],d+=(s[y+-112]-s[y+80])*f[w+-7],b+=s[y+-224]*f[w+1],d+=(s[y+-144]+s[y+112])*f[w+-6],b-=s[y+32]*f[w+2],d+=(s[y+-176]-s[y+144])*f[w+-5],b-=s[y+96]*f[w+3],d+=(s[y+-208]+s[y+176])*f[w+-4],b-=s[y+160]*f[w+4],d+=(s[y+-240]-s[y+208])*f[w+-3],b-=s[y+224],o=b-d,c=b+d,d=a[14],b=a[15]-d,a[31]=c+d,a[30]=o+b,a[15]=o-b,a[14]=c-d}{var e;e=a[28]-a[0],a[0]+=a[28],a[28]=e*f[w+-2*18+7],e=a[29]-a[1],a[1]+=a[29],a[29]=e*f[w+-2*18+7],e=a[26]-a[2],a[2]+=a[26],a[26]=e*f[w+-4*18+7],e=a[27]-a[3],a[3]+=a[27],a[27]=e*f[w+-4*18+7],e=a[24]-a[4],a[4]+=a[24],a[24]=e*f[w+-6*18+7],e=a[25]-a[5],a[5]+=a[25],a[25]=e*f[w+-6*18+7],e=a[22]-a[6],a[6]+=a[22],a[22]=e*W.SQRT2,e=a[23]-a[7],a[7]+=a[23],a[23]=e*W.SQRT2-a[7],a[7]-=a[6],a[22]-=a[7],a[23]-=a[22],e=a[6],a[6]=a[31]-e,a[31]=a[31]+e,e=a[7],a[7]=a[30]-e,a[30]=a[30]+e,e=a[22],a[22]=a[15]-e,a[15]=a[15]+e,e=a[23],a[23]=a[14]-e,a[14]=a[14]+e,e=a[20]-a[8],a[8]+=a[20],a[20]=e*f[w+-10*18+7],e=a[21]-a[9],a[9]+=a[21],a[21]=e*f[w+-10*18+7],e=a[18]-a[10],a[10]+=a[18],a[18]=e*f[w+-12*18+7],e=a[19]-a[11],a[11]+=a[19],a[19]=e*f[w+-12*18+7],e=a[16]-a[12],a[12]+=a[16],a[16]=e*f[w+-14*18+7],e=a[17]-a[13],a[13]+=a[17],a[17]=e*f[w+-14*18+7],e=-a[20]+a[24],a[20]+=a[24],a[24]=e*f[w+-12*18+7],e=-a[21]+a[25],a[21]+=a[25],a[25]=e*f[w+-12*18+7],e=a[4]-a[8],a[4]+=a[8],a[8]=e*f[w+-12*18+7],e=a[5]-a[9],a[5]+=a[9],a[9]=e*f[w+-12*18+7],e=a[0]-a[12],a[0]+=a[12],a[12]=e*f[w+-4*18+7],e=a[1]-a[13],a[1]+=a[13],a[13]=e*f[w+-4*18+7],e=a[16]-a[28],a[16]+=a[28],a[28]=e*f[w+-4*18+7],e=-a[17]+a[29],a[17]+=a[29],a[29]=e*f[w+-4*18+7],e=W.SQRT2*(a[2]-a[10]),a[2]+=a[10],a[10]=e,e=W.SQRT2*(a[3]-a[11]),a[3]+=a[11],a[11]=e,e=W.SQRT2*(-a[18]+a[26]),a[18]+=a[26],a[26]=e-a[18],e=W.SQRT2*(-a[19]+a[27]),a[19]+=a[27],a[27]=e-a[19],e=a[2],a[19]-=a[3],a[3]-=e,a[2]=a[31]-e,a[31]+=e,e=a[3],a[11]-=a[19],a[18]-=e,a[3]=a[30]-e,a[30]+=e,e=a[18],a[27]-=a[11],a[19]-=e,a[18]=a[15]-e,a[15]+=e,e=a[19],a[10]-=e,a[19]=a[14]-e,a[14]+=e,e=a[10],a[11]-=e,a[10]=a[23]-e,a[23]+=e,e=a[11],a[26]-=e,a[11]=a[22]-e,a[22]+=e,e=a[26],a[27]-=e,a[26]=a[7]-e,a[7]+=e,e=a[27],a[27]=a[6]-e,a[6]+=e,e=W.SQRT2*(a[0]-a[4]),a[0]+=a[4],a[4]=e,e=W.SQRT2*(a[1]-a[5]),a[1]+=a[5],a[5]=e,e=W.SQRT2*(a[16]-a[20]),a[16]+=a[20],a[20]=e,e=W.SQRT2*(a[17]-a[21]),a[17]+=a[21],a[21]=e,e=-W.SQRT2*(a[8]-a[12]),a[8]+=a[12],a[12]=e-a[8],e=-W.SQRT2*(a[9]-a[13]),a[9]+=a[13],a[13]=e-a[9],e=-W.SQRT2*(a[25]-a[29]),a[25]+=a[29],a[29]=e-a[25],e=-W.SQRT2*(a[24]+a[28]),a[24]-=a[28],a[28]=e-a[24],e=a[24]-a[16],a[24]=e,e=a[20]-e,a[20]=e,e=a[28]-e,a[28]=e,e=a[25]-a[17],a[25]=e,e=a[21]-e,a[21]=e,e=a[29]-e,a[29]=e,e=a[17]-a[1],a[17]=e,e=a[9]-e,a[9]=e,e=a[25]-e,a[25]=e,e=a[5]-e,a[5]=e,e=a[21]-e,a[21]=e,e=a[13]-e,a[13]=e,e=a[29]-e,a[29]=e,e=a[1]-a[0],a[1]=e,e=a[16]-e,a[16]=e,e=a[17]-e,a[17]=e,e=a[8]-e,a[8]=e,e=a[9]-e,a[9]=e,e=a[24]-e,a[24]=e,e=a[25]-e,a[25]=e,e=a[4]-e,a[4]=e,e=a[5]-e,a[5]=e,e=a[20]-e,a[20]=e,e=a[21]-e,a[21]=e,e=a[12]-e,a[12]=e,e=a[13]-e,a[13]=e,e=a[28]-e,a[28]=e,e=a[29]-e,a[29]=e,e=a[0],a[0]+=a[31],a[31]-=e,e=a[1],a[1]+=a[30],a[30]-=e,e=a[16],a[16]+=a[15],a[15]-=e,e=a[17],a[17]+=a[14],a[14]-=e,e=a[8],a[8]+=a[23],a[23]-=e,e=a[9],a[9]+=a[22],a[22]-=e,e=a[24],a[24]+=a[7],a[7]-=e,e=a[25],a[25]+=a[6],a[6]-=e,e=a[4],a[4]+=a[27],a[27]-=e,e=a[5],a[5]+=a[26],a[26]-=e,e=a[20],a[20]+=a[11],a[11]-=e,e=a[21],a[21]+=a[10],a[10]-=e,e=a[12],a[12]+=a[19],a[19]-=e,e=a[13],a[13]+=a[18],a[18]-=e,e=a[28],a[28]+=a[3],a[3]-=e,e=a[29],a[29]+=a[2],a[2]-=e}}function C(s,y){for(var a=0;a<3;a++){var w,S,l,v,b,d;v=s[y+2*3]*L[r.SHORT_TYPE][0]-s[y+5*3],w=s[y+0*3]*L[r.SHORT_TYPE][2]-s[y+3*3],S=v+w,l=v-w,v=s[y+5*3]*L[r.SHORT_TYPE][0]+s[y+2*3],w=s[y+3*3]*L[r.SHORT_TYPE][2]+s[y+0*3],b=v+w,d=-v+w,w=(s[y+1*3]*L[r.SHORT_TYPE][1]-s[y+4*3])*2069978111953089e-26,v=(s[y+4*3]*L[r.SHORT_TYPE][1]+s[y+1*3])*2069978111953089e-26,s[y+3*0]=S*190752519173728e-25+w,s[y+3*5]=-b*190752519173728e-25+v,l=l*.8660254037844387*1907525191737281e-26,b=b*.5*1907525191737281e-26+v,s[y+3*1]=l-b,s[y+3*2]=l+b,S=S*.5*1907525191737281e-26-w,d=d*.8660254037844387*1907525191737281e-26,s[y+3*3]=S+d,s[y+3*4]=S-d,y++}}function N(s,y,a){var w,S;{var l,v,b,d,o,c,e,M;l=a[17]-a[9],b=a[15]-a[11],d=a[14]-a[12],o=a[0]+a[8],c=a[1]+a[7],e=a[2]+a[6],M=a[3]+a[5],s[y+17]=o+e-M-(c-a[4]),S=(o+e-M)*m[19]+(c-a[4]),w=(l-b-d)*m[18],s[y+5]=w+S,s[y+6]=w-S,v=(a[16]-a[10])*m[18],c=c*m[19]+a[4],w=l*m[12]+v+b*m[13]+d*m[14],S=-o*m[16]+c-e*m[17]+M*m[15],s[y+1]=w+S,s[y+2]=w-S,w=l*m[13]-v-b*m[14]+d*m[12],S=-o*m[17]+c-e*m[15]+M*m[16],s[y+9]=w+S,s[y+10]=w-S,w=l*m[14]-v+b*m[12]-d*m[13],S=o*m[15]-c+e*m[16]-M*m[17],s[y+13]=w+S,s[y+14]=w-S}{var h,g,_,i,u,p,k,t;h=a[8]-a[0],_=a[6]-a[2],i=a[5]-a[3],u=a[17]+a[9],p=a[16]+a[10],k=a[15]+a[11],t=a[14]+a[12],s[y+0]=u+k+t+(p+a[13]),w=(u+k+t)*m[19]-(p+a[13]),S=(h-_+i)*m[18],s[y+11]=w+S,s[y+12]=w-S,g=(a[7]-a[1])*m[18],p=a[13]-p*m[19],w=u*m[15]-p+k*m[16]+t*m[17],S=h*m[14]+g+_*m[12]+i*m[13],s[y+3]=w+S,s[y+4]=w-S,w=-u*m[17]+p-k*m[15]-t*m[16],S=h*m[13]+g-_*m[14]-i*m[12],s[y+7]=w+S,s[y+8]=w-S,w=-u*m[16]+p-k*m[17]-t*m[15],S=h*m[12]-g+_*m[13]-i*m[14],s[y+15]=w+S,s[y+16]=w-S}}this.mdct_sub48=function(s,y,a){for(var w=y,S=286,l=0;l<s.channels_out;l++){for(var v=0;v<s.mode_gr;v++){for(var b,d=s.l3_side.tt[v][l],o=d.xr,c=0,e=s.sb_sample[l][1-v],M=0,h=0;h<18/2;h++)for(e0(w,S,e[M]),e0(w,S+32,e[M+1]),M+=2,S+=64,b=1;b<32;b+=2)e[M-1][b]*=-1;for(b=0;b<32;b++,c+=18){var g=d.block_type,_=s.sb_sample[l][v],i=s.sb_sample[l][1-v];if(d.mixed_block_flag!=0&&b<2&&(g=0),s.amp_filter[b]<1e-12)T0.fill(o,c+0,c+18,0);else if(s.amp_filter[b]<1&&j(),g==r.SHORT_TYPE){for(var h=-12/4;h<0;h++){var u=L[r.SHORT_TYPE][h+3];o[c+h*3+9]=_[9+h][R[b]]*u-_[8-h][R[b]],o[c+h*3+18]=_[14-h][R[b]]*u+_[15+h][R[b]],o[c+h*3+10]=_[15+h][R[b]]*u-_[14-h][R[b]],o[c+h*3+19]=i[2-h][R[b]]*u+i[3+h][R[b]],o[c+h*3+11]=i[3+h][R[b]]*u-i[2-h][R[b]],o[c+h*3+20]=i[8-h][R[b]]*u+i[9+h][R[b]]}C(o,c)}else{for(var p=X(18),h=-36/4;h<0;h++){var k,t;k=L[g][h+27]*i[h+9][R[b]]+L[g][h+36]*i[8-h][R[b]],t=L[g][h+9]*_[h+9][R[b]]-L[g][h+18]*_[8-h][R[b]],p[h+9]=k-t*H[3+h+9],p[h+18]=k*H[3+h+9]+t}N(o,c,p)}if(g!=r.SHORT_TYPE&&b!=0)for(var h=7;h>=0;--h){var n,Y;n=o[c+h]*Q[20+h]+o[c+-1-h]*A[28+h],Y=o[c+h]*A[28+h]-o[c+-1-h]*Q[20+h],o[c+-1-h]=n,o[c+h]=Y}}}if(w=a,S=286,s.mode_gr==1)for(var E=0;E<18;E++)P.arraycopy(s.sb_sample[l][1][E],0,s.sb_sample[l][0][E],0,32)}}}function B(){this.thm=new i0,this.en=new i0}r.ENCDELAY=576,r.POSTDELAY=1152,r.MDCTDELAY=48,r.FFTOFFSET=224+r.MDCTDELAY,r.DECDELAY=528,r.SBLIMIT=32,r.CBANDS=64,r.SBPSY_l=21,r.SBPSY_s=12,r.SBMAX_l=22,r.SBMAX_s=13,r.PSFB21=6,r.PSFB12=6,r.BLKSIZE=1024,r.HBLKSIZE=r.BLKSIZE/2+1,r.BLKSIZE_s=256,r.HBLKSIZE_s=r.BLKSIZE_s/2+1,r.NORM_TYPE=0,r.START_TYPE=1,r.SHORT_TYPE=2,r.STOP_TYPE=3,r.MPG_MD_LR_LR=0,r.MPG_MD_LR_I=1,r.MPG_MD_MS_LR=2,r.MPG_MD_MS_I=3,r.fircoef=[-.0207887*5,-.0378413*5,-.0432472*5,-.031183*5,779609e-23*5,.0467745*5,.10091*5,.151365*5,.187098*5];function r(){var f=r.MPG_MD_MS_LR,L=null;this.psy=null;var H=null,m=null;this.setModules=function(C,N,s,y){L=C,this.psy=N,H=N,m=y};var Q=new x;function A(C){var N,s;if(C.ATH.useAdjust==0){C.ATH.adjust=1;return}if(s=C.loudness_sq[0][0],N=C.loudness_sq[1][0],C.channels_out==2?j():(s+=s,N+=N),C.mode_gr==2&&(s=Math.max(s,N)),s*=.5,s*=C.ATH.aaSensitivityP,s>.03125)C.ATH.adjust>=1?C.ATH.adjust=1:C.ATH.adjust<C.ATH.adjustLimit&&(C.ATH.adjust=C.ATH.adjustLimit),C.ATH.adjustLimit=1;else{var y=31.98*s+625e-6;C.ATH.adjust>=y?(C.ATH.adjust*=y*.075+.925,C.ATH.adjust<y&&(C.ATH.adjust=y)):C.ATH.adjustLimit>=y?C.ATH.adjust=y:C.ATH.adjust<C.ATH.adjustLimit&&(C.ATH.adjust=C.ATH.adjustLimit),C.ATH.adjustLimit=y}}function R(C){var N,s;for(C.bitrate_stereoMode_Hist[C.bitrate_index][4]++,C.bitrate_stereoMode_Hist[15][4]++,C.channels_out==2&&j(),N=0;N<C.mode_gr;++N)for(s=0;s<C.channels_out;++s){var y=C.l3_side.tt[N][s].block_type|0;C.l3_side.tt[N][s].mixed_block_flag!=0&&(y=4),C.bitrate_blockType_Hist[C.bitrate_index][y]++,C.bitrate_blockType_Hist[C.bitrate_index][5]++,C.bitrate_blockType_Hist[15][y]++,C.bitrate_blockType_Hist[15][5]++}}function e0(C,N){var s=C.internal_flags,y,a;if(s.lame_encode_frame_init==0){var w,S,l=X(2014),v=X(2014);for(s.lame_encode_frame_init=1,w=0,S=0;w<286+576*(1+s.mode_gr);++w)w<576*s.mode_gr?(l[w]=0,s.channels_out==2&&(v[w]=0)):(l[w]=N[0][S],s.channels_out==2&&(v[w]=N[1][S]),++S);for(a=0;a<s.mode_gr;a++)for(y=0;y<s.channels_out;y++)s.l3_side.tt[a][y].block_type=r.SHORT_TYPE;Q.mdct_sub48(s,l,v)}}this.lame_encode_mp3_frame=function(C,N,s,y,a,w){var S,l=d0([2,2]);l[0][0]=new B,l[0][1]=new B,l[1][0]=new B,l[1][1]=new B;var v=d0([2,2]);v[0][0]=new B,v[0][1]=new B,v[1][0]=new B,v[1][1]=new B;var b,d=[null,null],o=C.internal_flags,c=o0([2,4]),e=[.5,.5],M=[[0,0],[0,0]],h=[[0,0],[0,0]],g,_,i;if(d[0]=N,d[1]=s,o.lame_encode_frame_init==0&&e0(C,d),o.padding=0,(o.slot_lag-=o.frac_SpF)<0&&(o.slot_lag+=C.out_samplerate,o.padding=1),o.psymodel!=0){var u,p=[null,null],k=0,t=T(2);for(i=0;i<o.mode_gr;i++){for(_=0;_<o.channels_out;_++)p[_]=d[_],k=576+i*576-r.FFTOFFSET;if(C.VBR==U.vbr_mtrh||C.VBR==U.vbr_mt?j():u=H.L3psycho_anal_ns(C,p,k,i,l,v,M[i],h[i],c[i],t),u!=0)return-4;for(C.mode==I0.JOINT_STEREO&&j(),_=0;_<o.channels_out;_++){var n=o.l3_side.tt[i][_];n.block_type=t[_],n.mixed_block_flag=0}}}else j();if(A(o),Q.mdct_sub48(o,d[0],d[1]),o.mode_ext=r.MPG_MD_LR_LR,C.force_ms?o.mode_ext=r.MPG_MD_MS_LR:C.mode==I0.JOINT_STEREO&&j(),o.mode_ext==f?(b=v,g=h):(b=l,g=M),C.analysis&&o.pinfo!=null&&j(),C.VBR==U.vbr_off||C.VBR==U.vbr_abr){var Y,E;for(Y=0;Y<18;Y++)o.nsPsy.pefirbuf[Y]=o.nsPsy.pefirbuf[Y+1];for(E=0,i=0;i<o.mode_gr;i++)for(_=0;_<o.channels_out;_++)E+=g[i][_];for(o.nsPsy.pefirbuf[18]=E,E=o.nsPsy.pefirbuf[9],Y=0;Y<9;Y++)E+=(o.nsPsy.pefirbuf[Y]+o.nsPsy.pefirbuf[18-Y])*r.fircoef[Y];for(E=670*5*o.mode_gr*o.channels_out/E,i=0;i<o.mode_gr;i++)for(_=0;_<o.channels_out;_++)g[i][_]*=E}return o.iteration_loop.iteration_loop(C,g,e,b),L.format_bitstream(C),S=L.copy_buffer(o,y,a,w,1),C.bWriteVbrTag&&m.addVbrFrame(C),C.analysis&&o.pinfo!=null&&j(),R(o),S}}function O(){this.sum=0,this.seen=0,this.want=0,this.pos=0,this.size=0,this.bag=null,this.nVbrNumFrames=0,this.nBytesWritten=0,this.TotalFrameSize=0}function z(){this.tt=[[null,null],[null,null]],this.main_data_begin=0,this.private_bits=0,this.resvDrain_pre=0,this.resvDrain_post=0,this.scfsi=[T(4),T(4)];for(var f=0;f<2;f++)for(var L=0;L<2;L++)this.tt[f][L]=new ce}function i0(){this.l=X(r.SBMAX_l),this.s=o0([r.SBMAX_s,3]);var f=this;this.assign=function(L){P.arraycopy(L.l,0,f.l,0,r.SBMAX_l);for(var H=0;H<r.SBMAX_s;H++)for(var m=0;m<3;m++)f.s[H][m]=L.s[H][m]}}function a0(){this.last_en_subshort=o0([4,9]),this.lastAttacks=T(4),this.pefirbuf=X(19),this.longfact=X(r.SBMAX_l),this.shortfact=X(r.SBMAX_s),this.attackthre=0,this.attackthre_s=0}A0.MFSIZE=3*1152+r.ENCDELAY-r.MDCTDELAY,A0.MAX_HEADER_BUF=256,A0.MAX_BITS_PER_CHANNEL=4095,A0.MAX_BITS_PER_GRANULE=7680,A0.BPC=320;function A0(){var f=40;this.Class_ID=0,this.lame_encode_frame_init=0,this.iteration_init_init=0,this.fill_buffer_resample_init=0,this.mfbuf=o0([2,A0.MFSIZE]),this.mode_gr=0,this.channels_in=0,this.channels_out=0,this.resample_ratio=0,this.mf_samples_to_encode=0,this.mf_size=0,this.VBR_min_bitrate=0,this.VBR_max_bitrate=0,this.bitrate_index=0,this.samplerate_index=0,this.mode_ext=0,this.lowpass1=0,this.lowpass2=0,this.highpass1=0,this.highpass2=0,this.noise_shaping=0,this.noise_shaping_amp=0,this.substep_shaping=0,this.psymodel=0,this.noise_shaping_stop=0,this.subblock_gain=0,this.use_best_huffman=0,this.full_outer_loop=0,this.l3_side=new z,this.ms_ratio=X(2),this.padding=0,this.frac_SpF=0,this.slot_lag=0,this.tag_spec=null,this.nMusicCRC=0,this.OldValue=T(2),this.CurrentStep=T(2),this.masking_lower=0,this.bv_scf=T(576),this.pseudohalf=T(h0.SFBMAX),this.sfb21_extra=!1,this.inbuf_old=new Array(2),this.blackfilt=new Array(2*A0.BPC+1),this.itime=M0(2),this.sideinfo_len=0,this.sb_sample=o0([2,2,18,r.SBLIMIT]),this.amp_filter=X(32);function L(){this.write_timing=0,this.ptr=0,this.buf=s0(f)}this.header=new Array(A0.MAX_HEADER_BUF),this.h_ptr=0,this.w_ptr=0,this.ancillary_flag=0,this.ResvSize=0,this.ResvMax=0,this.scalefac_band=new ae,this.minval_l=X(r.CBANDS),this.minval_s=X(r.CBANDS),this.nb_1=o0([4,r.CBANDS]),this.nb_2=o0([4,r.CBANDS]),this.nb_s1=o0([4,r.CBANDS]),this.nb_s2=o0([4,r.CBANDS]),this.s3_ss=null,this.s3_ll=null,this.decay=0,this.thm=new Array(4),this.en=new Array(4),this.tot_ener=X(4),this.loudness_sq=o0([2,2]),this.loudness_sq_save=X(2),this.mld_l=X(r.SBMAX_l),this.mld_s=X(r.SBMAX_s),this.bm_l=T(r.SBMAX_l),this.bo_l=T(r.SBMAX_l),this.bm_s=T(r.SBMAX_s),this.bo_s=T(r.SBMAX_s),this.npart_l=0,this.npart_s=0,this.s3ind=C0([r.CBANDS,2]),this.s3ind_s=C0([r.CBANDS,2]),this.numlines_s=T(r.CBANDS),this.numlines_l=T(r.CBANDS),this.rnumlines_l=X(r.CBANDS),this.mld_cb_l=X(r.CBANDS),this.mld_cb_s=X(r.CBANDS),this.numlines_s_num1=0,this.numlines_l_num1=0,this.pe=X(4),this.ms_ratio_s_old=0,this.ms_ratio_l_old=0,this.ms_ener_ratio_old=0,this.blocktype_old=T(2),this.nsPsy=new a0,this.VBR_seek_table=new O,this.ATH=null,this.PSY=null,this.nogap_total=0,this.nogap_current=0,this.decode_on_the_fly=!0,this.findReplayGain=!0,this.findPeakSample=!0,this.PeakSample=0,this.RadioGain=0,this.AudiophileGain=0,this.rgdata=null,this.noclipGainChange=0,this.noclipScale=0,this.bitrate_stereoMode_Hist=C0([16,5]),this.bitrate_blockType_Hist=C0([16,6]),this.pinfo=null,this.hip=null,this.in_buffer_nsamples=0,this.in_buffer_0=null,this.in_buffer_1=null,this.iteration_loop=null;for(var H=0;H<this.en.length;H++)this.en[H]=new i0;for(var H=0;H<this.thm.length;H++)this.thm[H]=new i0;for(var H=0;H<this.header.length;H++)this.header[H]=new L}function B0(){var f=X(r.BLKSIZE),L=X(r.BLKSIZE_s/2),H=[.9238795325112867,.3826834323650898,.9951847266721969,.0980171403295606,.9996988186962042,.02454122852291229,.9999811752826011,.006135884649154475];function m(A,R,e0){var C=0,N,s,y;e0<<=1;var a=R+e0;N=4;do{var w,S,l,v,b,d,o;o=N>>1,v=N,b=N<<1,d=b+v,N=b<<1,s=R,y=s+o;do{var c,e,M,h;e=A[s+0]-A[s+v],c=A[s+0]+A[s+v],h=A[s+b]-A[s+d],M=A[s+b]+A[s+d],A[s+b]=c-M,A[s+0]=c+M,A[s+d]=e-h,A[s+v]=e+h,e=A[y+0]-A[y+v],c=A[y+0]+A[y+v],h=W.SQRT2*A[y+d],M=W.SQRT2*A[y+b],A[y+b]=c-M,A[y+0]=c+M,A[y+d]=e-h,A[y+v]=e+h,y+=N,s+=N}while(s<a);for(S=H[C+0],w=H[C+1],l=1;l<o;l++){var g,_;g=1-2*w*w,_=2*w*S,s=R+l,y=R+v-l;do{var i,u,p,c,e,k,M,t,h,n;u=_*A[s+v]-g*A[y+v],i=g*A[s+v]+_*A[y+v],e=A[s+0]-i,c=A[s+0]+i,k=A[y+0]-u,p=A[y+0]+u,u=_*A[s+d]-g*A[y+d],i=g*A[s+d]+_*A[y+d],h=A[s+b]-i,M=A[s+b]+i,n=A[y+b]-u,t=A[y+b]+u,u=w*M-S*n,i=S*M+w*n,A[s+b]=c-i,A[s+0]=c+i,A[y+d]=k-u,A[y+v]=k+u,u=S*t-w*h,i=w*t+S*h,A[y+b]=p-i,A[y+0]=p+i,A[s+d]=e-u,A[s+v]=e+u,y+=N,s+=N}while(s<a);g=S,S=g*H[C+0]-w*H[C+1],w=g*H[C+1]+w*H[C+0]}C+=2}while(N<e0)}var Q=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254];this.fft_short=function(A,R,e0,C,N){for(var s=0;s<3;s++){var y=r.BLKSIZE_s/2,a=65535&576/3*(s+1),w=r.BLKSIZE_s/8-1;do{var S,l,v,b,d,o=Q[w<<2]&255;S=L[o]*C[e0][N+o+a],d=L[127-o]*C[e0][N+o+a+128],l=S-d,S=S+d,v=L[o+64]*C[e0][N+o+a+64],d=L[63-o]*C[e0][N+o+a+192],b=v-d,v=v+d,y-=4,R[s][y+0]=S+v,R[s][y+2]=S-v,R[s][y+1]=l+b,R[s][y+3]=l-b,S=L[o+1]*C[e0][N+o+a+1],d=L[126-o]*C[e0][N+o+a+129],l=S-d,S=S+d,v=L[o+65]*C[e0][N+o+a+65],d=L[62-o]*C[e0][N+o+a+193],b=v-d,v=v+d,R[s][y+r.BLKSIZE_s/2+0]=S+v,R[s][y+r.BLKSIZE_s/2+2]=S-v,R[s][y+r.BLKSIZE_s/2+1]=l+b,R[s][y+r.BLKSIZE_s/2+3]=l-b}while(--w>=0);m(R[s],y,r.BLKSIZE_s/2)}},this.fft_long=function(A,R,e0,C,N){var s=r.BLKSIZE/8-1,y=r.BLKSIZE/2;do{var a,w,S,l,v,b=Q[s]&255;a=f[b]*C[e0][N+b],v=f[b+512]*C[e0][N+b+512],w=a-v,a=a+v,S=f[b+256]*C[e0][N+b+256],v=f[b+768]*C[e0][N+b+768],l=S-v,S=S+v,y-=4,R[y+0]=a+S,R[y+2]=a-S,R[y+1]=w+l,R[y+3]=w-l,a=f[b+1]*C[e0][N+b+1],v=f[b+513]*C[e0][N+b+513],w=a-v,a=a+v,S=f[b+257]*C[e0][N+b+257],v=f[b+769]*C[e0][N+b+769],l=S-v,S=S+v,R[y+r.BLKSIZE/2+0]=a+S,R[y+r.BLKSIZE/2+2]=a-S,R[y+r.BLKSIZE/2+1]=w+l,R[y+r.BLKSIZE/2+3]=w-l}while(--s>=0);m(R,y,r.BLKSIZE/2)},this.init_fft=function(A){for(var R=0;R<r.BLKSIZE;R++)f[R]=.42-.5*Math.cos(2*Math.PI*(R+.5)/r.BLKSIZE)+.08*Math.cos(4*Math.PI*(R+.5)/r.BLKSIZE);for(var R=0;R<r.BLKSIZE_s/2;R++)L[R]=.5*(1-Math.cos(2*Math.PI*(R+.5)/r.BLKSIZE_s))}}function R0(){var f=new B0,L=2.302585092994046,H=2,m=16,Q=2,A=16,R=.34,e0=1/(14752*14752)/(r.BLKSIZE/2),C=.01,N=.8,s=.6,y=.3,a=3.5,w=21,S=.2302585093;function l(q,I){for(var F=0,b0=0;b0<r.BLKSIZE/2;++b0)F+=q[b0]*I.ATH.eql_w[b0];return F*=e0,F}function v(q,I,F,b0,v0,Z,u0,f0,p0,Y0,w0){var se=q.internal_flags;p0<2?(f.fft_long(se,b0[v0],p0,Y0,w0),f.fft_short(se,Z[u0],p0,Y0,w0)):p0==2&&j(),I[0]=b0[v0+0][0],I[0]*=I[0];for(var K0=r.BLKSIZE/2-1;K0>=0;--K0){var te=b0[v0+0][r.BLKSIZE/2-K0],oe=b0[v0+0][r.BLKSIZE/2+K0];I[r.BLKSIZE/2-K0]=(te*te+oe*oe)*.5}for(var Z0=2;Z0>=0;--Z0){F[Z0][0]=Z[u0+0][Z0][0],F[Z0][0]*=F[Z0][0];for(var K0=r.BLKSIZE_s/2-1;K0>=0;--K0){var te=Z[u0+0][Z0][r.BLKSIZE_s/2-K0],oe=Z[u0+0][Z0][r.BLKSIZE_s/2+K0];F[Z0][r.BLKSIZE_s/2-K0]=(te*te+oe*oe)*.5}}{for(var X0=0,K0=11;K0<r.HBLKSIZE;K0++)X0+=I[K0];se.tot_ener[p0]=X0}q.analysis&&j(),q.athaa_loudapprox==2&&p0<2&&(se.loudness_sq[f0][p0]=se.loudness_sq_save[p0],se.loudness_sq_save[p0]=l(I,se))}var b=8,d=23,o=15,c,e,M,h=[1,.79433,.63096,.63096,.63096,.63096,.63096,.25119,.11749];function g(){c=Math.pow(10,(b+1)/16),e=Math.pow(10,(d+1)/16),M=Math.pow(10,o/10)}var _=[3.3246*3.3246,3.23837*3.23837,3.15437*3.15437,3.00412*3.00412,2.86103*2.86103,2.65407*2.65407,2.46209*2.46209,2.284*2.284,2.11879*2.11879,1.96552*1.96552,1.82335*1.82335,1.69146*1.69146,1.56911*1.56911,1.46658*1.46658,1.37074*1.37074,1.31036*1.31036,1.25264*1.25264,1.20648*1.20648,1.16203*1.16203,1.12765*1.12765,1.09428*1.09428,1.0659*1.0659,1.03826*1.03826,1.01895*1.01895,1],i=[1.33352*1.33352,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.30382*1.30382,1.22321*1.22321,1.14758*1.14758,1],u=[2.35364*2.35364,2.29259*2.29259,2.23313*2.23313,2.12675*2.12675,2.02545*2.02545,1.87894*1.87894,1.74303*1.74303,1.61695*1.61695,1.49999*1.49999,1.39148*1.39148,1.29083*1.29083,1.19746*1.19746,1.11084*1.11084,1.03826*1.03826];function p(q,I,F,b0,v0,Z){var u0;if(I>q)if(I<q*e)u0=I/q;else return q+I;else{if(q>=I*e)return q+I;u0=q/I}if(q+=I,b0+3<=6){if(u0>=c)return q;var f0=0|W.FAST_LOG10_X(u0,16);return q*i[f0]}var f0=0|W.FAST_LOG10_X(u0,16);if(I=v0.ATH.cb_l[F]*v0.ATH.adjust,q<M*I){if(q>I){var p0,Y0;return p0=1,f0<=13&&(p0=u[f0]),Y0=W.FAST_LOG10_X(q/I,10/15),q*((_[f0]-p0)*Y0+p0)}return f0>13?q:q*u[f0]}return q*_[f0]}function k(q,I,F,b0,v0){var Z,u0,f0=0,p0=0;for(Z=u0=0;Z<r.SBMAX_s;++u0,++Z){for(var Y0=q.bo_s[Z],w0=q.npart_s,se=Y0<w0?Y0:w0;u0<se;)f0+=I[u0],p0+=F[u0],u0++;if(q.en[b0].s[Z][v0]=f0,q.thm[b0].s[Z][v0]=p0,u0>=w0){++Z;break}{var K0=q.PSY.bo_s_weight[Z],te=1-K0;f0=K0*I[u0],p0=K0*F[u0],q.en[b0].s[Z][v0]+=f0,q.thm[b0].s[Z][v0]+=p0,f0=te*I[u0],p0=te*F[u0]}}for(;Z<r.SBMAX_s;++Z)q.en[b0].s[Z][v0]=0,q.thm[b0].s[Z][v0]=0}function t(q,I,F,b0){var v0,Z,u0=0,f0=0;for(v0=Z=0;v0<r.SBMAX_l;++Z,++v0){for(var p0=q.bo_l[v0],Y0=q.npart_l,w0=p0<Y0?p0:Y0;Z<w0;)u0+=I[Z],f0+=F[Z],Z++;if(q.en[b0].l[v0]=u0,q.thm[b0].l[v0]=f0,Z>=Y0){++v0;break}{var se=q.PSY.bo_l_weight[v0],K0=1-se;u0=se*I[Z],f0=se*F[Z],q.en[b0].l[v0]+=u0,q.thm[b0].l[v0]+=f0,u0=K0*I[Z],f0=K0*F[Z]}}for(;v0<r.SBMAX_l;++v0)q.en[b0].l[v0]=0,q.thm[b0].l[v0]=0}function n(q,I,F,b0,v0,Z){var u0=q.internal_flags,f0,p0;for(p0=f0=0;p0<u0.npart_s;++p0){for(var Y0=0,w0=u0.numlines_s[p0],se=0;se<w0;++se,++f0){var K0=I[Z][f0];Y0+=K0}F[p0]=Y0}for(f0=p0=0;p0<u0.npart_s;p0++){var te=u0.s3ind_s[p0][0],oe=u0.s3_ss[f0++]*F[te];for(++te;te<=u0.s3ind_s[p0][1];)oe+=u0.s3_ss[f0]*F[te],++f0,++te;{var Z0=Q*u0.nb_s1[v0][p0];b0[p0]=Math.min(oe,Z0)}if(u0.blocktype_old[v0&1]==r.SHORT_TYPE){var Z0=A*u0.nb_s2[v0][p0],X0=b0[p0];b0[p0]=Math.min(Z0,X0)}u0.nb_s2[v0][p0]=u0.nb_s1[v0][p0],u0.nb_s1[v0][p0]=oe}for(;p0<=r.CBANDS;++p0)F[p0]=0,b0[p0]=0}function Y(q,I,F,b0){var v0=q.internal_flags;q.short_blocks==c0.short_block_coupled&&!(I[0]!=0&&I[1]!=0)&&(I[0]=I[1]=0);for(var Z=0;Z<v0.channels_out;Z++)b0[Z]=r.NORM_TYPE,q.short_blocks==c0.short_block_dispensed&&(I[Z]=1),q.short_blocks==c0.short_block_forced&&(I[Z]=0),I[Z]!=0?v0.blocktype_old[Z]==r.SHORT_TYPE&&(b0[Z]=r.STOP_TYPE):(b0[Z]=r.SHORT_TYPE,v0.blocktype_old[Z]==r.NORM_TYPE&&(v0.blocktype_old[Z]=r.START_TYPE),v0.blocktype_old[Z]==r.STOP_TYPE&&(v0.blocktype_old[Z]=r.SHORT_TYPE)),F[Z]=v0.blocktype_old[Z],v0.blocktype_old[Z]=b0[Z]}function E(q,I,F){return F>=1?q:F<=0?I:I>0?Math.pow(q/I,F)*I:0}var V=[11.8,13.6,17.2,32,46.5,51.3,57.5,67.1,71.5,84.6,97.6,130];function J(q,I){for(var F=309.07,b0=0;b0<r.SBMAX_s-1;b0++)for(var v0=0;v0<3;v0++){var Z=q.thm.s[b0][v0];if(Z>0){var u0=Z*I,f0=q.en.s[b0][v0];f0>u0&&(f0>u0*1e10?F+=V[b0]*(10*L):F+=V[b0]*W.FAST_LOG10(f0/u0))}}return F}var t0=[6.8,5.8,5.8,6.4,6.5,9.9,12.1,14.4,15,18.9,21.6,26.9,34.2,40.2,46.8,56.5,60.7,73.9,85.7,93.4,126.1];function l0(q,I){for(var F=281.0575,b0=0;b0<r.SBMAX_l-1;b0++){var v0=q.thm.l[b0];if(v0>0){var Z=v0*I,u0=q.en.l[b0];u0>Z&&(u0>Z*1e10?F+=t0[b0]*(10*L):F+=t0[b0]*W.FAST_LOG10(u0/Z))}}return F}function k0(q,I,F,b0,v0){var Z,u0;for(Z=u0=0;Z<q.npart_l;++Z){var f0=0,p0=0,Y0;for(Y0=0;Y0<q.numlines_l[Z];++Y0,++u0){var w0=I[u0];f0+=w0,p0<w0&&(p0=w0)}F[Z]=f0,b0[Z]=p0,v0[Z]=f0*q.rnumlines_l[Z]}}function P0(q,I,F,b0){var v0=h.length-1,Z=0,u0=F[Z]+F[Z+1];if(u0>0){var f0=I[Z];f0<I[Z+1]&&(f0=I[Z+1]),u0=20*(f0*2-u0)/(u0*(q.numlines_l[Z]+q.numlines_l[Z+1]-1));var p0=0|u0;p0>v0&&(p0=v0),b0[Z]=p0}else b0[Z]=0;for(Z=1;Z<q.npart_l-1;Z++)if(u0=F[Z-1]+F[Z]+F[Z+1],u0>0){var f0=I[Z-1];f0<I[Z]&&(f0=I[Z]),f0<I[Z+1]&&(f0=I[Z+1]),u0=20*(f0*3-u0)/(u0*(q.numlines_l[Z-1]+q.numlines_l[Z]+q.numlines_l[Z+1]-1));var p0=0|u0;p0>v0&&(p0=v0),b0[Z]=p0}else b0[Z]=0;if(u0=F[Z-1]+F[Z],u0>0){var f0=I[Z-1];f0<I[Z]&&(f0=I[Z]),u0=20*(f0*2-u0)/(u0*(q.numlines_l[Z-1]+q.numlines_l[Z]-1));var p0=0|u0;p0>v0&&(p0=v0),b0[Z]=p0}else b0[Z]=0}var F0=[-865163e-23*2,-.00851586*2,-674764e-23*2,.0209036*2,-336639e-22*2,-.0438162*2,-154175e-22*2,.0931738*2,-552212e-22*2,-.313819*2];this.L3psycho_anal_ns=function(q,I,F,b0,v0,Z,u0,f0,p0,Y0){var w0=q.internal_flags,se=o0([2,r.BLKSIZE]),K0=o0([2,3,r.BLKSIZE_s]),te=X(r.CBANDS+1),oe=X(r.CBANDS+1),Z0=X(r.CBANDS+2),X0=T(2),$0=T(2),be,E0,G0,N0,ie,ke,xe,J0,Xe=o0([2,576]),Te,Ie=T(r.CBANDS+2),Oe=T(r.CBANDS+2);for(T0.fill(Oe,0),be=w0.channels_out,q.mode==I0.JOINT_STEREO&&(be=4),q.VBR==U.vbr_off?Te=w0.ResvMax==0?0:w0.ResvSize/w0.ResvMax*.5:q.VBR==U.vbr_rh||q.VBR==U.vbr_mtrh||q.VBR==U.vbr_mt?Te=.6:Te=1,E0=0;E0<w0.channels_out;E0++){var He=I[E0],Fe=F+576-350-w+192;for(N0=0;N0<576;N0++){var je,Ge;for(je=He[Fe+N0+10],Ge=0,ie=0;ie<(w-1)/2-1;ie+=2)je+=F0[ie]*(He[Fe+N0+ie]+He[Fe+N0+w-ie]),Ge+=F0[ie+1]*(He[Fe+N0+ie+1]+He[Fe+N0+w-ie-1]);Xe[E0][N0]=je+Ge}v0[b0][E0].en.assign(w0.en[E0]),v0[b0][E0].thm.assign(w0.thm[E0]),be>2&&j()}for(E0=0;E0<be;E0++){var s1,i1,ye=X(12),Le=[0,0,0,0],Ue=X(12),l1=1,o1,_1=X(r.CBANDS),u1=X(r.CBANDS),fe=[0,0,0,0],f1=X(r.HBLKSIZE),v1=o0([3,r.HBLKSIZE_s]);for(N0=0;N0<3;N0++)ye[N0]=w0.nsPsy.last_en_subshort[E0][N0+6],Ue[N0]=ye[N0]/w0.nsPsy.last_en_subshort[E0][N0+4],Le[0]+=ye[N0];E0==2&&j();{var c1=Xe[E0&1],Ne=0;for(N0=0;N0<9;N0++){for(var x1=Ne+64,de=1;Ne<x1;Ne++)de<Math.abs(c1[Ne])&&(de=Math.abs(c1[Ne]));w0.nsPsy.last_en_subshort[E0][N0]=ye[N0+3]=de,Le[1+N0/3]+=de,de>ye[N0+3-2]?de=de/ye[N0+3-2]:ye[N0+3-2]>de*10?de=ye[N0+3-2]/(de*10):de=0,Ue[N0+3]=de}}for(q.analysis&&j(),o1=E0==3?w0.nsPsy.attackthre_s:w0.nsPsy.attackthre,N0=0;N0<12;N0++)fe[N0/3]==0&&Ue[N0]>o1&&(fe[N0/3]=N0%3+1);for(N0=1;N0<4;N0++){var ze;Le[N0-1]>Le[N0]?ze=Le[N0-1]/Le[N0]:ze=Le[N0]/Le[N0-1],ze<1.7&&(fe[N0]=0,N0==1&&(fe[0]=0))}for(fe[0]!=0&&w0.nsPsy.lastAttacks[E0]!=0&&(fe[0]=0),(w0.nsPsy.lastAttacks[E0]==3||fe[0]+fe[1]+fe[2]+fe[3]!=0)&&(l1=0,fe[1]!=0&&fe[0]!=0&&(fe[1]=0),fe[2]!=0&&fe[1]!=0&&(fe[2]=0),fe[3]!=0&&fe[2]!=0&&(fe[3]=0)),E0<2?$0[E0]=l1:j(),p0[E0]=w0.tot_ener[E0],i1=K0,s1=se,v(q,f1,v1,s1,E0&1,i1,E0&1,b0,E0,I,F),k0(w0,f1,te,_1,u1),P0(w0,_1,u1,Ie),J0=0;J0<3;J0++){var We,we;for(n(q,v1,oe,Z0,E0,J0),k(w0,oe,Z0,E0,J0),xe=0;xe<r.SBMAX_s;xe++){if(we=w0.thm[E0].s[xe][J0],we*=N,fe[J0]>=2||fe[J0+1]==1){var Ve=J0!=0?J0-1:2,de=E(w0.thm[E0].s[xe][Ve],we,s*Te);we=Math.min(we,de)}if(fe[J0]==1){var Ve=J0!=0?J0-1:2,de=E(w0.thm[E0].s[xe][Ve],we,y*Te);we=Math.min(we,de)}else if(J0!=0&&fe[J0-1]==3||J0==0&&w0.nsPsy.lastAttacks[E0]==3){var Ve=J0!=2?J0+1:0,de=E(w0.thm[E0].s[xe][Ve],we,y*Te);we=Math.min(we,de)}We=ye[J0*3+3]+ye[J0*3+4]+ye[J0*3+5],ye[J0*3+5]*6<We&&(we*=.5,ye[J0*3+4]*6<We&&(we*=.5)),w0.thm[E0].s[xe][J0]=we}}for(w0.nsPsy.lastAttacks[E0]=fe[2],ke=0,G0=0;G0<w0.npart_l;G0++){for(var De=w0.s3ind[G0][0],Ke=te[De]*h[Ie[De]],ge=w0.s3_ll[ke++]*Ke;++De<=w0.s3ind[G0][1];)Ke=te[De]*h[Ie[De]],ge=p(ge,w0.s3_ll[ke++]*Ke,De,De-G0,w0);ge*=.158489319246111,w0.blocktype_old[E0&1]==r.SHORT_TYPE?Z0[G0]=ge:Z0[G0]=E(Math.min(ge,Math.min(H*w0.nb_1[E0][G0],m*w0.nb_2[E0][G0])),ge,Te),w0.nb_2[E0][G0]=w0.nb_1[E0][G0],w0.nb_1[E0][G0]=ge}for(;G0<=r.CBANDS;++G0)te[G0]=0,Z0[G0]=0;t(w0,te,Z0,E0)}for((q.mode==I0.STEREO||q.mode==I0.JOINT_STEREO)&&j(),q.mode==I0.JOINT_STEREO&&j(),Y(q,$0,Y0,X0),E0=0;E0<be;E0++){var Ye,qe=0,h1,Ze;E0>1?j():(Ye=u0,qe=0,h1=Y0[E0],Ze=v0[b0][E0]),h1==r.SHORT_TYPE?Ye[qe+E0]=J(Ze,w0.masking_lower):Ye[qe+E0]=l0(Ze,w0.masking_lower),q.analysis&&(w0.pinfo.pe[b0][E0]=Ye[qe+E0])}return 0};function _e(q){var I,F,b0,v0;return I=q,I>=0?I*=3:I*=1.5,I>=.5&&I<=2.5?(v0=I-.5,F=8*(v0*v0-2*v0)):F=0,I+=.474,b0=15.811389+7.5*I-17.5*Math.sqrt(1+I*I),b0<=-60?0:(I=Math.exp((F+b0)*S),I/=.6609193,I)}function ue(q){return q<0&&(q=0),q=q*.001,13*Math.atan(.76*q)+3.5*Math.atan(q*q/(7.5*7.5))}function ne(q,I,F,b0,v0,Z,u0,f0,p0,Y0,w0,se){var K0=X(r.CBANDS+1),te=f0/(se>15?2*576:2*192),oe=T(r.HBLKSIZE),Z0;f0/=p0;var X0=0,$0=0;for(Z0=0;Z0<r.CBANDS;Z0++){var be,E0;for(be=ue(f0*X0),K0[Z0]=f0*X0,E0=X0;ue(f0*E0)-be<R&&E0<=p0/2;E0++);for(q[Z0]=E0-X0,$0=Z0+1;X0<E0;)oe[X0++]=Z0;if(X0>p0/2){X0=p0/2,++Z0;break}}K0[Z0]=f0*X0;for(var G0=0;G0<se;G0++){var N0,ie,ke,xe,J0;ke=Y0[G0],xe=Y0[G0+1],N0=0|Math.floor(.5+w0*(ke-.5)),N0<0&&(N0=0),ie=0|Math.floor(.5+w0*(xe-.5)),ie>p0/2&&(ie=p0/2),F[G0]=(oe[N0]+oe[ie])/2,I[G0]=oe[ie];var Xe=te*xe;u0[G0]=(Xe-K0[I[G0]])/(K0[I[G0]+1]-K0[I[G0]]),u0[G0]<0?u0[G0]=0:u0[G0]>1&&(u0[G0]=1),J0=ue(f0*Y0[G0]*w0),J0=Math.min(J0,15.5)/15.5,Z[G0]=Math.pow(10,1.25*(1-Math.cos(Math.PI*J0))-2.5)}X0=0;for(var Te=0;Te<$0;Te++){var Ie=q[Te],be,Oe;be=ue(f0*X0),Oe=ue(f0*(X0+Ie-1)),b0[Te]=.5*(be+Oe),be=ue(f0*(X0-.5)),Oe=ue(f0*(X0+Ie-.5)),v0[Te]=Oe-be,X0+=Ie}return $0}function le(q,I,F,b0,v0,Z){var u0=o0([r.CBANDS,r.CBANDS]),f0,p0=0;if(Z)for(var Y0=0;Y0<I;Y0++)for(f0=0;f0<I;f0++){var w0=_e(F[Y0]-F[f0])*b0[f0];u0[Y0][f0]=w0*v0[Y0]}else j();for(var Y0=0;Y0<I;Y0++){for(f0=0;f0<I&&!(u0[Y0][f0]>0);f0++);for(q[Y0][0]=f0,f0=I-1;f0>0&&!(u0[Y0][f0]>0);f0--);q[Y0][1]=f0,p0+=q[Y0][1]-q[Y0][0]+1}for(var se=X(p0),K0=0,Y0=0;Y0<I;Y0++)for(f0=q[Y0][0];f0<=q[Y0][1];f0++)se[K0++]=u0[Y0][f0];return se}function he(q){var I=ue(q);return I=Math.min(I,15.5)/15.5,Math.pow(10,1.25*(1-Math.cos(Math.PI*I))-2.5)}this.psymodel_init=function(q){var I=q.internal_flags,F,b0=!0,v0=13,Z=24,u0=0,f0=0,p0=-8.25,Y0=-4.5,w0=X(r.CBANDS),se=X(r.CBANDS),K0=X(r.CBANDS),te=q.out_samplerate;switch(q.experimentalZ){default:case 0:b0=!0;break;case 1:b0=!(q.VBR==U.vbr_mtrh||q.VBR==U.vbr_mt);break;case 2:b0=!1;break;case 3:v0=8,u0=-1.75,f0=-.0125,p0=-8.25,Y0=-2.25;break}for(I.ms_ener_ratio_old=.25,I.blocktype_old[0]=I.blocktype_old[1]=r.NORM_TYPE,F=0;F<4;++F){for(var X0=0;X0<r.CBANDS;++X0)I.nb_1[F][X0]=1e20,I.nb_2[F][X0]=1e20,I.nb_s1[F][X0]=I.nb_s2[F][X0]=1;for(var oe=0;oe<r.SBMAX_l;oe++)I.en[F].l[oe]=1e20,I.thm[F].l[oe]=1e20;for(var X0=0;X0<3;++X0){for(var oe=0;oe<r.SBMAX_s;oe++)I.en[F].s[oe][X0]=1e20,I.thm[F].s[oe][X0]=1e20;I.nsPsy.lastAttacks[F]=0}for(var X0=0;X0<9;X0++)I.nsPsy.last_en_subshort[F][X0]=10}for(I.loudness_sq_save[0]=I.loudness_sq_save[1]=0,I.npart_l=ne(I.numlines_l,I.bo_l,I.bm_l,w0,se,I.mld_l,I.PSY.bo_l_weight,te,r.BLKSIZE,I.scalefac_band.l,r.BLKSIZE/(2*576),r.SBMAX_l),F=0;F<I.npart_l;F++){var Z0=u0;w0[F]>=v0&&(Z0=f0*(w0[F]-v0)/(Z-v0)+u0*(Z-w0[F])/(Z-v0)),K0[F]=Math.pow(10,Z0/10),I.numlines_l[F]>0?I.rnumlines_l[F]=1/I.numlines_l[F]:I.rnumlines_l[F]=0}I.s3_ll=le(I.s3ind,I.npart_l,w0,se,K0,b0);var X0=0;for(F=0;F<I.npart_l;F++){var $0;$0=L0.MAX_VALUE;for(var be=0;be<I.numlines_l[F];be++,X0++){var E0=te*X0/(1e3*r.BLKSIZE),G0;G0=this.ATHformula(E0*1e3,q)-20,G0=Math.pow(10,.1*G0),G0*=I.numlines_l[F],$0>G0&&($0=G0)}I.ATH.cb_l[F]=$0,$0=-20+w0[F]*20/10,$0>6&&($0=100),$0<-15&&($0=-15),$0-=8,I.minval_l[F]=Math.pow(10,$0/10)*I.numlines_l[F]}for(I.npart_s=ne(I.numlines_s,I.bo_s,I.bm_s,w0,se,I.mld_s,I.PSY.bo_s_weight,te,r.BLKSIZE_s,I.scalefac_band.s,r.BLKSIZE_s/(2*192),r.SBMAX_s),X0=0,F=0;F<I.npart_s;F++){var $0,Z0=p0;w0[F]>=v0&&(Z0=Y0*(w0[F]-v0)/(Z-v0)+p0*(Z-w0[F])/(Z-v0)),K0[F]=Math.pow(10,Z0/10),$0=L0.MAX_VALUE;for(var be=0;be<I.numlines_s[F];be++,X0++){var E0=te*X0/(1e3*r.BLKSIZE_s),G0;G0=this.ATHformula(E0*1e3,q)-20,G0=Math.pow(10,.1*G0),G0*=I.numlines_s[F],$0>G0&&($0=G0)}I.ATH.cb_s[F]=$0,$0=-7+w0[F]*7/12,w0[F]>12&&($0*=1+Math.log(1+$0)*3.1),w0[F]<12&&($0*=1+Math.log(1-$0)*2.3),$0<-15&&($0=-15),$0-=8,I.minval_s[F]=Math.pow(10,$0/10)*I.numlines_s[F]}I.s3_ss=le(I.s3ind_s,I.npart_s,w0,se,K0,b0),g(),f.init_fft(I),I.decay=Math.exp(-1*L/(C*te/192));{var N0;N0=a,(q.exp_nspsytune&2)!=0&&(N0=1),Math.abs(q.msfix)>0&&(N0=q.msfix),q.msfix=N0;for(var ie=0;ie<I.npart_l;ie++)I.s3ind[ie][1]>I.npart_l-1&&(I.s3ind[ie][1]=I.npart_l-1)}var ke=576*I.mode_gr/te;if(I.ATH.decay=Math.pow(10,-12/10*ke),I.ATH.adjust=.01,I.ATH.adjustLimit=1,q.ATHtype!=-1){var E0,xe=q.out_samplerate/r.BLKSIZE,J0=0;for(E0=0,F=0;F<r.BLKSIZE/2;++F)E0+=xe,I.ATH.eql_w[F]=1/Math.pow(10,this.ATHformula(E0,q)/10),J0+=I.ATH.eql_w[F];for(J0=1/J0,F=r.BLKSIZE/2;--F>=0;)I.ATH.eql_w[F]*=J0}{for(var ie=X0=0;ie<I.npart_s;++ie)for(F=0;F<I.numlines_s[ie];++F)++X0;for(var ie=X0=0;ie<I.npart_l;++ie)for(F=0;F<I.numlines_l[ie];++F)++X0}for(X0=0,F=0;F<I.npart_l;F++){var E0=te*(X0+I.numlines_l[F]/2)/(1*r.BLKSIZE);I.mld_cb_l[F]=he(E0),X0+=I.numlines_l[F]}for(;F<r.CBANDS;++F)I.mld_cb_l[F]=1;for(X0=0,F=0;F<I.npart_s;F++){var E0=te*(X0+I.numlines_s[F]/2)/(1*r.BLKSIZE_s);I.mld_cb_s[F]=he(E0),X0+=I.numlines_s[F]}for(;F<r.CBANDS;++F)I.mld_cb_s[F]=1;return 0};function Ee(q,I){q<-.3&&(q=3410),q/=1e3,q=Math.max(.1,q);var F=3.64*Math.pow(q,-.8)-6.8*Math.exp(-.6*Math.pow(q-3.4,2))+6*Math.exp(-.15*Math.pow(q-8.7,2))+(.6+.04*I)*.001*Math.pow(q,4);return F}this.ATHformula=function(q,I){var F;switch(I.ATHtype){case 0:F=Ee(q,9);break;case 1:F=Ee(q,-1);break;case 2:F=Ee(q,0);break;case 3:F=Ee(q,1)+6;break;case 4:F=Ee(q,I.ATHcurve);break;default:F=Ee(q,0);break}return F}}function m0(){var f=this,L=128*1024;m0.V9=410,m0.V8=420,m0.V7=430,m0.V6=440,m0.V5=450,m0.V4=460,m0.V3=470,m0.V2=480,m0.V1=490,m0.V0=500,m0.R3MIX=1e3,m0.STANDARD=1001,m0.EXTREME=1002,m0.INSANE=1003,m0.STANDARD_FAST=1004,m0.EXTREME_FAST=1005,m0.MEDIUM=1006,m0.MEDIUM_FAST=1007;var H=16384+L;m0.LAME_MAXMP3BUFFER=H;var m,Q,A,R,e0,C=new R0,N,s;this.enc=new r,this.setModules=function(t,n,Y,E,V,J,t0,l0,k0){m=t,Q=n,A=Y,R=E,e0=V,N=J,s=l0,this.enc.setModules(Q,C,R,N)};function y(){this.mask_adjust=0,this.mask_adjust_short=0,this.bo_l_weight=X(r.SBMAX_l),this.bo_s_weight=X(r.SBMAX_s)}function a(){this.lowerlimit=0}function w(t,n){this.lowpass=n}var S=4294479419;function l(t){var n;return t.class_id=S,n=t.internal_flags=new A0,t.mode=I0.NOT_SET,t.original=1,t.in_samplerate=44100,t.num_channels=2,t.num_samples=-1,t.bWriteVbrTag=!0,t.quality=-1,t.short_blocks=null,n.subblock_gain=-1,t.lowpassfreq=0,t.highpassfreq=0,t.lowpasswidth=-1,t.highpasswidth=-1,t.VBR=U.vbr_off,t.VBR_q=4,t.ATHcurve=-1,t.VBR_mean_bitrate_kbps=128,t.VBR_min_bitrate_kbps=0,t.VBR_max_bitrate_kbps=0,t.VBR_hard_min=0,n.VBR_min_bitrate=1,n.VBR_max_bitrate=13,t.quant_comp=-1,t.quant_comp_short=-1,t.msfix=-1,n.resample_ratio=1,n.OldValue[0]=180,n.OldValue[1]=180,n.CurrentStep[0]=4,n.CurrentStep[1]=4,n.masking_lower=1,n.nsPsy.attackthre=-1,n.nsPsy.attackthre_s=-1,t.scale=-1,t.athaa_type=-1,t.ATHtype=-1,t.athaa_loudapprox=-1,t.athaa_sensitivity=0,t.useTemporal=null,t.interChRatio=-1,n.mf_samples_to_encode=r.ENCDELAY+r.POSTDELAY,t.encoder_padding=0,n.mf_size=r.ENCDELAY-r.MDCTDELAY,t.findReplayGain=!1,t.decode_on_the_fly=!1,n.decode_on_the_fly=!1,n.findReplayGain=!1,n.findPeakSample=!1,n.RadioGain=0,n.AudiophileGain=0,n.noclipGainChange=0,n.noclipScale=-1,t.preset=0,t.write_id3tag_automatic=!0,0}this.lame_init=function(){var t=new ve;return l(t),t.lame_allocated_gfp=1,t};function v(t){return t>1?0:t<=0?1:Math.cos(Math.PI/2*t)}this.nearestBitrateFullIndex=function(t){var n=[8,16,24,32,40,48,56,64,80,96,112,128,160,192,224,256,320],Y=0,E=0,V=0,J=0;J=n[16],V=16,E=n[16],Y=16;for(var t0=0;t0<16;t0++)if(Math.max(t,n[t0+1])!=t){J=n[t0+1],V=t0+1,E=n[t0],Y=t0;break}return J-t>t-E?Y:V};function b(t,n){switch(t){case 44100:return n.version=1,0;case 48e3:return n.version=1,1;case 32e3:return n.version=1,2;case 22050:return n.version=0,0;case 24e3:return n.version=0,1;case 16e3:return n.version=0,2;case 11025:return n.version=0,0;case 12e3:return n.version=0,1;case 8e3:return n.version=0,2;default:return n.version=0,-1}}function d(t,n,Y){Y<16e3&&(n=2);for(var E=D.bitrate_table[n][1],V=2;V<=14;V++)D.bitrate_table[n][V]>0&&Math.abs(D.bitrate_table[n][V]-t)<Math.abs(E-t)&&(E=D.bitrate_table[n][V]);return E}function o(t,n,Y){Y<16e3&&(n=2);for(var E=0;E<=14;E++)if(D.bitrate_table[n][E]>0&&D.bitrate_table[n][E]==t)return E;return-1}function c(t,n){var Y=[new w(8,2e3),new w(16,3700),new w(24,3900),new w(32,5500),new w(40,7e3),new w(48,7500),new w(56,1e4),new w(64,11e3),new w(80,13500),new w(96,15100),new w(112,15600),new w(128,17e3),new w(160,17500),new w(192,18600),new w(224,19400),new w(256,19700),new w(320,20500)],E=f.nearestBitrateFullIndex(n);t.lowerlimit=Y[E].lowpass}function e(t){var n=t.internal_flags,Y=32;if(n.lowpass1>0){for(var E=999,V=0;V<=31;V++){var J=V/31;J>=n.lowpass2&&(Y=Math.min(Y,V)),n.lowpass1<J&&J<n.lowpass2&&(E=Math.min(E,V))}E==999?n.lowpass1=(Y-.75)/31:n.lowpass1=(E-.75)/31,n.lowpass2=Y/31}n.highpass2>0&&j(),n.highpass2>0&&j();for(var V=0;V<32;V++){var t0,l0,J=V/31;n.highpass2>n.highpass1?j():t0=1,n.lowpass2>n.lowpass1?l0=v((J-n.lowpass1)/(n.lowpass2-n.lowpass1+1e-20)):l0=1,n.amp_filter[V]=t0*l0}}function M(t){var n=t.internal_flags;switch(t.quality){default:case 9:n.psymodel=0,n.noise_shaping=0,n.noise_shaping_amp=0,n.noise_shaping_stop=0,n.use_best_huffman=0,n.full_outer_loop=0;break;case 8:t.quality=7;case 7:n.psymodel=1,n.noise_shaping=0,n.noise_shaping_amp=0,n.noise_shaping_stop=0,n.use_best_huffman=0,n.full_outer_loop=0;break;case 6:n.psymodel=1,n.noise_shaping==0&&(n.noise_shaping=1),n.noise_shaping_amp=0,n.noise_shaping_stop=0,n.subblock_gain==-1&&(n.subblock_gain=1),n.use_best_huffman=0,n.full_outer_loop=0;break;case 5:n.psymodel=1,n.noise_shaping==0&&(n.noise_shaping=1),n.noise_shaping_amp=0,n.noise_shaping_stop=0,n.subblock_gain==-1&&(n.subblock_gain=1),n.use_best_huffman=0,n.full_outer_loop=0;break;case 4:n.psymodel=1,n.noise_shaping==0&&(n.noise_shaping=1),n.noise_shaping_amp=0,n.noise_shaping_stop=0,n.subblock_gain==-1&&(n.subblock_gain=1),n.use_best_huffman=1,n.full_outer_loop=0;break;case 3:n.psymodel=1,n.noise_shaping==0&&(n.noise_shaping=1),n.noise_shaping_amp=1,n.noise_shaping_stop=1,n.subblock_gain==-1&&(n.subblock_gain=1),n.use_best_huffman=1,n.full_outer_loop=0;break;case 2:n.psymodel=1,n.noise_shaping==0&&(n.noise_shaping=1),n.substep_shaping==0&&(n.substep_shaping=2),n.noise_shaping_amp=1,n.noise_shaping_stop=1,n.subblock_gain==-1&&(n.subblock_gain=1),n.use_best_huffman=1,n.full_outer_loop=0;break;case 1:n.psymodel=1,n.noise_shaping==0&&(n.noise_shaping=1),n.substep_shaping==0&&(n.substep_shaping=2),n.noise_shaping_amp=2,n.noise_shaping_stop=1,n.subblock_gain==-1&&(n.subblock_gain=1),n.use_best_huffman=1,n.full_outer_loop=0;break;case 0:n.psymodel=1,n.noise_shaping==0&&(n.noise_shaping=1),n.substep_shaping==0&&(n.substep_shaping=2),n.noise_shaping_amp=2,n.noise_shaping_stop=1,n.subblock_gain==-1&&(n.subblock_gain=1),n.use_best_huffman=1,n.full_outer_loop=0;break}}function h(t){var n=t.internal_flags;t.frameNum=0,t.write_id3tag_automatic&&s.id3tag_write_v2(t),n.bitrate_stereoMode_Hist=C0([16,5]),n.bitrate_blockType_Hist=C0([16,6]),n.PeakSample=0,t.bWriteVbrTag&&N.InitVbrTag(t)}this.lame_init_params=function(t){var n=t.internal_flags;if(n.Class_ID=0,n.ATH==null&&(n.ATH=new me),n.PSY==null&&(n.PSY=new y),n.rgdata==null&&(n.rgdata=new pe),n.channels_in=t.num_channels,n.channels_in==1&&(t.mode=I0.MONO),n.channels_out=t.mode==I0.MONO?1:2,n.mode_ext=r.MPG_MD_MS_LR,t.mode==I0.MONO&&(t.force_ms=!1),t.VBR==U.vbr_off&&t.VBR_mean_bitrate_kbps!=128&&t.brate==0&&(t.brate=t.VBR_mean_bitrate_kbps),t.VBR==U.vbr_off||t.VBR==U.vbr_mtrh||t.VBR==U.vbr_mt||(t.free_format=!1),t.VBR==U.vbr_off&&t.brate==0&&j(),t.VBR==U.vbr_off&&t.compression_ratio>0&&j(),t.out_samplerate!=0&&(t.out_samplerate<16e3?(t.VBR_mean_bitrate_kbps=Math.max(t.VBR_mean_bitrate_kbps,8),t.VBR_mean_bitrate_kbps=Math.min(t.VBR_mean_bitrate_kbps,64)):t.out_samplerate<32e3?(t.VBR_mean_bitrate_kbps=Math.max(t.VBR_mean_bitrate_kbps,8),t.VBR_mean_bitrate_kbps=Math.min(t.VBR_mean_bitrate_kbps,160)):(t.VBR_mean_bitrate_kbps=Math.max(t.VBR_mean_bitrate_kbps,32),t.VBR_mean_bitrate_kbps=Math.min(t.VBR_mean_bitrate_kbps,320))),t.lowpassfreq==0){var Y=16e3;switch(t.VBR){case U.vbr_off:{var E=new a;c(E,t.brate),Y=E.lowerlimit;break}case U.vbr_abr:{var E=new a;c(E,t.VBR_mean_bitrate_kbps),Y=E.lowerlimit;break}case U.vbr_rh:j();default:j()}t.mode==I0.MONO&&(t.VBR==U.vbr_off||t.VBR==U.vbr_abr)&&(Y*=1.5),t.lowpassfreq=Y|0}switch(t.out_samplerate==0&&j(),t.lowpassfreq=Math.min(20500,t.lowpassfreq),t.lowpassfreq=Math.min(t.out_samplerate/2,t.lowpassfreq),t.VBR==U.vbr_off&&(t.compression_ratio=t.out_samplerate*16*n.channels_out/(1e3*t.brate)),t.VBR==U.vbr_abr&&j(),t.bWriteVbrTag||(t.findReplayGain=!1,t.decode_on_the_fly=!1,n.findPeakSample=!1),n.findReplayGain=t.findReplayGain,n.decode_on_the_fly=t.decode_on_the_fly,n.decode_on_the_fly&&(n.findPeakSample=!0),n.findReplayGain&&j(),n.decode_on_the_fly&&!t.decode_only&&j(),n.mode_gr=t.out_samplerate<=24e3?1:2,t.framesize=576*n.mode_gr,t.encoder_delay=r.ENCDELAY,n.resample_ratio=t.in_samplerate/t.out_samplerate,t.VBR){case U.vbr_mt:case U.vbr_rh:case U.vbr_mtrh:{var V=[5.7,6.5,7.3,8.2,10,11.9,13,14,15,16.5];t.compression_ratio=V[t.VBR_q]}break;case U.vbr_abr:t.compression_ratio=t.out_samplerate*16*n.channels_out/(1e3*t.VBR_mean_bitrate_kbps);break;default:t.compression_ratio=t.out_samplerate*16*n.channels_out/(1e3*t.brate);break}t.mode==I0.NOT_SET&&(t.mode=I0.JOINT_STEREO),t.highpassfreq>0?j():(n.highpass1=0,n.highpass2=0),t.lowpassfreq>0?(n.lowpass2=2*t.lowpassfreq,t.lowpasswidth>=0?j():n.lowpass1=1*2*t.lowpassfreq,n.lowpass1/=t.out_samplerate,n.lowpass2/=t.out_samplerate):j(),e(t),n.samplerate_index=b(t.out_samplerate,t),n.samplerate_index<0&&j(),t.VBR==U.vbr_off?t.free_format?n.bitrate_index=0:(t.brate=d(t.brate,t.version,t.out_samplerate),n.bitrate_index=o(t.brate,t.version,t.out_samplerate),n.bitrate_index<=0&&j()):n.bitrate_index=1,t.analysis&&(t.bWriteVbrTag=!1),n.pinfo!=null&&(t.bWriteVbrTag=!1),Q.init_bit_stream_w(n);for(var J=n.samplerate_index+3*t.version+6*(t.out_samplerate<16e3?1:0),t0=0;t0<r.SBMAX_l+1;t0++)n.scalefac_band.l[t0]=R.sfBandIndex[J].l[t0];for(var t0=0;t0<r.PSFB21+1;t0++){var l0=(n.scalefac_band.l[22]-n.scalefac_band.l[21])/r.PSFB21,k0=n.scalefac_band.l[21]+t0*l0;n.scalefac_band.psfb21[t0]=k0}n.scalefac_band.psfb21[r.PSFB21]=576;for(var t0=0;t0<r.SBMAX_s+1;t0++)n.scalefac_band.s[t0]=R.sfBandIndex[J].s[t0];for(var t0=0;t0<r.PSFB12+1;t0++){var l0=(n.scalefac_band.s[13]-n.scalefac_band.s[12])/r.PSFB12,k0=n.scalefac_band.s[12]+t0*l0;n.scalefac_band.psfb12[t0]=k0}n.scalefac_band.psfb12[r.PSFB12]=192,t.version==1?n.sideinfo_len=n.channels_out==1?21:36:n.sideinfo_len=n.channels_out==1?13:21,t.error_protection&&(n.sideinfo_len+=2),h(t),n.Class_ID=S;{var P0;for(P0=0;P0<19;P0++)n.nsPsy.pefirbuf[P0]=700*n.mode_gr*n.channels_out;t.ATHtype==-1&&(t.ATHtype=4)}switch(t.VBR){case U.vbr_mt:t.VBR=U.vbr_mtrh;case U.vbr_mtrh:{t.useTemporal==null&&(t.useTemporal=!1),A.apply_preset(t,500-t.VBR_q*10,0),t.quality<0&&(t.quality=LAME_DEFAULT_QUALITY),t.quality<5&&(t.quality=0),t.quality>5&&(t.quality=5),n.PSY.mask_adjust=t.maskingadjust,n.PSY.mask_adjust_short=t.maskingadjust_short,t.experimentalY?n.sfb21_extra=!1:n.sfb21_extra=t.out_samplerate>44e3,n.iteration_loop=new VBRNewIterationLoop(e0);break}case U.vbr_rh:{A.apply_preset(t,500-t.VBR_q*10,0),n.PSY.mask_adjust=t.maskingadjust,n.PSY.mask_adjust_short=t.maskingadjust_short,t.experimentalY?n.sfb21_extra=!1:n.sfb21_extra=t.out_samplerate>44e3,t.quality>6&&(t.quality=6),t.quality<0&&(t.quality=LAME_DEFAULT_QUALITY),n.iteration_loop=new VBROldIterationLoop(e0);break}default:{var F0;n.sfb21_extra=!1,t.quality<0&&(t.quality=LAME_DEFAULT_QUALITY),F0=t.VBR,F0==U.vbr_off&&(t.VBR_mean_bitrate_kbps=t.brate),A.apply_preset(t,t.VBR_mean_bitrate_kbps,0),t.VBR=F0,n.PSY.mask_adjust=t.maskingadjust,n.PSY.mask_adjust_short=t.maskingadjust_short,F0==U.vbr_off?n.iteration_loop=new Ae(e0):j();break}}return t.VBR!=U.vbr_off&&j(),t.tune&&j(),M(t),t.athaa_type<0?n.ATH.useAdjust=3:n.ATH.useAdjust=t.athaa_type,n.ATH.aaSensitivityP=Math.pow(10,t.athaa_sensitivity/-10),t.short_blocks==null&&(t.short_blocks=c0.short_block_allowed),t.short_blocks==c0.short_block_allowed&&(t.mode==I0.JOINT_STEREO||t.mode==I0.STEREO)&&(t.short_blocks=c0.short_block_coupled),t.quant_comp<0&&(t.quant_comp=1),t.quant_comp_short<0&&(t.quant_comp_short=0),t.msfix<0&&(t.msfix=0),t.exp_nspsytune=t.exp_nspsytune|1,t.internal_flags.nsPsy.attackthre<0&&(t.internal_flags.nsPsy.attackthre=R0.NSATTACKTHRE),t.internal_flags.nsPsy.attackthre_s<0&&(t.internal_flags.nsPsy.attackthre_s=R0.NSATTACKTHRE_S),t.scale<0&&(t.scale=1),t.ATHtype<0&&(t.ATHtype=4),t.ATHcurve<0&&(t.ATHcurve=4),t.athaa_loudapprox<0&&(t.athaa_loudapprox=2),t.interChRatio<0&&(t.interChRatio=0),t.useTemporal==null&&(t.useTemporal=!0),n.slot_lag=n.frac_SpF=0,t.VBR==U.vbr_off&&(n.slot_lag=n.frac_SpF=(t.version+1)*72e3*t.brate%t.out_samplerate|0),R.iteration_init(t),C.psymodel_init(t),0};function g(t,n){(t.in_buffer_0==null||t.in_buffer_nsamples<n)&&(t.in_buffer_0=X(n),t.in_buffer_1=X(n),t.in_buffer_nsamples=n)}this.lame_encode_flush=function(t,n,Y,E){var V=t.internal_flags,J=U0([2,1152]),t0=0,l0,k0,P0,F0,_e=V.mf_samples_to_encode-r.POSTDELAY,ue=_(t);if(V.mf_samples_to_encode<1)return 0;for(l0=0,t.in_samplerate!=t.out_samplerate&&j(),P0=t.framesize-_e%t.framesize,P0<576&&(P0+=t.framesize),t.encoder_padding=P0,F0=(_e+P0)/t.framesize;F0>0&&t0>=0;){var ne=ue-V.mf_size,le=t.frameNum;ne*=t.in_samplerate,ne/=t.out_samplerate,ne>1152&&(ne=1152),ne<1&&(ne=1),k0=E-l0,E==0&&(k0=0),t0=this.lame_encode_buffer(t,J[0],J[1],ne,n,Y,k0),Y+=t0,l0+=t0,F0-=le!=t.frameNum?1:0}return V.mf_samples_to_encode=0,t0<0||(k0=E-l0,E==0&&(k0=0),Q.flush_bitstream(t),t0=Q.copy_buffer(V,n,Y,k0,1),t0<0)?t0:(Y+=t0,l0+=t0,k0=E-l0,E==0&&(k0=0),t.write_id3tag_automatic&&j(),l0)},this.lame_encode_buffer=function(t,n,Y,E,V,J,t0){var l0=t.internal_flags,k0=[null,null];if(l0.Class_ID!=S)return-3;if(E==0)return 0;g(l0,E),k0[0]=l0.in_buffer_0,k0[1]=l0.in_buffer_1;for(var P0=0;P0<E;P0++)k0[0][P0]=n[P0],l0.channels_in>1&&(k0[1][P0]=Y[P0]);return i(t,k0[0],k0[1],E,V,J,t0)};function _(t){var n=r.BLKSIZE+t.framesize-r.FFTOFFSET;return n=Math.max(n,512+t.framesize-32),n}function i(t,n,Y,E,V,J,t0){var l0=t.internal_flags,k0=0,P0,F0,_e,ue,ne,le=[null,null],he=[null,null];if(l0.Class_ID!=S)return-3;if(E==0)return 0;if(ne=Q.copy_buffer(l0,V,J,t0,0),ne<0)return ne;if(J+=ne,k0+=ne,he[0]=n,he[1]=Y,x0.NEQ(t.scale,0)&&x0.NEQ(t.scale,1))for(F0=0;F0<E;++F0)he[0][F0]*=t.scale,l0.channels_out==2&&(he[1][F0]*=t.scale);if(x0.NEQ(t.scale_left,0)&&x0.NEQ(t.scale_left,1))for(F0=0;F0<E;++F0)he[0][F0]*=t.scale_left;if(x0.NEQ(t.scale_right,0)&&x0.NEQ(t.scale_right,1))for(F0=0;F0<E;++F0)he[1][F0]*=t.scale_right;t.num_channels==2&&l0.channels_out==1&&j(),ue=_(t),le[0]=l0.mfbuf[0],le[1]=l0.mfbuf[1];for(var Ee=0;E>0;){var q=[null,null],I=0,F=0;q[0]=he[0],q[1]=he[1];var b0=new p;if(k(t,le,q,Ee,E,b0),I=b0.n_in,F=b0.n_out,l0.findReplayGain&&!l0.decode_on_the_fly&&m.AnalyzeSamples(l0.rgdata,le[0],l0.mf_size,le[1],l0.mf_size,F,l0.channels_out)==r0.GAIN_ANALYSIS_ERROR)return-6;if(E-=I,Ee+=I,l0.channels_out==2,l0.mf_size+=F,l0.mf_samples_to_encode<1&&j(),l0.mf_samples_to_encode+=F,l0.mf_size>=ue){var v0=t0-k0;if(t0==0&&(v0=0),P0=u(t,le[0],le[1],V,J,v0),P0<0)return P0;for(J+=P0,k0+=P0,l0.mf_size-=t.framesize,l0.mf_samples_to_encode-=t.framesize,_e=0;_e<l0.channels_out;_e++)for(F0=0;F0<l0.mf_size;F0++)le[_e][F0]=le[_e][F0+t.framesize]}}return k0}function u(t,n,Y,E,V,J){var t0=f.enc.lame_encode_mp3_frame(t,n,Y,E,V,J);return t.frameNum++,t0}function p(){this.n_in=0,this.n_out=0}function k(t,n,Y,E,V,J){var t0=t.internal_flags;if(t0.resample_ratio<.9999||t0.resample_ratio>1.0001)j();else{J.n_out=Math.min(t.framesize,V),J.n_in=J.n_out;for(var l0=0;l0<J.n_out;++l0)n[0][t0.mf_size+l0]=Y[0][E+l0],t0.channels_out==2&&(n[1][t0.mf_size+l0]=Y[1][E+l0])}}}function re(){this.setModules=function(f,L){}}function j0(){this.setModules=function(f,L,H){}}function z0(){}function D0(){this.setModules=function(f,L){}}function Q0(f,L,H){f!=1&&j("fix cc: only supports mono");var m=new m0,Q=new re,A=new r0,R=new x0,e0=new y0,C=new ee,N=new Pe,s=new H0,y=new n0,a=new D0,w=new g0,S=new S0,l=new j0,v=new z0;m.setModules(A,R,e0,C,N,s,y,a,v),R.setModules(A,v,y,s),a.setModules(R,y),e0.setModules(m),N.setModules(R,w,C,S),C.setModules(S,w,m.enc.psy),w.setModules(R),S.setModules(C),s.setModules(m,R,y),Q.setModules(l,v),l.setModules(y,a,e0);var b=m.lame_init();b.num_channels=f,b.in_samplerate=L,b.out_samplerate=L,b.brate=H,b.mode=I0.STEREO,b.quality=3,b.bWriteVbrTag=!1,b.disable_reservoir=!0,b.write_id3tag_automatic=!1,m.lame_init_params(b);var d=1152,o=0|1.25*d+7200,c=s0(o);this.encodeBuffer=function(e,M){f==1&&(M=e),e.length>d&&(d=e.length,o=0|1.25*d+7200,c=s0(o));var h=m.lame_encode_buffer(b,e,M,e.length,c,0,o);return new Int8Array(c.subarray(0,h))},this.flush=function(){var e=m.lame_encode_flush(b,c,0,o);return new Int8Array(c.subarray(0,e))}}h0.SFBMAX=r.SBMAX_s*3,G.Mp3Encoder=Q0}G(),K.lamejs=G});(function(K){var G=typeof window=="object"&&!!window.document,$=G?window:Object,j=$.Recorder,s0=j.i18n;K(j,s0,s0.$T,G)})(function(K,G,$,j){var s0=function(X){return new T(X)},V0="WaveView",T=function(X){var M0=this,o0={scale:2,speed:9,phase:21.8,fps:20,keep:!0,lineWidth:3,linear1:[0,"rgba(150,96,238,1)",.2,"rgba(170,79,249,1)",1,"rgba(53,199,253,1)"],linear2:[0,"rgba(209,130,255,0.6)",1,"rgba(53,199,255,0.6)"],linearBg:[0,"rgba(255,255,255,0.2)",1,"rgba(54,197,252,0.2)"]};for(var C0 in X)o0[C0]=X[C0];M0.set=X=o0;var U0="compatibleCanvas";if(X[U0])var d0=M0.canvas=X[U0];else{if(!j)throw new Error($.G("NonBrowser-1",[V0]));var T0=X.elem;T0&&(typeof T0=="string"?T0=document.querySelector(T0):T0.length&&(T0=T0[0])),T0&&(X.width=T0.offsetWidth,X.height=T0.offsetHeight);var P=M0.elem=document.createElement("div");P.style.fontSize=0,P.innerHTML='<canvas style="width:100%;height:100%;"/>';var d0=M0.canvas=P.querySelector("canvas");T0&&(T0.innerHTML="",T0.appendChild(P))}var W=X.scale,c0=X.width*W,L0=X.height*W;if(!c0||!L0)throw new Error($.G("IllegalArgs-1",[V0+" width=0 height=0"]));d0.width=c0,d0.height=L0;var U=M0.ctx=d0.getContext("2d");M0.linear1=M0.genLinear(U,c0,X.linear1),M0.linear2=M0.genLinear(U,c0,X.linear2),M0.linearBg=M0.genLinear(U,L0,X.linearBg,!0),M0._phase=0};T.prototype=s0.prototype={genLinear:function(X,M0,o0,C0){for(var U0=X.createLinearGradient(0,0,C0?0:M0,C0?M0:0),d0=0;d0<o0.length;)U0.addColorStop(o0[d0++],o0[d0++]);return U0},genPath:function(X,M0,o0){for(var C0=[],U0=this,d0=U0.set,T0=d0.scale,P=d0.width*T0,W=d0.height*T0/2,c0=0;c0<=P;c0+=T0){var L0=(1+Math.cos(Math.PI+c0/P*2*Math.PI))/2,U=L0*W*M0*Math.sin(2*Math.PI*(c0/P)*X+o0)+W;C0.push(U)}return C0},input:function(X,M0,o0){var C0=this;C0.sampleRate=o0,C0.pcmData=X,C0.pcmPos=0,C0.inputTime=Date.now(),C0.schedule()},schedule:function(){var X=this,M0=X.set,o0=Math.floor(1e3/M0.fps);X.timer||(X.timer=setInterval(function(){X.schedule()},o0));var C0=Date.now(),U0=X.drawTime||0;if(!(C0-U0<o0)){X.drawTime=C0;for(var d0=X.sampleRate/M0.fps,T0=X.pcmData,P=X.pcmPos,W=Math.max(0,Math.min(d0,T0.length-P)),c0=0,L0=0;L0<W;L0++,P++)c0+=Math.abs(T0[P]);X.pcmPos=P,(W||!M0.keep)&&X.draw(K.PowerLevel(c0,W)),!W&&C0-X.inputTime>1300&&(clearInterval(X.timer),X.timer=0)}},draw:function(X){var M0=this,o0=M0.set,C0=M0.ctx,U0=o0.scale,d0=o0.width*U0,T0=o0.height*U0,P=o0.speed/o0.fps,W=M0._phase-=P,c0=W+P*o0.phase,L0=X/100,U=M0.genPath(2,L0,W),I0=M0.genPath(1.8,L0,c0);C0.clearRect(0,0,d0,T0),C0.beginPath();for(var n0=0,S0=0;S0<=d0;n0++,S0+=U0)S0==0?C0.moveTo(S0,U[n0]):C0.lineTo(S0,U[n0]);n0--;for(var S0=d0-1;S0>=0;n0--,S0-=U0)C0.lineTo(S0,I0[n0]);C0.closePath(),C0.fillStyle=M0.linearBg,C0.fill(),M0.drawPath(I0,M0.linear2),M0.drawPath(U,M0.linear1)},drawPath:function(X,M0){var o0=this,C0=o0.set,U0=o0.ctx,d0=C0.scale,T0=C0.width*d0;U0.beginPath();for(var P=0,W=0;W<=T0;P++,W+=d0)W==0?U0.moveTo(W,X[P]):U0.lineTo(W,X[P]);U0.lineWidth=C0.lineWidth*d0,U0.strokeStyle=M0,U0.stroke()}},K[V0]=s0});var Z1={exports:{}};(function(K){(function(G){var $=typeof window=="object"&&!!window.document,j=$?window:Object,s0=j.Recorder,V0=s0.i18n;G(j,s0,V0,V0.$T,$),K.exports&&(K.exports=j.RecordApp)})(function(G,$,j,s0,V0){var T={LM:"2024-04-09 19:22",Current:0,Platforms:{}},X=T.Platforms,M0="RecordApp",o0="RequestPermission",C0="RegisterPlatform",U0=G[M0];if(U0&&U0.LM==T.LM){U0.CLog(s0("uXtA::重复导入{1}",0,M0),3);return}G[M0]=T,$[M0]=T,T.__SID_=0;var d0=T.__SID=function(){return++T.__SID_},T0=T.__Sync=function(n0,S0,r0){return T.__SID_!=n0?(S0&&P(s0("kIBu::注意：因为并发调用了其他录音相关方法，当前 {1} 的调用结果已被丢弃且不会有回调",0,S0)+(r0?", error: "+r0:""),3),!1):!0},P=function(){var n0=arguments;n0[0]="["+(P.Tag||M0)+"]["+(T.Current&&T.Current.Key||"?")+"]"+n0[0],$.CLog.apply(null,n0)};T.CLog=P,T[C0]=function(n0,S0){S0.Key=n0,X[n0]&&P(s0("ha2K::重复注册{1}",0,n0),3),X[n0]=S0},T.__StopOnlyClearMsg=function(){return s0("wpTL::仅清理资源")};var W="Default-H5",c0=o0+"_H5OpenSet";(function(){var n0={Support:function(r0){r0(!0)},CanProcess:function(){return!0}};T[C0](W,n0),n0[o0]=function(r0,y0,g0){var H0=T.__Rec;H0&&(H0.close(),T.__Rec=null),S0();var x0=T[c0];T[c0]=null;var _0=$(x0||{});_0.open(function(){y0()},g0)};var S0=function(){if($.IsOpen()){P("kill open...");var r0=$();r0.open(),r0.close()}};n0.Start=function(r0,y0,g0,H0){var x0=T.__Rec;x0?.stop(),T.__Rec=x0=$(y0),x0.appSet=y0,x0.dataType="arraybuffer",x0.open(function(){T0(r0)&&x0.start(),g0()},H0)},n0.Stop=function(r0,y0,g0){var H0=T.__Rec,x0=y0?"":T.__StopOnlyClearMsg();if(!H0){S0(),g0(s0("bpvP::未开始录音")+(x0?" ("+x0+")":""));return}var _0=function(){if(T0(r0)){H0.close();for(var W0 in H0.set)H0.appSet[W0]=H0.set[W0]}},D=function(W0){_0(),g0(W0)};if(!y0){D(x0);return}H0.stop(function(W0,O0,q0){_0(),y0(W0,O0,q0)},D)}})(),T.GetCurrentRecOrNull=function(){return T.__Rec||null},T.Pause=function(){var n0=T.Current,S0="Pause";if(!(n0&&n0[S0]&&n0[S0]()!==!1)){var r0=T.__Rec;r0&&L0(S0)&&r0.pause()}},T.Resume=function(){var n0=T.Current,S0="Resume";if(!(n0&&n0[S0]&&n0[S0]()!==!1)){var r0=T.__Rec;r0&&L0(S0)&&r0.resume()}};var L0=function(n0){var S0=T.Current;if(S0&&S0.CanProcess())return 1;P(s0("fLJD::当前环境不支持实时回调，无法进行{1}",0,n0),3)};T.Install=function(n0,S0){var r0=T.Current;if(r0){n0&&n0();return}var y0=T.__reqs||(T.__reqs=[]);y0.push({s:n0,f:S0}),n0=function(){g0("s",arguments)},S0=function(){g0("f",arguments)};var g0=function(O0,q0){var me=[].concat(y0);y0.length=0;for(var ve=0;ve<me.length;ve++){var Ae=me[ve][O0];Ae&&Ae.apply(null,q0)}};if(!(y0.length>1)){var H0=[W],x0;for(var _0 in X)_0!=W&&H0.push(_0);H0.reverse();var D=function(O0){x0=H0[O0],r0=X[x0],r0.Support(function(q0){if(!q0)return D(O0+1);r0.Install?r0.Install(W0,S0):W0()})},W0=function(){T.Current=r0,P("Install platform: "+x0),n0()};D(0)}},T[o0]=function(n0,S0){var r0=d0(),y0=M0+"."+o0,g0=function(H0,x0){x0=!!x0;var _0=H0+", isUserNotAllow:"+x0;T0(r0,y0,_0)&&(P(s0("YnzX::录音权限请求失败：")+_0,1),S0&&S0(H0,x0))};P(o0+"..."),T.Install(function(){if(T0(r0,y0)){var H0=I0();if(H0){g0(H0);return}T.Current[o0](r0,function(){T0(r0,y0)&&(P(o0+" Success"),n0&&n0())},g0)}},g0)};var U=function(){return s0("nwKR::需先调用{1}",0,o0)},I0=function(){var n0="";return T.Current.Key==W&&!V0&&(n0=s0("citA::当前不是浏览器环境，需引入针对此平台的支持文件（{1}），或调用{2}自行实现接入",0,"src/app-support/app-xxx-support.js",M0+"."+C0)),n0};T.Start=function(n0,S0,r0){var y0=d0(),g0=M0+".Start",H0=function(me){T0(y0,g0,me)&&(P(s0("ecp9::开始录音失败：")+me,1),r0&&r0(me))};P("Start...");var x0=T.Current;if(!x0){H0(U());return}n0||(n0={});var _0={type:"mp3",sampleRate:16e3,bitRate:16,onProcess:function(){}};for(var D in _0)n0[D]||(n0[D]=_0[D]);for(var D in X){var W0=X[D];W0.AllStart_Clean&&W0.AllStart_Clean(n0)}var O0=!1;if(x0.Start_Check&&(O0=x0.Start_Check(n0)),O0===!1){var q0=$(n0);O0=q0.envCheck({envName:x0.Key,canProcess:x0.CanProcess()}),O0||(O0=I0())}if(O0){H0(s0("EKmS::不能录音：")+O0);return}T._SRec=0,x0.Start(y0,n0,function(){T0(y0,g0)&&(P(s0("k7Qo::已开始录音"),n0),T._STime=Date.now(),S0&&S0())},H0)},T.Stop=function(n0,S0){var r0=d0(),y0=M0+".Stop",g0=function(D){if(T0(r0,y0,D)){P(s0("Douz::结束录音失败：")+D,n0?1:0);try{S0&&S0(D)}finally{H0()}}},H0=function(){T._SRec=T.__Rec,T.__Rec=null};P("Stop... "+s0("wqSH::和Start时差：{1}ms",0,T._STime?Date.now()-T._STime:-1)+" Recorder.LM:"+$.LM+" "+M0+".LM:"+T.LM);var x0=Date.now(),_0=T.Current;if(!_0){g0(U());return}_0.Stop(r0,n0?function(D,W0,O0){if(T0(r0,y0)){P(s0("g3VX::结束录音 耗时{1}ms 音频时长{2}ms 文件大小{3}b {4}",0,Date.now()-x0,W0,D.byteLength,O0));try{n0(D,W0,O0)}finally{H0()}}}:null,g0)}})})(Z1);function Q1(K){const G=K?.waveViewRef,$=K?.defaultOptions,j=Ce(!1),s0=Ce(!1),V0=Ce(!1),T=w1(null),X=new a1({type:"wav",sampleRate:16e3,bitRate:16,...$});function M0(){return V0.value=!0,new Promise((d0,T0)=>{X.open(()=>{j.value=!0,V0.value=!1,t1.info("recorder open success",X),d0(X)},(P,W)=>{j.value=!1,t1.error("recorder open error",P,W),T0(P)})})}function o0(){const d0=T1(G);return a1.WaveView&&d0&&!T.value&&y1(()=>d0.clientWidth>0).then(()=>{T.value=a1.WaveView({elem:d0})}),X.start(),s0.value=!0,X}function C0(){return new Promise((d0,T0)=>{X.stop(P=>{X.close(),s0.value=!1,d0(P)},P=>{console.error(P),X.close(),s0.value=!1,T0(P)})})}async function U0(d0){const T0=d0?.openThen||M1;return j.value?M0().then(o0):Promise.race([M0(),A1(2500)]).then(async P=>{t1.info("openOrStart",P);let W=!!P;if(!P){const c0=await T0();typeof c0=="boolean"&&(W=c0)}return W?o0():P})}return{supported:j,recording:s0,opening:V0,recorder:X,open:M0,stop:C0,start:o0,openOrStart:U0,wave:T}}const J1={onTextZone:{type:Function,default:void 0},appendTo:{type:null,default:"body"},disabled:{type:Boolean,default:!1},speechToText:{type:Function,default:void 0},submitToText:{type:Boolean,default:!1}},$1={submitText:K=>typeof K=="string",submit:K=>!0,error:K=>!0};async function et(K,G){const $=new FormData;$.append("file",G,"audio.wav");const j=await fetch(K,{method:"POST",body:$});if(!j.ok)throw new Error("Speech to text failed");return(await j.json()).text}const tt=100;var at=R1({name:"VkRecorderButton",components:{ElButton:N1},props:J1,emits:$1,setup(K,{emit:G}){const $=Ce(),{openOrStart:j,recording:s0,recorder:V0,wave:T}=Q1({waveViewRef:$,defaultOptions:{onProcess:S0}}),X=Ce("");let M0=null;const o0=Ce(!1),C0=async()=>{try{await j({openThen:()=>(o0.value=!1,!1)})}catch(r0){console.error("录音失败:",r0),G("error",r0),o0.value=!1;return}s0.value=!0},U0=Ce({x:0,y:0}),d0=Ce(!1),T0=Ce(!1);let P=!1;const W=()=>{const r0=T0.value;V0.stop(async y0=>{if(X.value=(window.URL||webkitURL).createObjectURL(y0),V0.close(),s0.value=!1,G("submit",{blob:y0,url:X.value}),r0||K.submitToText)if(K.onTextZone)K.onTextZone({blob:y0,url:X.value});else{if(K.speechToText){K.speechToText(y0).then(g0=>{G("submitText",g0)});return}et("/speech-to-text",y0).then(g0=>{G("submitText",g0)}).catch(g0=>{console.error("语音识别错误:",g0),P1.error("转换文字失败")})}})},c0=()=>{document.addEventListener("mousemove",I0),document.addEventListener("mouseup",n0)},L0=()=>{document.removeEventListener("mousemove",I0),document.removeEventListener("mouseup",n0)},U=r0=>{if(K.disabled)return;r0.preventDefault(),P=!0;const y0="touches"in r0?r0.touches[0]:r0;U0.value={x:y0.clientX,y:y0.clientY},r0 instanceof MouseEvent&&c0(),M0=setTimeout(()=>{P&&(o0.value=!0,C0())},tt)};function I0(r0){if(r0.preventDefault(),!o0.value)return;const y0="touches"in r0?r0.touches[0]:r0;U0.value={x:y0.clientX,y:y0.clientY};const g0=document.querySelector(".cancel-btn-x"),H0=document.querySelector(".text-btn-x");if(g0&&H0){const x0=g0.getBoundingClientRect(),_0=H0.getBoundingClientRect();d0.value=y0.clientX>=x0.left&&y0.clientX<=x0.right&&y0.clientY>=x0.top&&y0.clientY<=x0.bottom,T0.value=y0.clientX>=_0.left&&y0.clientX<=_0.right&&y0.clientY>=_0.top&&y0.clientY<=_0.bottom}}function n0(r0){P=!1,clearTimeout(M0),o0.value&&(d0.value?V0.close():W(),o0.value=!1,d0.value=!1,T0.value=!1),r0 instanceof MouseEvent&&L0()}function S0(r0,y0,g0,H0){T.value?.input(r0[r0.length-1],y0,H0)}return V1(()=>{L0()}),{onmousedown:U,onmousemove:I0,onmouseup:n0,recording:s0,recordingNode:$,blobUrl:X,isDragging:o0,cancelZone:d0,isTextZone:T0}}});const rt={class:"vk-recorder-container"},nt={class:"vk-recording-mask"},st={class:"recording-tip"},it={ref:"recordingNode",class:"wave-container"},lt={class:"tip-text"},ot={class:"action-buttons"},_t={class:"cancel-btn-x"},ut={class:"text-btn-x"};function ft(K,G,$,j,s0,V0){const T=E1("ElButton");return m1(),C1("div",rt,[Qe(" 遮罩层 "),(m1(),k1(O1,{to:K.appendTo},[I1(Me("div",nt,[Qe(" 录音提示区域移到上面 "),Me("div",st,[Me("div",it,null,512),Me("div",lt,g1(K.cancelZone?"松开手指，取消发送":"松开发送，上滑取消"),1)]),Me("div",ot,[Me("div",_t,[Me("div",{class:b1(["cancel-btn",{active:K.cancelZone}])},G[0]||(G[0]=[Me("div",{class:"btn-icon"}," × ",-1),Me("div",{class:"btn-text"}," 取消发送 ",-1)]),2)]),Me("div",ut,[Me("div",{class:b1(["text-btn",{active:K.isTextZone}])},G[1]||(G[1]=[Me("div",{class:"btn-icon"}," 文 ",-1),Me("div",{class:"btn-text"}," 转为文字 ",-1)]),2)])])],512),[[D1,K.isDragging]])],8,["to"])),Qe(" 录音按钮 "),L1(T,F1(K.$attrs,{disabled:K.disabled,class:["vk-recorder-button",{"is-recording":K.recording}],size:"large",onTouchstart:K.onmousedown,onTouchmove:K.onmousemove,onTouchend:K.onmouseup,onMousedown:K.onmousedown}),{default:H1(()=>G[2]||(G[2]=[Me("span",{class:"vk-recorder-button-text"},"按住 说话",-1)])),_:1},16,["disabled","class","onTouchstart","onTouchmove","onTouchend","onMousedown"])])}var r1=B1(at,[["render",ft]]),Zt=Object.freeze({__proto__:null});r1.install=K=>{K.component(r1.name||"VkRecorderButton",r1)};export{r1 as VkRecorderButton,Zt as __VkRecorderButton,r1 as default};
