import{dT as re,jG as ct,GG as ui,GH as di,GI as fi,GJ as pi,GK as mi,fD as _e,fC as yi,GL as we,eV as Wt,GM as vi,f2 as kt,z as hi,l6 as Ti,A as gi,eH as wi,dc as Mi,GN as xi,GO as $i,GP as _i,H as bi,GQ as Si,GR as Li,GS as Oi,GT as Vi,GU as Ci,aJ as fe,GV as Ri,GW as Ei,my as Ii,dQ as ji,aL as Wi,GX as ki,GY as Hi,GZ as Bi,G_ as St,G$ as Gi,H0 as Pi,H1 as Ai}from"./chunk-Dx0VeHfy.js";import{aa as V,aC as ut,d as m,aj as w,r as M,j as b,o as T,b as y,k as dt,a as S,m as Z,G as E,f as C,i as P,aD as ee,b6 as v,J as f,cC as ft,cD as pt,aL as ue,h as I,aV as te,aR as B,g as H,w as W,c as F,F as be,af as Se,z as Ht,A as Bt,e as Di,H as Gt,cE as Fi,cF as Ui,bs as Pt,aI as Ni,u as qi,C as zi,D as Xi,a9 as Ji}from"./chunk-DpJVogQA.js";const R=Symbol("mitter"),mt=Symbol("cursor"),D=Symbol("index"),ot=Symbol("index-topping"),lt=(e,t)=>!(t.maxScale&&e<t.maxScale||t.minScale&&e>=t.minScale);class de{constructor(){this.removeHandler=null}async remove(){await this.removeHandler?.(),this.removeHandler=null}async toggle(t){this.removeHandler?this.remove():this.add(t)}async reset(t){await this.remove(),await this.add(t)}}function U(){const e=V("vaView");if(!e)throw new Error("The component which use useView() must be in a View component");return e}function Ki(){const e=V("vaSceneView");if(!e)throw new Error("The component which use useSceneView() must be in <VaSceneView>");return e}function At(){const e=V("vaLayer");if(!e)throw new Error("The component which use useLayer() must be in a Layer component");return e}function Qi(){const e=V("vaSublayers");if(!e)throw new Error("The component which use useSublayers() must be in a has Sublayers component");return e}class Yi extends de{constructor(t){super(),this.interceptor=t}add(){re.request.interceptors||(re.request.interceptors=[]),re.request.interceptors?.unshift(this.interceptor),this.removeHandler=()=>{const t=re.request.interceptors?.indexOf(this.interceptor);t!==void 0&&t!==-1&&re.request.interceptors?.splice(t,1)}}}const Zi=e=>{const t=new Yi(e);return ut(()=>{t.remove()}),{interceptorToggle:t}};function x(){const e=V("vaView");if(!e)throw new Error("The component which use useView() must be in a View component");return e}function ea(){const e=V("vaSceneView");if(!e)throw new Error("The component which use useSceneView() must be in <VaSceneView>");return e}function Dt(){const e=V("vaBasemap");if(!e)throw new Error("The component which use useBasemap() must be in <VaBasemap>");return e}function ta(){const e=V("vaBasemapToggle");if(!e)throw new Error("The component which use useBasemapToggle() must be in <VaBasemapToggle>");return e}function Le(){const e=V("vaLayer");if(!e)throw new Error("The component which use useLayer() must be in a Layer component");return e}function ia(){const e=V("vaFeatureLayer");if(!e)throw new Error("The component which use useFeatureLayer() must be in a FeatureLayer component");return e}function aa(){const e=V("vaGraphicsLayer");if(!e)throw new Error("The component which use useGraphicsLayer() must be in a GraphicsLayer component");return e}function na(){const e=V("vaGraphic");if(!e)throw new Error("The component which use useGraphic() must be in a Graphic component");return e}function ra(){const e=V("vaSketch");if(!e)throw new Error("The component which use useSketch() must be in a Sketch component");return e}const Ft={cursor:{type:String,default:""}},Ut={"update:cursor":e=>e||!0};var Nt=Object.freeze({__proto__:null,emits:Ut,props:Ft}),oa=typeof global=="object"&&global&&global.Object===Object&&global,la=typeof self=="object"&&self&&self.Object===Object&&self,qt=oa||la||Function("return this")(),Me=qt.Symbol,zt=Object.prototype,sa=zt.hasOwnProperty,ca=zt.toString,oe=Me?Me.toStringTag:void 0;function ua(e){var t=sa.call(e,oe),i=e[oe];try{e[oe]=void 0;var a=!0}catch{}var n=ca.call(e);return a&&(t?e[oe]=i:delete e[oe]),n}var da=Object.prototype,fa=da.toString;function pa(e){return fa.call(e)}var ma="[object Null]",ya="[object Undefined]",Lt=Me?Me.toStringTag:void 0;function va(e){return e==null?e===void 0?ya:ma:Lt&&Lt in Object(e)?ua(e):pa(e)}function ha(e){return e!=null&&typeof e=="object"}var Ta="[object Symbol]";function ga(e){return typeof e=="symbol"||ha(e)&&va(e)==Ta}var wa=/\s/;function Ma(e){for(var t=e.length;t--&&wa.test(e.charAt(t)););return t}var xa=/^\s+/;function $a(e){return e&&e.slice(0,Ma(e)+1).replace(xa,"")}function xe(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Ot=NaN,_a=/^[-+]0x[0-9a-f]+$/i,ba=/^0b[01]+$/i,Sa=/^0o[0-7]+$/i,La=parseInt;function Vt(e){if(typeof e=="number")return e;if(ga(e))return Ot;if(xe(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=xe(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=$a(e);var i=ba.test(e);return i||Sa.test(e)?La(e.slice(2),i?2:8):_a.test(e)?Ot:+e}var Re=function(){return qt.Date.now()},Oa="Expected a function",Va=Math.max,Ca=Math.min;function Ra(e,t,i){var a,n,r,o,c,l,s=0,d=!1,u=!1,p=!0;if(typeof e!="function")throw new TypeError(Oa);t=Vt(t)||0,xe(i)&&(d=!!i.leading,u="maxWait"in i,r=u?Va(Vt(i.maxWait)||0,t):r,p="trailing"in i?!!i.trailing:p);function $(L){var A=a,ne=n;return a=n=void 0,s=L,o=e.apply(ne,A),o}function _(L){return s=L,c=setTimeout(j,t),d?$(L):o}function g(L){var A=L-l,ne=L-s,bt=t-A;return u?Ca(bt,r-ne):bt}function O(L){var A=L-l,ne=L-s;return l===void 0||A>=t||A<0||u&&ne>=r}function j(){var L=Re();if(O(L))return ae(L);c=setTimeout(j,g(L))}function ae(L){return c=void 0,p&&a?$(L):(a=n=void 0,o)}function q(){c!==void 0&&clearTimeout(c),s=0,a=l=n=c=void 0}function z(){return c===void 0?o:ae(Re())}function Ce(){var L=Re(),A=O(L);if(a=arguments,n=this,l=L,A){if(c===void 0)return _(l);if(u)return clearTimeout(c),c=setTimeout(j,t),$(l)}return c===void 0&&(c=setTimeout(j,t)),o}return Ce.cancel=q,Ce.flush=z,Ce}var Ea="Expected a function";function st(e,t,i){var a=!0,n=!0;if(typeof e!="function")throw new TypeError(Ea);return xe(i)&&(a="leading"in i?!!i.leading:a,n="trailing"in i?!!i.trailing:n),Ra(e,t,{leading:a,maxWait:t,trailing:n})}var Xt=m({emits:Ut,props:Ft,setup(e,{emit:t}){const i=U();class a extends de{constructor(l,s){super(),this.eventName=l,this.handler=s}add(){const l=i.on(this.eventName,this.handler);this.removeHandler=l.remove}}const n=i[R],r=new a("click",async c=>{const l=await i.hitTest(c);console.log("va_view_click_event",{view:i,event:c,hitTestResult:l}),n.emit("click",{view:i,event:c,hitTestResult:l})});r.add(),w(()=>{r.remove()});const o=new a("pointer-move",st(async c=>{const l=await i.hitTest(c),s=l.results[0];let d;if(s&&(s.type==="media"?d=s.layer:s.type==="graphic"&&(d=s.graphic?.layer)),d){const u=d[mt];t("update:cursor",u)}else t("update:cursor","initial");n.emit("pointer-move",{view:i,event:c,hitTestResult:l})},600,{leading:!1,trailing:!0}));return o.add(),w(()=>{o.remove()}),()=>null}}),Jt=m({setup(){const e=x();class t extends de{constructor(o,c){super(),this.propertyName=o,this.handler=c}add(){const o=e.watch(this.propertyName,this.handler);this.removeHandler=o.remove}}const i=e[R],a=new t("extent",st((r,o)=>{i.emit("watch:extent",[r,o])},50));a.add(),w(()=>{a.remove()});const n=new t("scale",st((r,o)=>{i.emit("watch:scale",[r,o])},50));return n.add(),w(()=>{n.remove()}),()=>null}});function Ia(e){return{all:e=e||new Map,on:function(t,i){var a=e.get(t);a?a.push(i):e.set(t,[i])},off:function(t,i){var a=e.get(t);a&&(i?a.splice(a.indexOf(i)>>>0,1):e.set(t,[]))},emit:function(t,i){var a=e.get(t);a&&a.slice().map(function(n){n(i)}),(a=e.get("*"))&&a.slice().map(function(n){n(t,i)})}}}const ja={...Nt.props,defaultOptions:{type:Object,default:()=>({})},cursor:{type:String,default:""}},Wa={...Nt.emits,load:e=>e};var ka=m({name:"VaMapView",components:{ViewEvents:Xt,ViewWatchs:Jt},inheritAttrs:!1,props:ja,emits:Wa,setup(e,{emit:t}){const i=C(),a=new ct,n=new ui({map:a,...e.defaultOptions});n[R]=Ia(),n.ui.components=[],window.__VA_MAP_VIEW__=n;const r=C(""),o=P(()=>({"--va-map-view-cursor":e.cursor||r.value}));return v("vaView",n),v("vaMapView",n),ee(()=>{n.container=i.value,t("load",{view:n})}),w(()=>{n.destroy()}),{viewNode:i,eventCursor:r,cursorStyle:o}}}),Ha=(e,t)=>{const i=e.__vccOpts||e;for(const[a,n]of t)i[a]=n;return i};function Ba(e,t,i,a,n,r){const o=M("ViewEvents"),c=M("ViewWatchs");return T(),b(E,null,[y(e.$slots,"before"),dt("div",Z({ref:"viewNode",style:e.cursorStyle,class:"va-map-view va-view-x"},e.$attrs),[S(o,{cursor:e.eventCursor,"onUpdate:cursor":t[0]||(t[0]=l=>e.eventCursor=l)},null,8,["cursor"]),S(c),y(e.$slots,"default")],16),y(e.$slots,"after")],64)}var Ee=Ha(ka,[["render",Ba]]);Ee.install=e=>{e.component(Ee.name||"VaMapView",Ee)};function Oe(e,t){f(()=>{e.visible=t.visible}),ft(()=>{e.visible=!1}),pt(()=>{e.visible=t.visible})}const Q=e=>class extends de{constructor(i,a){super(),this.name=i,this.handler=a}add(){e.on(this.name,this.handler),this.removeHandler=()=>e.off(this.name,this.handler)}},Kt={maxScale:{type:Number,default:0},minScale:{type:Number,default:0},cursor:{type:String,default:""},title:{type:String,default:""},visible:{type:Boolean,default:!0},opacity:{type:Number,default:void 0},index:{type:Number,default:void 0},orphan:{type:Boolean,default:!1}},Ga=ue(Kt);var k=Object.freeze({__proto__:null,createBindProps:Ga,props:Kt});function Pa(e,t,i){const a=()=>e instanceof ct?e.layers:e;if(i.orphan)return;t[D]=i.index,t[ot]=i.indexTopping,e.add(t);const n=()=>{const r=a();Fa(r).forEach((c,l)=>{setTimeout(()=>{e.reorder(c,l)})})};t.when(()=>{n()}),typeof i.index=="number"&&n(),I(()=>[i.index,i.indexTopping],([r,o])=>{typeof r=="number"&&(t[D]=r,t[ot]=o,n())}),w(()=>{i.keepAlive||e.remove(t)})}function Qt(e,t){Oe(e,t),f(()=>{e.title=t.title}),f(()=>{e[mt]=t.cursor}),f(()=>{e.opacity=t.opacity})}function Aa(e,t){Qt(e,t),f(()=>{e[mt]=t.cursor}),f(()=>{e.title=t.title}),f(()=>{e.maxScale=t.maxScale}),f(()=>{e.minScale=t.minScale}),f(()=>{e.opacity=t.opacity})}function Da(e,t,i){const a=e[R];if(!a)throw new Error("mitter is not defined");const n=Q(a),r=new n("watch:scale",([o])=>{const c=lt(o,{maxScale:t.maxScale,minScale:t.minScale});i(c)});r.add(),w(()=>{r.remove()})}function Fa(e){const t=new Ct,i=new Ct;return e.forEach(a=>{const n=a[D];a[ot]?i.add(a,n):t.add(a,n)}),[...t.toArray(),...i.toArray()]}class Ct{constructor(){this.record={}}add(t,i){if(typeof i=="number"){let a=this.record[i];for(;a;)i++,a=this.record[i];this.record[i]=t}else this.record[this.getMaxIndex()+1]=t}getMaxIndex(){const t=Object.keys(this.record);return t.length?Math.max(...t.map(Number)):0}toArray(){return Object.values(this.record)}}var h=Object.freeze({__proto__:null,useAddLayer:Pa,useScaleVisibleHandler:Da,useSetLayerBasicOptions:Qt,useSetLayerOptions:Aa});const yt={click:e=>e,pointerMove:e=>e},Ua=te(yt);var ie=Object.freeze({__proto__:null,createOnEmits:Ua,emits:yt}),G=m({emits:yt,setup(e,{emit:t}){const i=x(),a=Le(),n=i[R],r=Q(n),o=new r("click",l=>{const{hitTestResult:s}=l,u=s.results.find(p=>p.type==="media"?p.layer===a:p.graphic?.layer===a);t("click",{...l,result:u,layer:a})});o.add(),w(()=>{o.remove()});const c=new r("pointer-move",l=>{const{hitTestResult:s}=l,u=s.results.find(p=>p.type==="media"?p.layer===a:p.graphic?.layer===a);t("pointerMove",{...l,result:u,layer:a})});return c.add(),w(()=>{c.remove()}),()=>null}});G.install=e=>{e.component(G.name,G)};const Na={...k.props,defaultOptions:{type:Object,default:()=>({})},url:{type:String,default:"",required:!0},geometryType:{type:String,required:!0,default:""},definitionExpression:{type:String,default:"1=1"},renderer:{type:Object,default:void 0}},qa={load:e=>e,click:e=>e,pointerMove:e=>e};function za(e){return{all:e=e||new Map,on:function(t,i){var a=e.get(t);a?a.push(i):e.set(t,[i])},off:function(t,i){var a=e.get(t);a&&(i?a.splice(a.indexOf(i)>>>0,1):e.set(t,[]))},emit:function(t,i){var a=e.get(t);a&&a.slice().map(function(n){n(i)}),(a=e.get("*"))&&a.slice().map(function(n){n(t,i)})}}}var Xa=m({name:"VaGeojsonLayer",components:{VaLayerHitEvents:G},props:Na,emits:qa,setup(e,{emit:t}){const i=x(),a=i.map,n=ie.createOnEmits(t),r=new di({url:e.url,...e.defaultOptions});return r[R]=za(),h.useSetLayerOptions(r,e),f(()=>{r.geometryType=e.geometryType}),f(()=>{e.renderer!==void 0&&(r.renderer=e.renderer)}),f(()=>{r.definitionExpression=e.definitionExpression}),h.useAddLayer(a,r,e),t("load",{view:i,layer:r}),v("vaLayer",r),v("vaGeojsonLayer",r),{layerEventsOnEmits:n}}}),Ja=(e,t)=>{const i=e.__vccOpts||e;for(const[a,n]of t)i[a]=n;return i};function Ka(e,t,i,a,n,r){const o=M("VaLayerHitEvents");return T(),b(E,null,[S(o,B(e.layerEventsOnEmits),null,16),y(e.$slots,"default")],64)}var Ie=Ja(Xa,[["render",Ka]]);Ie.install=e=>{e.component(Ie.name,Ie)};const Qa={baseLayers:{type:Array,default:()=>[]},spatialReference:{type:Object,default:void 0},orphan:{type:Boolean,default:!1},defaultOptions:{type:Object,default:()=>({})},thumbnailUrl:{type:String,default:""},keepAlive:{type:Boolean,default:!1}},Ya={load:e=>e};var pe=m({name:"VaBasemap",props:Qa,emits:Ya,setup(e,{emit:t,slots:i}){const a=x(),n=a.map,r=n.basemap,o=new fi({...e.defaultOptions});return f(()=>{o.baseLayers=e.baseLayers}),f(()=>{o.spatialReference=e.spatialReference||a.spatialReference}),f(()=>{o.thumbnailUrl=e.thumbnailUrl}),!e.orphan&&(n.basemap=o),w(()=>{e.keepAlive||n.basemap===o&&(n.basemap=r)}),v("vaBasemap",o),t("load",{view:a,basemap:o}),()=>i.default?.()}});pe.install=e=>{e.component(pe.name,pe)};const Yt={position:{type:[String,Object],default:"manual"},orphan:{type:Boolean,default:!1}},Zt={load:e=>e};var ei=Object.freeze({__proto__:null,emits:Zt,props:Yt});const ti=(e,t,i)=>{i.orphan||(f(()=>{e.add(t,i.position)}),ut(()=>{e.remove(t)}),pt(()=>{e.add(t,i.position)}),ft(()=>{e.remove(t)}))};var Ve=Object.freeze({__proto__:null,useAddUi:ti}),Za=m({name:"VaViewUi",props:Yt,emits:Zt,setup(e,{emit:t}){const i=x(),a=C(),n=C(!1);return ee(()=>{a.value&&(ti(i.ui,a.value,e),n.value=!0,v("vaViewUi",a.value),t("load",{view:i,el:a.value}))}),{viewUiNode:a,ready:n}}}),en=(e,t)=>{const i=e.__vccOpts||e;for(const[a,n]of t)i[a]=n;return i};const tn={ref:"viewUiNode",class:"va-view-ui"};function an(e,t,i,a,n,r){return T(),b("div",tn,[e.ready?y(e.$slots,"default",{key:0}):H("v-if",!0)],512)}var le=en(Za,[["render",an]]);le.install=e=>{e.component(le.name,le)};const nn={defaultOptions:{type:Object,default:()=>({})},position:{type:[String,Object],default:"bottom-right"},visible:{type:Boolean,default:!0}},rn={load:e=>e};var on=m({name:"VaBasemapToggle",emits:rn,props:nn,setup(e,{emit:t}){const i=x(),a=C(),n=new pi({view:i,...e.defaultOptions});return Oe(n,e),v("vaBasemapToggle",n),ee(()=>{n.container=a.value,Ve.useAddUi(i.ui,n,e),t("load",{view:i,basemapToggle:n})}),{toggleNode:a}}}),ln=(e,t)=>{const i=e.__vccOpts||e;for(const[a,n]of t)i[a]=n;return i};const sn={ref:"toggleNode"};function cn(e,t,i,a,n,r){return T(),b("div",sn,[y(e.$slots,"default")],512)}var je=ln(on,[["render",cn]]);je.install=e=>{e.component(je.name,je)};var me=m({name:"VaBasemapBaseLayers",props:{keepAlive:{type:Boolean,default:!1},index:{type:Number,default:void 0}},setup(e){const t=Dt(),i=Le();return h.useAddLayer(t.baseLayers,i,e),()=>null}});me.install=e=>{e.component(me.name,me)};var We=m({name:"VaBasemapToggleNextBasemap",setup(){const e=Dt(),t=ta(),i=t.nextBasemap;return t.nextBasemap=e,w(()=>{t.nextBasemap===e&&(t.nextBasemap=i)}),()=>null}});We.install=e=>{e.component(We.name,We)};var un=m({name:"VaSublayersProvider",setup(){const e=At();return v("vaSublayers",e.sublayers),{}}}),dn=(e,t)=>{const i=e.__vccOpts||e;for(const[a,n]of t)i[a]=n;return i};function fn(e,t,i,a,n,r){return y(e.$slots,"default")}var se=dn(un,[["render",fn]]);se.install=e=>{e.component(se.name,se)};const pn={layer:{type:Object,default:void 0}},mn={load:e=>e};var yn=m({name:"VaLayerWhen",props:pn,emits:mn,setup(e,{emit:t}){const i=x(),a=e.layer||Le(),n=C(!1);return a.when().then(()=>{n.value=!0,t("load",{view:i,layer:a})}),{ready:n,view:i,layer:a}}}),vn=(e,t)=>{const i=e.__vccOpts||e;for(const[a,n]of t)i[a]=n;return i};function hn(e,t,i,a,n,r){return e.ready?y(e.$slots,"default",{key:0,view:e.view,layer:e.layer}):H("v-if",!0)}var J=vn(yn,[["render",hn]]);J.install=e=>{e.component(J.name,J)};const Tn={...k.props,defaultOptions:{type:Object,default:()=>({})},url:{type:String,default:""}},gn={load:e=>e};var wn=m({name:"VaTileLayer",components:{VaLayerWhen:J,VaSublayersProvider:se},emits:gn,props:Tn,setup(e,{emit:t}){const i=x(),a=i.map,n=new mi({...e.defaultOptions});return f(()=>{n.url=e.url}),h.useSetLayerOptions(n,e),h.useAddLayer(a,n,e),v("vaLayer",n),v("vaTileLayer",n),t("load",{view:i,layer:n}),{}}}),Mn=(e,t)=>{const i=e.__vccOpts||e;for(const[a,n]of t)i[a]=n;return i};function xn(e,t,i,a,n,r){const o=M("VaSublayersProvider"),c=M("VaLayerWhen");return T(),b(E,null,[y(e.$slots,"default"),S(c,null,{default:W(()=>[S(o,null,{default:W(()=>[y(e.$slots,"when")]),_:3})]),_:3})],64)}var ke=Mn(wn,[["render",xn]]);ke.install=e=>{e.component(ke.name,ke)};const vt=[{level:0,levelValue:"0",resolution:1.4062500262315807,scale:590995197141669e-6},{level:1,levelValue:"1",resolution:.7031250131157915,scale:295497598570835e-6},{level:2,levelValue:"2",resolution:.3515625065578945,scale:147748799285417e-6},{level:3,levelValue:"3",resolution:.1757812532789475,scale:738743996427086e-7},{level:4,levelValue:"4",resolution:.08789062663947375,scale:369371998213543e-7},{level:5,levelValue:"5",resolution:.043945313319736994,scale:184685999106772e-7},{level:6,levelValue:"6",resolution:.02197265665986845,scale:923429995533858e-8},{level:7,levelValue:"7",resolution:.010986328329934226,scale:461714997766929e-8},{level:8,levelValue:"8",resolution:.005493164164967124,scale:230857498883465e-8},{level:9,levelValue:"9",resolution:.0027465820824835504,scale:115428749441732e-8},{level:10,levelValue:"10",resolution:.0013732910412417776,scale:577143.747208661},{level:11,levelValue:"11",resolution:.0006866455206208899,scale:288571.873604331},{level:12,levelValue:"12",resolution:.0003433227603104438,scale:144285.936802165},{level:13,levelValue:"13",resolution:.0001716613801552224,scale:72142.9684010827},{level:14,levelValue:"14",resolution:8583069007761132e-20,scale:36071.4842005414},{level:15,levelValue:"15",resolution:4291534503880566e-20,scale:18035.7421002707},{level:16,levelValue:"16",resolution:21457672519402802e-21,scale:9017.87105013534},{level:17,levelValue:"17",resolution:10728836259701401e-21,scale:4508.93552506767},{level:18,levelValue:"18",resolution:5364418129850712e-21,scale:2254.46776253384},{level:19,levelValue:"19",resolution:2682209064925356e-21,scale:1127.23388126692},{level:20,levelValue:"20",resolution:13411045321451153e-22,scale:563.6169405}],ii={x:-180,y:90},ce=vt.reduce((e,t)=>(e[t.level]=t.scale,e),{}),$n={xmin:-180,ymin:-90,xmax:180,ymax:90},_n=new _e({size:[256,256],origin:ii,lods:vt}),Rt=Object.freeze(Object.defineProperty({__proto__:null,fullExtent:$n,levelToScale:ce,lods:vt,origin:ii,tileInfo:_n},Symbol.toStringTag,{value:"Module"})),ht={...k.props,defaultOptions:{type:Object,default:()=>({})}},bn=ue(ht),Tt={load:e=>e},Sn=te(Tt);var $e=Object.freeze({__proto__:null,createBindProps:bn,createOnEmits:Sn,emits:Tt,props:ht}),ye=m({name:"VaWebTileLayer",props:ht,emits:Tt,setup(e,{emit:t,slots:i}){const a=x(),n=a.map,r=new yi({...e.defaultOptions});return h.useSetLayerOptions(r,e),h.useAddLayer(n,r,e),v("vaWebTileLayer",r),v("vaLayer",r),t("load",{view:a,layer:r}),()=>i.default?.()}});ye.install=e=>{e.component(ye.name,ye)};const gt=[{level:0,levelValue:"0",resolution:.703125,scale:2958287637958547e-7},{level:0,levelValue:"2",resolution:.3515625,scale:14791438189792734e-8},{level:1,levelValue:"3",resolution:.17578125,scale:7395719094896367e-8},{level:2,levelValue:"4",resolution:.087890625,scale:36978595474481836e-9},{level:3,levelValue:"5",resolution:.0439453125,scale:18489297737240918e-9},{level:4,levelValue:"6",resolution:.02197265625,scale:9244648868620459e-9},{level:5,levelValue:"7",resolution:.010986328125,scale:4.6223244343102295e6},{level:6,levelValue:"8",resolution:.0054931640625,scale:2.3111622171551147e6},{level:7,levelValue:"9",resolution:.00274658203125,scale:1.1555811085775574e6},{level:8,levelValue:"10",resolution:.001373291015625,scale:577790.5542887787},{level:9,levelValue:"11",resolution:.0006866455078125,scale:288895.27714438934},{level:10,levelValue:"12",resolution:.00034332275390625,scale:144447.63857219467},{level:11,levelValue:"13",resolution:.000171661376953125,scale:72223.81928609734},{level:12,levelValue:"14",resolution:858306884765625e-19,scale:36111.90964304867},{level:13,levelValue:"15",resolution:4291534423828125e-20,scale:18055.954821524334},{level:14,levelValue:"16",resolution:21457672119140625e-21,scale:9027.977410762167},{level:15,levelValue:"17",resolution:10728836059570312e-21,scale:4513.9887053810835},{level:16,levelValue:"18",resolution:5364418029785156e-21,scale:2256.9943526905417},{level:17,levelValue:"19",resolution:2682209014892578e-21,scale:1128.4971763452709},{level:18,levelValue:"20",resolution:13411045074463e-19,scale:564.248588172635}],ai={x:-180,y:90},Ln=gt.reduce((e,t)=>(e[t.level]=t.scale,e),{}),On={xmin:-180,ymin:-90,xmax:180,ymax:90},Vn=new _e({size:[256,256],origin:ai,lods:gt}),Et=Object.freeze(Object.defineProperty({__proto__:null,fullExtent:On,levelToScale:Ln,lods:gt,origin:ai,tileInfo:Vn},Symbol.toStringTag,{value:"Module"})),wt=[{level:0,resolution:156543.033928,scale:591657527591555e-6},{level:1,resolution:78271.5169639999,scale:295828763795777e-6},{level:2,resolution:39135.7584820001,scale:147914381897889e-6},{level:3,resolution:19567.8792409999,scale:73957190948944e-6},{level:4,resolution:9783.93962049996,scale:36978595474472e-6},{level:5,resolution:4891.96981024998,scale:18489297737236e-6},{level:6,resolution:2445.98490512499,scale:9244648868618e-6},{level:7,resolution:1222.99245256249,scale:4622324434309e-6},{level:8,resolution:611.49622628138,scale:2311162217155e-6},{level:9,resolution:305.748113140558,scale:1155581108577e-6},{level:10,resolution:152.874056570411,scale:577790.554289},{level:11,resolution:76.4370282850732,scale:288895.277144},{level:12,resolution:38.2185141425366,scale:144447.638572},{level:13,resolution:19.1092570712683,scale:72223.819286},{level:14,resolution:9.55462853563415,scale:36111.909643},{level:15,resolution:4.77731426794937,scale:18055.954822},{level:16,resolution:2.38865713397468,scale:9027.977411},{level:17,resolution:1.19432856685505,scale:4513.988705},{level:18,resolution:.597164283559817,scale:2256.994353},{level:19,resolution:.298582141647617,scale:1128.497176},{level:20,resolution:.14929107082380833,scale:564.248588},{level:21,resolution:.07464553541190416,scale:282.124294},{level:22,resolution:.03732276770595208,scale:141.062147},{level:23,resolution:.01866138385297604,scale:70.5310735}],Cn={x:-20037508342787e-6,y:20037508342787e-6},Rn=wt.reduce((e,t)=>(e[t.level]=t.scale,e),{}),En={xmin:-20037508342787e-6,ymin:-2003750834278e-5,xmax:2003750834278e-5,ymax:20037508342787e-6},In=new _e({dpi:96,origin:{spatialReference:{wkid:3857},x:-20037508342787e-6,y:20037508342787e-6},lods:wt,size:[256,256],spatialReference:{wkid:3857}}),X=Object.freeze(Object.defineProperty({__proto__:null,fullExtent:En,levelToScale:Rn,lods:wt,origin:Cn,tileInfo:In},Symbol.toStringTag,{value:"Module"})),jn={...$e.props,type:{type:String,default:"img_c"},spatialReference:{type:Object,default:()=>({wkid:4326})},token:{type:String,default:"f0175927031c1e12cb804b0c3b8cce4d"},minScale:{type:Number,default:ce[1]},maxScale:{type:Number,default:ce[18]},tileInfoVersion:{type:Number,default:2},baseUrlTemplate:{type:String,default:"https://{subDomain}.tianditu.gov.cn"}},Wn={...$e.emits},kn={1:{4326:Rt,4490:Rt,3857:X,102100:X,4549:X},2:{4326:Et,4490:Et,3857:X,102100:X,4549:X}};var Hn=m({name:"VaTdtWebTileLayer",components:{VaWebTileLayer:ye},props:jn,emits:Wn,setup(e,{emit:t}){const i=["t0","t1","t2","t3","t4","t5","t6","t7"],a=P(()=>{const l=e.type.split("_"),s=l[0],d=l[1];return{baseLayer:s,typeSR:d}}),n=P(()=>{const l=e.spatialReference.wkid,s=kn[e.tileInfoVersion][l],d={origin:s.origin,spatialReference:e.spatialReference,size:s.tileInfo.size};d.lods=s.lods.slice(1,19);const u={subDomains:i,urlTemplate:e.baseUrlTemplate+`/${e.type}/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=${a.value.baseLayer}&STYLE=default&TILEMATRIXSET=${a.value.typeSR}&FORMAT=tiles&TILEMATRIX={level}&TILEROW={row}&TILECOL={col}&tk=${e.token}`,tileInfo:d,spatialReference:e.spatialReference,...e.defaultOptions};return console.log("defaultOptions",u),s.fullExtent&&(u.fullExtent=new we({...s.fullExtent,spatialReference:e.spatialReference})),u}),r=$e.createBindProps(e,["defaultOptions"]),o=$e.createOnEmits(t),c=C(!0);return I(()=>e.type,async()=>{c.value=!1,await be(),c.value=!0}),{defaultOptions:n,coreProps:r,coreEmits:o,ready:c}}}),Bn=(e,t)=>{const i=e.__vccOpts||e;for(const[a,n]of t)i[a]=n;return i};function Gn(e,t,i,a,n,r){const o=M("VaWebTileLayer");return e.ready?(T(),F(o,Z({key:0,"default-options":e.defaultOptions},e.coreProps,B(e.coreEmits)),{default:W(()=>[y(e.$slots,"default")]),_:3},16,["default-options"])):H("v-if",!0)}var ve=Bn(Hn,[["render",Gn]]);ve.install=e=>{e.component(ve.name,ve)};const Pn={spatialReference:{type:Object,default:()=>({wkid:4326})},type:{type:String,default:"img_c"},orphan:{type:Boolean,default:!1},anno:{type:Boolean,default:!0},thumbnailUrl:{type:String,default:""},minScale:{type:Number,default:ce[1]},maxScale:{type:Number,default:ce[18]},token:{type:String,default:void 0},webTileLayerOptions:{type:Object,default:()=>({})},keepAlive:{type:Boolean,default:!1},baseUrlTemplate:{type:String,default:"https://{subDomain}.tianditu.gov.cn"}},An={load:e=>e};var Dn=m({name:"VaTdtBasemap",components:{VaBasemap:pe,VaBasemapBaseLayers:me,VaTdtWebTileLayer:ve},props:Pn,emits:An,setup(e){const t=P(()=>{const a=e.type.split("_"),n=a[0],r=a[1];return`c${n[0]}a_${r}`});return{thumbnailUrl:P(()=>e.thumbnailUrl?e.thumbnailUrl:e.type.startsWith("vec")?"http://lbs.tianditu.gov.cn/images/vec_c.png":e.type.startsWith("img")?"http://lbs.tianditu.gov.cn/images/img_c.png":""),annoType:t}}}),Fn=(e,t)=>{const i=e.__vccOpts||e;for(const[a,n]of t)i[a]=n;return i};function Un(e,t,i,a,n,r){const o=M("VaBasemapBaseLayers"),c=M("VaTdtWebTileLayer"),l=M("VaBasemap");return T(),F(l,{"keep-alive":e.keepAlive,orphan:e.orphan,"thumbnail-url":e.thumbnailUrl,onLoad:t[0]||(t[0]=s=>e.$emit("load",s))},{default:W(()=>[H(" layer "),S(c,{"default-options":e.webTileLayerOptions,type:e.type,orphan:!0,"spatial-reference":e.spatialReference,"max-scale":e.maxScale,"min-scale":e.minScale,token:e.token,title:"tdt_web_tile_layer","base-url-template":e.baseUrlTemplate},{default:W(()=>[S(o,{"keep-alive":e.keepAlive},null,8,["keep-alive"])]),_:1},8,["default-options","type","spatial-reference","max-scale","min-scale","token","base-url-template"]),H(" anno "),e.anno?(T(),F(c,{key:0,type:e.annoType,orphan:!0,"spatial-reference":e.spatialReference,"max-scale":e.maxScale,"min-scale":e.minScale,token:e.token,"default-options":e.webTileLayerOptions,"base-url-template":e.baseUrlTemplate,title:"tdt_web_tile_layer_anno"},{default:W(()=>[S(o,{"keep-alive":e.keepAlive},null,8,["keep-alive"])]),_:1},8,["type","spatial-reference","max-scale","min-scale","token","default-options","base-url-template"])):H("v-if",!0),y(e.$slots,"default")]),_:3},8,["keep-alive","orphan","thumbnail-url"])}var K=Fn(Dn,[["render",Un]]);K.install=e=>{e.component(K.name,K)};K.install=e=>{e.component(K.name,K)};function Nn(e,t){h.useSetLayerOptions(e,t),f(()=>{t.renderer!==void 0&&(e.renderer=t.renderer)}),f(()=>{e.definitionExpression=t.definitionExpression}),f(()=>{e.popupEnabled=t.popupEnabled})}function qn(e,t,i){f(()=>{e.when(()=>{t.spatialReference=i.spatialReference||e.spatialReference})})}var Y=Object.freeze({__proto__:null,useSetLayerOptions:Nn,useSetLayerSpatialReference:qn});const ni={...k.props,renderer:{type:Object,default:void 0},definitionExpression:{type:String,default:"1=1"},popupEnabled:{type:Boolean,default:!0},defaultOptions:{type:Object,default:()=>({})},spatialReference:{type:Object,default:void 0}},zn=ue(ni),ri={click:e=>e,pointerMove:e=>e},Xn=te(ri);var N=Object.freeze({__proto__:null,createBindProps:zn,createOnEmits:Xn,emits:ri,props:ni});const Jn={...N.props,url:{type:String,default:"",require:!0},layerId:{type:Number,default:void 0}},Kn={...N.emits,load:e=>e};function Qn(e){return{all:e=e||new Map,on:function(t,i){var a=e.get(t);a?a.push(i):e.set(t,[i])},off:function(t,i){var a=e.get(t);a&&(i?a.splice(a.indexOf(i)>>>0,1):e.set(t,[]))},emit:function(t,i){var a=e.get(t);a&&a.slice().map(function(n){n(i)}),(a=e.get("*"))&&a.slice().map(function(n){n(t,i)})}}}var Yn=m({name:"VaServerFeatureLayer",components:{VaLayerHitEvents:G},props:Jn,emits:Kn,setup(e,{emit:t}){const i=x(),a=i.map,n=ie.createOnEmits(t),r=new Wt({...e.defaultOptions});return r[R]=Qn(),f(()=>{r.url=e.url}),f(()=>{e.layerId&&(r.layerId=e.layerId)}),Y.useSetLayerOptions(r,e),Y.useSetLayerSpatialReference(i,r,e),h.useAddLayer(a,r,e),v("vaLayer",r),v("vaFeatureLayer",r),t("load",{view:i,layer:r}),{hitEmits:n}}}),Zn=(e,t)=>{const i=e.__vccOpts||e;for(const[a,n]of t)i[a]=n;return i};function er(e,t,i,a,n,r){const o=M("VaLayerHitEvents");return T(),b(E,null,[S(o,B(e.hitEmits),null,16),y(e.$slots,"default")],64)}var He=Zn(Yn,[["render",er]]);He.install=e=>{e.component(He.name||"VaServerFeatureLayer",He)};const tr={load:e=>e};var ir=m({name:"VaViewWhen",emits:tr,setup(e,{emit:t}){const i=x(),a=C(!1);i.when().then(()=>{a.value=!0,t("load",{view:i})});function n(r){return i.map.layers.find(o=>o.title===r)}return{ready:a,view:i,getLayerByTitle:n}}}),ar=(e,t)=>{const i=e.__vccOpts||e;for(const[a,n]of t)i[a]=n;return i};function nr(e,t,i,a,n,r){return e.ready?y(e.$slots,"default",{key:0,view:e.view,spatialReference:e.view.spatialReference,map:e.view.map,layers:e.view.map.layers,getLayerByTitle:e.getLayerByTitle}):H("v-if",!0)}var Be=ar(ir,[["render",nr]]);Be.install=e=>{e.component(Be.name,Be)};const rr={defaultOptions:{type:Object,default:()=>({})},cursor:{type:String,default:""}},or={load:e=>e};function lr(e){return{all:e=e||new Map,on:function(t,i){var a=e.get(t);a?a.push(i):e.set(t,[i])},off:function(t,i){var a=e.get(t);a&&(i?a.splice(a.indexOf(i)>>>0,1):e.set(t,[]))},emit:function(t,i){var a=e.get(t);a&&a.slice().map(function(n){n(i)}),(a=e.get("*"))&&a.slice().map(function(n){n(t,i)})}}}var sr=m({name:"VaSceneView",components:{ViewEvents:Xt,ViewWatchs:Jt},inheritAttrs:!1,props:rr,emits:or,setup(e,{emit:t}){const i=C(),a=new ct,n=new vi({map:a,...e.defaultOptions});n[R]=lr(),n.ui.components=[],window.__VA_SCENE_VIEW__=n;const r=C(""),o=P(()=>({"--va-scene-view-cursor":e.cursor||r.value}));return v("vaView",n),v("vaSceneView",n),ee(()=>{n.container=i.value,t("load",{view:n})}),w(()=>{n.destroy()}),{viewNode:i,eventCursor:r,cursorStyle:o}}}),cr=(e,t)=>{const i=e.__vccOpts||e;for(const[a,n]of t)i[a]=n;return i};function ur(e,t,i,a,n,r){const o=M("ViewEvents"),c=M("ViewWatchs");return T(),b(E,null,[y(e.$slots,"before"),dt("div",Z({ref:"viewNode",style:e.cursorStyle,class:"va-scene-view va-view-x"},e.$attrs),[S(o,{cursor:e.eventCursor,"onUpdate:cursor":t[0]||(t[0]=l=>e.eventCursor=l)},null,8,["cursor"]),S(c),y(e.$slots,"default")],16),y(e.$slots,"after")],64)}var Ge=cr(sr,[["render",ur]]);Ge.install=e=>{e.component(Ge.name||"VaSceneView",Ge)};const oi={...N.props,source:{type:[Object,Array],required:!0,default:()=>[]},fields:{type:Array,required:!0,default:()=>[]},geometryType:{type:String,default:"point",required:!0},objectIdField:{type:String,default:"ObjectID"},forceUpdate:{type:Boolean,default:!1}},Mt={...N.emits,change:e=>e,load:e=>e},dr=te(Mt);var li=Object.freeze({__proto__:null,createOnEmits:dr,emits:Mt,props:oi});function fr(e){return{all:e=e||new Map,on:function(t,i){var a=e.get(t);a?a.push(i):e.set(t,[i])},off:function(t,i){var a=e.get(t);a&&(i?a.splice(a.indexOf(i)>>>0,1):e.set(t,[]))},emit:function(t,i){var a=e.get(t);a&&a.slice().map(function(n){n(i)}),(a=e.get("*"))&&a.slice().map(function(n){n(t,i)})}}}var pr=m({name:"VaClientFeatureLayer",components:{VaLayerHitEvents:G},props:oi,emits:Mt,setup(e,{emit:t}){const i=x(),a=i.map,n=ie.createOnEmits(t),r=new Wt({source:e.source,...e.defaultOptions});r[R]=fr();const o=r[R];return Y.useSetLayerOptions(r,e),Y.useSetLayerSpatialReference(i,r,e),f(()=>{r.geometryType=e.geometryType}),f(()=>{r.objectIdField=e.objectIdField}),f(()=>{r.fields=e.fields}),h.useAddLayer(a,r,e),I(()=>e.source,(c,l)=>{be().then(()=>{const s=[],d=c.reduce((_,g)=>{const O=g.attributes[e.objectIdField];return _[O]=g,_},{}),u=l.reduce((_,g)=>{const O=g.attributes[e.objectIdField];return Reflect.has(d,O)?(s.push(g),Reflect.deleteProperty(d,O)):_[O]=g,_},{}),p=[],$=[];for(const _ in d)p.push(d[_]);for(const _ in u)$.push(u[_]);return{addFeatures:p,deleteFeatures:$,updateFeatures:s}}).then(s=>r.applyEdits(s)).then(()=>(e.forceUpdate&&(r.visible=!1,r.visible=!0),{view:i,layer:r})).then(s=>{o.emit("change",s),t("change",s)})}),v("vaLayer",r),v("vaFeatureLayer",r),t("load",{view:i,layer:r}),{hitEmits:n}}}),mr=(e,t)=>{const i=e.__vccOpts||e;for(const[a,n]of t)i[a]=n;return i};function yr(e,t,i,a,n,r){const o=M("VaLayerHitEvents");return T(),b(E,null,[S(o,B(e.hitEmits),null,16),y(e.$slots,"default")],64)}var he=mr(pr,[["render",yr]]);he.install=e=>{e.component(he.name,he)};const vr={...N.props,query:{type:Object,default:void 0}},hr={...li.emits};var Tr=m({name:"VaDerivedFeatureLayer",components:{VaClientFeatureLayer:he,VaLayerWhen:J},emits:hr,props:vr,setup(e,{emit:t}){const i=ia(),a=N.createBindProps(e,["renderer"]),n=li.createOnEmits(t),r=Se([]);return I(()=>e.query&&{...e.query},o=>{o?i.queryFeatures({where:"1=1",returnGeometry:!0,outFields:["*"],outSpatialReference:i.spatialReference,...o}).then(c=>{r.value=c.features}):r.value=[]},{immediate:!0}),{source:r,featureLayerProps:a,clientFeatureLayerOnEmit:n}}}),gr=(e,t)=>{const i=e.__vccOpts||e;for(const[a,n]of t)i[a]=n;return i};function wr(e,t,i,a,n,r){const o=M("VaClientFeatureLayer"),c=M("VaLayerWhen");return T(),F(c,null,{default:W(({layer:l})=>[S(o,Z({"object-id-field":l.objectIdField,"geometry-type":l.geometryType,fields:l.fields,source:e.source,renderer:e.renderer||l.renderer},e.featureLayerProps,B(e.clientFeatureLayerOnEmit)),{default:W(()=>[y(e.$slots,"default")]),_:2},1040,["object-id-field","geometry-type","fields","source","renderer"])]),_:3})}var Pe=gr(Tr,[["render",wr]]);Pe.install=e=>{e.component(Pe.name,Pe)};const Mr={...k.props,defaultOptions:{type:Object,default:()=>({})},graphics:{type:[Array,Object],default:()=>[]}},xr={click:e=>e,pointerMove:e=>e,load:e=>e};var $r=m({name:"VaGraphicsLayer",components:{VaLayerHitEvents:G},props:Mr,emits:xr,setup(e,{emit:t}){const i=x(),a=i.map,n=ie.createOnEmits(t),r=new kt({...e.defaultOptions});return f(()=>{r.graphics=e.graphics}),h.useSetLayerOptions(r,e),h.useAddLayer(a,r,e),v("vaLayer",r),v("vaGraphicsLayer",r),t("load",{view:i,layer:r}),{eventsOnEmits:n}}}),_r=(e,t)=>{const i=e.__vccOpts||e;for(const[a,n]of t)i[a]=n;return i};function br(e,t,i,a,n,r){const o=M("VaLayerHitEvents");return T(),b(E,null,[S(o,B(e.eventsOnEmits),null,16),y(e.$slots,"default")],64)}var Ae=_r($r,[["render",br]]);Ae.install=e=>{e.component(Ae.name,Ae)};const xt={click:e=>e},Sr=te(xt);var si=Object.freeze({__proto__:null,createOnEmits:Sr,emits:xt}),Te=m({emits:xt,setup(e,{emit:t}){const i=x(),a=na(),n=i[R],r=Q(n),o=new r("click",c=>{const{hitTestResult:l}=c,s=l.results;let d;s[0]?.graphic===a&&(d=s[0]),t("click",{...c,result:d,graphic:a})});return o.add(),w(()=>{o.remove()}),()=>null}});Te.install=e=>{e.component(Te.name,Te)};const Lr={defaultOptions:{type:Object,default:()=>({})},geometry:{type:Object,default:null},symbol:{type:Object,default:()=>({type:"simple-marker",color:[226,119,40]})},attributes:{type:Object,default:()=>({})},visible:{type:Boolean,default:!0},spatialReference:{type:Object,default:void 0},index:{type:Number,default:void 0},orphan:{type:Boolean,default:!1}},Or={...si.emits,load:e=>e};function Vr(e,t,i){if(i.orphan)return;t[D]=i.index,e.add(t,i.index);const a=n=>{e.forEach(r=>{r[D]>n&&setTimeout(()=>{e.reorder(r,r[D])})})};typeof i.index=="number"&&a(i.index),I(()=>i.index,n=>{typeof n=="number"&&(t[D]=i.index,e.reorder(t,n),a(n))}),w(()=>{e.remove(t)})}var Cr=m({name:"VaGraphic",components:{VaGraphicHitEvents:Te},emits:Or,props:Lr,setup(e,{emit:t}){const i=x(),n=V("vaGraphicsLayer",null)?.graphics||i.graphics,r=si.createOnEmits(t),o=new hi({...e.defaultOptions});return Oe(o,e),f(()=>{const c=e.geometry?.spatialReference;o.geometry=e.geometry,!c&&o.geometry&&i.when(()=>{o.geometry.spatialReference=e.spatialReference||i.spatialReference})}),f(()=>{o.attributes=e.attributes}),f(()=>{e.symbol&&(o.symbol=e.symbol)}),Vr(n,o,e),v("vaGraphic",o),t("load",{view:i,graphic:o}),{eventsOnEmits:r,graphic:o}}}),Rr=(e,t)=>{const i=e.__vccOpts||e;for(const[a,n]of t)i[a]=n;return i};function Er(e,t,i,a,n,r){const o=M("VaGraphicHitEvents");return T(),b(E,null,[S(o,B(e.eventsOnEmits),null,16),y(e.$slots,"default",{graphic:e.graphic,geometry:e.graphic.geometry,attributes:e.graphic.attributes})],64)}var De=Rr(Cr,[["render",Er]]);De.install=e=>{e.component(De.name,De)};const Ir={geometry:{type:Object,default:void 0},visible:{type:Boolean,default:!0},outContainsShow:{type:Boolean,default:!1},position:{type:[String,Object],default:"manual"},orphan:{type:Boolean,default:!1}},jr={};var Wr=m({name:"VaGeoViewUi",components:{VaViewUi:le},emits:jr,props:Ir,setup(e){const t=x(),i=t[R],a=Q(i),n={point(u){return u},extent(u){return u.center},mesh(u){return u.extent.center},multipoint(u){return u.extent.center},polygon(u){return u.extent.center},polyline(u){return u.extent.center}},r=P(()=>e.geometry?.type&&n[e.geometry.type](e.geometry)),o=C(!0),c=Se(),l=()=>{let u=r.value?t.toScreen(r.value):{x:0,y:0};c.value=u};l();const s=new a("watch:extent",([u])=>{if(e.visible&&r.value){if(!e.outContainsShow&&!u.contains(r.value))return o.value=!1;l(),o.value=!0}});s.add(),w(()=>{s.remove()}),I(()=>r.value,()=>{l()});const d=P(()=>e.visible?o.value:!1);return{screenPoint:c,visible:d,setScreenPoint:l}}}),kr=(e,t)=>{const i=e.__vccOpts||e;for(const[a,n]of t)i[a]=n;return i};function Hr(e,t,i,a,n,r){const o=M("VaViewUi");return Ht((T(),F(o,{class:"va-geo-view-ui",style:Di({left:e.screenPoint?.x+"px",top:e.screenPoint?.y+"px"}),position:e.position,orphan:e.orphan},{default:W(()=>[y(e.$slots,"default")]),_:3},8,["style","position","orphan"])),[[Bt,e.visible]])}var ge=kr(Wr,[["render",Hr]]);ge.install=e=>{e.component(ge.name,ge)};Ti(gi.getLogger("esri.rasterRenderers"),"esri.rasterRenderers",{replacement:"Individual raster renderer module imports",version:"4.32",warnOnce:!0});const Br={defaultOptions:{type:Object,default:()=>({})},title:{type:[String,Function,Promise],default:""},orphan:{type:Boolean,default:!1}},Gr={load:e=>e};var Pr=m({name:"VaPopupTemplate",props:Br,emits:Gr,setup(e,{emit:t}){const i=x(),a=V("vaSublayer",null)||V("vaLayer",null),n=a?.popupTemplate,r=C(new Map),o=new wi({outFields:["*"],async content(l){const s=l.graphic.attributes;return Fi(l.graphic),r.value.set(l.graphic,{el:null,attributes:s}),await be(),r.value.get(l.graphic)?.el},...e.defaultOptions});f(()=>{o.title=e.title}),a&&!e.orphan&&(a.popupTemplate=o),w(()=>{a&&(a.popupTemplate=n)});const c=Mi(()=>i.popup.visible,l=>{l||r.value.clear()});return w(()=>{c.remove()}),t("load",{view:i,popupTemplate:o}),v("vaPopupTemplate",o),{graphicToNode:r,setRef:(l,s)=>l.el=s}}}),Ar=(e,t)=>{const i=e.__vccOpts||e;for(const[a,n]of t)i[a]=n;return i};function Dr(e,t,i,a,n,r){return T(),b(E,null,[Ht(dt("div",null,[H(" key为func(), 节点会更新 ? "),(T(!0),b(E,null,Gt(e.graphicToNode.entries(),([o,c])=>(T(),b("div",{key:o.getObjectId(),ref_for:!0,ref:l=>e.setRef(c,l)},[y(e.$slots,"default",{attributes:c.attributes,geometry:o.geometry,graphic:o})]))),128))],512),[[Bt,!1]]),y(e.$slots,"plugins"),y(e.$slots,"extends")],64)}var Fe=Ar(Pr,[["render",Dr]]);Fe.install=e=>{e.component(Fe.name,Fe)};const Fr={query:{type:Object,default:{}},visible:{type:Boolean,default:void 0},maxScale:{type:Number,default:0},minScale:{type:Number,default:0},queryExtent:{type:Boolean,default:!1}},Ur={"update:visible":e=>typeof e=="boolean",load:e=>e,change:e=>e};function Nr(e){return typeof e=="function"?e():qi(e)}typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const It=()=>{};function qr(e,t){function i(...a){return new Promise((n,r)=>{Promise.resolve(e(()=>t.apply(this,a),{fn:t,thisArg:this,args:a})).then(n).catch(r)})}return i}const zr=e=>e();function Xr(...e){let t=0,i,a=!0,n=It,r,o,c,l,s;!Ni(e[0])&&typeof e[0]=="object"?{delay:o,trailing:c=!0,leading:l=!0,rejectOnCancel:s=!1}=e[0]:[o,c=!0,l=!0,s=!1]=e;const d=()=>{i&&(clearTimeout(i),i=void 0,n(),n=It)};return p=>{const $=Nr(o),_=Date.now()-t,g=()=>r=p();return d(),$<=0?(t=Date.now(),g()):(_>$&&(l||!a)?(t=Date.now(),g()):c&&(r=new Promise((O,j)=>{n=s?j:O,i=setTimeout(()=>{t=Date.now(),a=!0,O(g()),d()},Math.max(0,$-_))})),!l&&!i&&(i=setTimeout(()=>a=!0,$)),a=!1,r)}}function Jr(e,t,i={}){const{eventFilter:a=zr,...n}=i;return I(e,qr(a,t),n)}function Kr(e,t,i={}){const{throttle:a=0,trailing:n=!0,leading:r=!0,...o}=i;return Jr(e,t,{...o,eventFilter:Xr(a,n,r)})}const jt=Symbol("key");var Qr=m({name:"VaFeaturePopupLayer",components:{VaGeoViewUi:ge,VaViewUi:le},inheritAttrs:!1,props:Fr,emits:Ur,setup(e,{emit:t}){const i=x(),a=Le(),n=Q(i[R]),r=Ui({default:lt(i.scale,{maxScale:e.maxScale,minScale:e.minScale}),key:"visible"},e,t),o=Se([]),c=Pt({}),l=async()=>{if(r.value)return await i.when(),a.queryFeatures({returnGeometry:!0,outFields:["*"],where:"1=1",geometry:c.current,outSpatialReference:i.spatialReference,...e.query}).then(u=>(o.value=u.features.map(p=>(p[jt]=p.attributes[a.objectIdField],p)),c.queried=c.current,u))};l().then(u=>{t("load",{featureSet:u,view:i,layer:a})}),I(()=>r.value,u=>{u&&(c.current=c.view,l())}),I(()=>({geometry:c.current,...e.query}),async()=>{await l().then(u=>{t("change",{featureSet:u,view:i,layer:a})})}),Kr(()=>c.view,async u=>{if(u&&r.value){if(!c.queried){c.current=u;return}c.queried.contains(u)||(c.current=c.queried.union(u).clone())}},{throttle:1e3});const s=new n("watch:scale",([u])=>{r.value=lt(u,{maxScale:e.maxScale,minScale:e.minScale})});s.add(),w(()=>{s.remove()});const d=new n("watch:extent",([u])=>{c.view=u});if(I(()=>e.queryExtent,()=>{e.queryExtent?d.add():d.remove()},{immediate:!0}),w(()=>{d.remove()}),a[R]){const u=Q(a[R]),p=new u("change",async()=>{o.value=[],await be(),await l()});p.add(),w(()=>{p.remove()})}return{visible:r,features:o,layer:a,sKey:jt}}}),Yr=(e,t)=>{const i=e.__vccOpts||e;for(const[a,n]of t)i[a]=n;return i};function Zr(e,t,i,a,n,r){const o=M("VaGeoViewUi"),c=M("VaViewUi");return T(),F(c,{class:"feature-popup-layer"},{default:W(()=>[(T(!0),b(E,null,Gt(e.features,l=>(T(),F(o,Z({ref_for:!0},e.$attrs,{key:l[e.sKey],class:"feature-popup-layer__item",visible:e.visible,geometry:l.geometry,orphan:!0}),{default:W(()=>[y(e.$slots,"default",{attributes:l?.attributes??{},geometry:l.geometry})]),_:2},1040,["visible","geometry"]))),128))]),_:3})}var Ue=Yr(Qr,[["render",Zr]]);Ue.install=e=>{e.component(Ue.name,Ue)};const $t={modelValue:{type:[Array,Object],default:()=>[]},multiple:{type:Boolean,default:!0}},eo=ue($t),_t={"update:modelValue":e=>e,complete:e=>e,update:e=>!0,create:e=>!0},to=te(_t),io={...$t,defaultOptions:{type:Object,default:()=>({})},availableCreatureTools:{type:Array,default:void 0},position:{type:String,default:"top-right"},orphan:{type:Boolean,default:!1},modelValueInitFrom:{type:String,default:"modelValue"},viewModelPointSymbol:{type:Object},viewModelPolygonSymbol:{type:Object},viewModelPolylineSymbol:{type:Object},viewModelActiveFillSymbol:{type:Object},visibleElements:{type:Object,default:void 0}},ao=eo,no={load:e=>e,..._t},ro=to;var oo=m({props:$t,emits:_t,setup(e,{emit:t}){const i=ra(),a=aa(),n=i.on("create",o=>{t("create",o),o.state==="start"?e.multiple||a.removeAll():o.state==="complete"&&(!e.multiple&&a.graphics.length>1&&o.graphic.geometry.type==="point"&&a.remove(a.graphics.getItemAt(0)),t("update:modelValue",[...a.graphics]),t("complete",o))});w(()=>{n.remove()});const r=i.on("update",o=>{t("update",o),o.state==="complete"&&(t("update:modelValue",[...a.graphics]),t("complete",o))});return w(()=>{r.remove()}),()=>null}}),lo=m({name:"VaSketch",components:{Events:oo},props:io,emits:no,setup(e,{emit:t}){const i=x(),a=i.map;let n=V("vaGraphicsLayer",null);n||(n=new kt,a.add(n),w(()=>{a.remove(n)}));const r=ao(e),o=ro(t);function c(p){n.removeAll(),n.addMany(p)}I(()=>e.modelValue,(p,$)=>{let _=!1;if(p.length===$.length){for(let g=0;g<p.length;g++)if(p[g]!==$[g]){_=!0;break}}else _=!0;_&&c([...p])}),e.modelValueInitFrom==="layerGraphics"?t("update:modelValue",n.graphics):c(e.modelValue);const l=C(),s=C(!1);class d extends de{toggleVisible(){a.ground.layers.forEach($=>{$.visible=!$.visible})}add(){this.toggleVisible(),this.removeHandler=this.toggleVisible.bind(this)}}const u=new d;return ee(()=>{const p=new xi({container:l.value,view:i,layer:n,creationMode:"single",...e.defaultOptions});f(()=>{e.visibleElements&&(p.visibleElements=e.visibleElements)}),f(()=>{e.viewModelPointSymbol&&(p.viewModel.pointSymbol=e.viewModelPointSymbol)}),f(()=>{e.viewModelPolylineSymbol&&(p.viewModel.polylineSymbol=e.viewModelPolylineSymbol)}),f(()=>{e.viewModelPolygonSymbol&&(p.viewModel.polygonSymbol=e.viewModelPolygonSymbol)}),f(()=>{e.viewModelActiveFillSymbol&&(p.viewModel.activeFillSymbol=e.viewModelActiveFillSymbol)}),f(()=>{e.availableCreatureTools&&(p.availableCreateTools=e.availableCreatureTools)}),w(()=>{p.destroy()}),Ve.useAddUi(i.ui,p,e),v("vaGraphicsLayer",n),v("vaSketch",p),s.value=!0,u.add(),p.when(()=>{u.remove()}),t("load",{sketch:p,view:i})}),{eventsBindProps:r,eventsOnEmits:o,sketchNode:l,ready:s}}}),so=(e,t)=>{const i=e.__vccOpts||e;for(const[a,n]of t)i[a]=n;return i};const co={ref:"sketchNode"};function uo(e,t,i,a,n,r){const o=M("Events");return T(),b("div",co,[e.ready?(T(),b(E,{key:0},[S(o,Z(e.eventsBindProps,B(e.eventsOnEmits)),null,16),y(e.$slots,"default")],64)):H("v-if",!0)],512)}var Ne=so(lo,[["render",uo]]);Ne.install=e=>{e.component(Ne.name,Ne)};const fo={...k.props,url:{type:String,default:""},defaultOptions:{type:Object,default:()=>({})},sublayers:{type:Array,default:void 0}},po={load:e=>e};var mo=m({name:"VaMapImageLayer",components:{VaLayerWhen:J,VaSublayersProvider:se},emits:po,props:fo,setup(e,{emit:t}){const i=x(),a=i.map,n=new $i({...e.defaultOptions});return f(()=>{n.url=e.url}),f(()=>{e.sublayers&&(n.sublayers=e.sublayers)}),h.useSetLayerOptions(n,e),h.useAddLayer(a,n,e),v("vaLayer",n),v("vaMapImageLayer",n),t("load",{view:i,layer:n}),{}}}),yo=(e,t)=>{const i=e.__vccOpts||e;for(const[a,n]of t)i[a]=n;return i};function vo(e,t,i,a,n,r){const o=M("VaSublayersProvider"),c=M("VaLayerWhen");return T(),b(E,null,[y(e.$slots,"default"),S(c,null,{default:W(l=>[S(o,null,{default:W(()=>[y(e.$slots,"when",zi(Xi(l)))]),_:2},1024)]),_:3})],64)}var qe=yo(mo,[["render",vo]]);qe.install=e=>{e.component(qe.name,qe)};const ho={...k.props,defaultOptions:{type:Object,default:()=>({})},id:{type:Number,default:0},renderer:{type:Object,default:void 0},definitionExpression:{type:String,default:"1=1"}},To={load:e=>e};var go=m({name:"VaSublayer",props:ho,emits:To,setup(e,{emit:t}){const i=U(),a=Qi(),n=At(),r=new _i({...e.defaultOptions}),o=r.when(),c=l().then(s=>{r.set("fullExtent",s.extent)});r.when=async function(...s){const[d,u]=s;return c.then(()=>o).then(p=>(d?.(p),p)).catch(p=>{u?.(p)})},f(()=>{r.id=e.id}),f(()=>{e.renderer!==void 0&&(r.renderer=e.renderer)}),f(()=>{r.definitionExpression=e.definitionExpression}),h.useSetLayerOptions(r,e),h.useAddLayer(a,r,e),v("vaSublayer",r),v("vaLayer",r),t("load",{view:i,sublayers:a,sublayer:r});async function l(){await n.when();const s=r.url;return(await bi(s,{query:{f:"json"}})).data}return{}}}),wo=(e,t)=>{const i=e.__vccOpts||e;for(const[a,n]of t)i[a]=n;return i};function Mo(e,t,i,a,n,r){return y(e.$slots,"default")}var ze=wo(go,[["render",Mo]]);ze.install=e=>{e.component(ze.name,ze)};const xo={...k.props,defaultOptions:{type:Object,default:()=>({})},url:{type:String,required:!0,default:""}},$o={click:e=>e,pointerMove:e=>e,load:e=>e};var _o=m({name:"VaSceneLayer",components:{VaLayerHitEvents:G},emits:$o,props:xo,setup(e,{emit:t}){const i=ie.createOnEmits(t),a=ea(),n=a.map,r=new Si({url:e.url,...e.defaultOptions});return f(()=>{r.url=e.url}),h.useAddLayer(n,r,e),h.useSetLayerOptions(r,e),v("vaSceneLayer",r),v("vaLayer",r),t("load",{layer:r,view:a}),{hitEmits:i}}}),bo=(e,t)=>{const i=e.__vccOpts||e;for(const[a,n]of t)i[a]=n;return i};function So(e,t,i,a,n,r){const o=M("VaLayerHitEvents");return T(),b(E,null,[S(o,B(e.hitEmits),null,16),y(e.$slots,"default")],64)}var Xe=bo(_o,[["render",So]]);Xe.install=e=>{e.component(Xe.name,Xe)};const Lo={type:{type:String,default:"",required:!0}};var Je=m({name:"VaTreeLayerItem",props:Lo,setup(e){const t=V("vaTreeLayerGroupLayerItems");if(!t)throw new TypeError;const i=Ji();return i&&(t[e.type]=i),()=>null}});Je.install=e=>{e.component(Je.name,Je)};const Oo={data:{type:Array,default:()=>[]}};var Ke=m({name:"VaTreeLayerGroup",props:Oo,setup(e,t){const i=Pt({});v("vaTreeLayerGroupLayerItems",i);const a=t.slots;return()=>{const n=a.default(),o=(c=>{const l=[...c];let s=0;for(;l[s];){const d=l[s].children;d&&l.push(...d),s++}return l.reduce((d,u)=>{if(u.layer&&i[u.layer.type]){const p=i[u.layer.type].slots.default({layer:u.layer,node:u});Array.isArray(p)?p.forEach($=>{d.push($)}):d.push(p)}return d},[])})(e.data);return[n,o]}}});Ke.install=e=>{e.component(Ke.name,Ke)};const Vo=(e,t,i)=>{i.orphan||(f(()=>{e.add(t,i.position)}),ut(()=>{e.remove(t)}),pt(()=>{e.add(t,i.position)}),ft(()=>{e.remove(t)}))},Co={defaultOptions:{type:Object,default:()=>({})},position:{type:String,default:"top-right"},orphan:{type:Boolean,default:!1}},Ro={load:e=>e};var Eo=m({name:"VaPrint",emits:Ro,props:Co,setup(e,{emit:t}){const i=x(),a=C(),n=C(!1);return ee(()=>{const r=new Li({container:a.value,view:i,...e.defaultOptions});Vo(i.ui,r,e),v("vaSketch",r),n.value=!0,t("load",{print:r,view:i}),w(()=>{r.destroy()})}),{uiNode:a,ready:n}}}),Io=(e,t)=>{const i=e.__vccOpts||e;for(const[a,n]of t)i[a]=n;return i};const jo={ref:"uiNode",class:"va-print-x"};function Wo(e,t,i,a,n,r){return T(),b("div",jo,[e.ready?y(e.$slots,"default",{key:0}):H("v-if",!0)],512)}var Qe=Io(Eo,[["render",Wo]]);Qe.install=e=>{e.component(Qe.name,Qe)};const ko={...k.props,color:{type:Array,default:()=>[0,0,0,.7]},geometry:{type:Object,default:void 0},distance:{type:Number,default:24},tileInfo:{type:Object,default:void 0},spatialReference:{type:Object,default:void 0}},Ho={load:e=>e},Bo=Oi.createSubclass({constructor(){this.tileContexts=new window.Map,this.watchHandles=new Ii,this.needsImageUpdate=!1},attach(){const e=Ci(),t=this,i=t.layer;this.watchHandles.add([fe(()=>this.layer.tileInfo,()=>{t.needsImageUpdate=!0,t.requestRender()},{initial:!0}),fe(()=>this.layer.geometry,()=>{if(!i.geometry){t.projectedGeometry=null,t.needsImageUpdate=!0,t.requestRender();return}e.then(()=>{t.projectedGeometry=Ri(i.geometry,i.tileInfo.spatialReference,Ei(i.geometry.spatialReference,i.tileInfo.spatialReference)),t.needsImageUpdate=!0,t.requestRender()})},{initial:!0}),fe(()=>this.layer.distance,()=>{t.needsImageUpdate=!0,t.requestRender()},{initial:!0}),fe(()=>this.layer.color,()=>{t.needsImageUpdate=!0,t.requestRender()},{initial:!0})])},drawGeometry(e,t){e.globalCompositeOperation="source-over";const i=e.canvas.width,a=e.canvas.height;if(!this.projectedGeometry){e.clearRect(0,0,i,a);return}if(this.layer.distance===0)return;const n=this.layer.color;e.fillStyle="rgba("+n[0]+", "+n[1]+", "+n[2]+", 1)",e.fillRect(0,0,i,a);const r=3/this.layer.distance;if(e.globalCompositeOperation="destination-out",this.projectedGeometry.type==="polygon"||this.projectedGeometry.type==="polyline"||this.projectedGeometry.type==="extent"){const c=(this.projectedGeometry.type==="extent"?Vi.fromExtent(this.projectedGeometry).rings:this.projectedGeometry.rings||this.projectedGeometry.paths).map(l=>l.map(s=>[Math.round(i*(s[0]-t[0])/(t[2]-t[0])),Math.round(a*(1-(s[1]-t[1])/(t[3]-t[1])))]));e.lineJoin="round";for(let l=1;l<=this.layer.distance;++l){e.strokeStyle="rgba(0, 0, 0, "+r+")",e.lineWidth=this.layer.distance+1-l;for(let s=0;s<c.length;++s){const d=c[s];e.beginPath(),e.moveTo(d[0][0],d[0][1]);for(let u=1;u<d.length;++u)e.lineTo(d[u][0],d[u][1]);this.projectedGeometry.type!=="polyline"&&e.closePath(),e.stroke()}}if(this.projectedGeometry.type!=="polyline"){e.fillStyle="rgba(0, 0, 0, 1)";for(let l=0;l<c.length;++l){const s=c[l];e.beginPath(),e.moveTo(s[0][0],s[0][1]);for(let d=1;d<s.length;++d)e.lineTo(s[d][0],s[d][1]);e.closePath(),e.fill()}}}else if(this.projectedGeometry.type==="point"||this.projectedGeometry.type==="multipoint"){const c=(this.projectedGeometry.type==="multipoint"?this.projectedGeometry.points:[[this.projectedGeometry.x,this.projectedGeometry.y]]).map(l=>[Math.round(i*(l[0]-t[0])/(t[2]-t[0])),Math.round(a*(1-(l[1]-t[1])/(t[3]-t[1])))]);for(let l=1;l<=this.layer.distance;++l){const s=this.layer.distance+1-l;e.fillStyle="rgba(0, 0, 0, "+r+")";for(let d=0;d<c.length;++d){const u=c[d];e.beginPath(),e.arc(u[0],u[1],Math.round(s/2),0,360),e.fill()}}}},manageTileImages(){const e=new Set;for(let t=0;t<this.tiles.length;++t){const i=this.tiles[t];e.add(i.id);let a=this.tileContexts.get(i.id);if(a)this.needsImageUpdate&&this.drawGeometry(a,i.bounds);else{const n=document.createElement("canvas");n.width=this.layer.tileInfo.size[0],n.height=this.layer.tileInfo.size[1],a=n.getContext("2d"),this.tileContexts.set(i.id,a),this.drawGeometry(a,i.bounds)}}this.tileContexts.forEach((t,i)=>{e.has(i)||this.tileContexts.delete(i)}),this.needsImageUpdate=!1},render(e){this.manageTileImages();const t=this.layer.tileInfo.size[0],i=e.state,a=i.pixelRatio,n=i.size[0],r=i.size[1],o=e.context,c=[0,0];o.clearRect(0,0,n*a,r*a),i.rotation!==0&&(o.translate(n*a*.5,r*a*.5),o.rotate(i.rotation*Math.PI/180),o.translate(-n*a*.5,-r*a*.5)),o.globalAlpha=this.layer.color[3];for(let l=0;l<this.tiles.length;++l){const s=this.tiles[l],d=this.tileContexts.get(s.id),u=s.resolution/i.resolution*a;i.toScreenNoRotation(c,s.coords),o.drawImage(d.canvas,c[0],c[1],t*u,t*u)}},detach(){this.watchHandles.removeAll()},tilesChanged(){}}),Go=ji(Wi).createSubclass({properties:{color:{},geometry:{},distance:{},tileInfo:_e.create({size:512})},constructor(){},createLayerView(e){if(e.type==="2d")return new Bo({view:e,layer:this})}});var Po=m({name:"VaMaskingLayer",emits:Ho,props:ko,setup(e,{emit:t}){const i=x(),a=i.map,n=i.map.basemap.baseLayers.getItemAt(0),r=new Go({color:e.color,distance:e.distance,geometry:e.geometry});return f(()=>{r.geometry=e.geometry,e.geometry&&!e.geometry.spatialReference&&i.when(()=>{r.geometry.spatialReference=e.spatialReference||i.spatialReference})}),f(()=>{r.color=e.color}),f(()=>{r.distance=e.distance}),f(()=>{i.when(()=>{r.tileInfo=e.tileInfo?e.tileInfo:n.tileInfo})}),h.useSetLayerOptions(r,e),h.useAddLayer(a,r,e),t("load",{view:i,layer:r}),{}}}),Ao=(e,t)=>{const i=e.__vccOpts||e;for(const[a,n]of t)i[a]=n;return i};function Do(e,t,i,a,n,r){return y(e.$slots,"default")}var Ye=Ao(Po,[["render",Do]]);Ye.install=e=>{e.component(Ye.name,Ye)};const Fo={...k.props,defaultOptions:{type:Object,default:()=>({})},url:{type:String,default:""},renderer:{type:Object,default:void 0}},Uo={load:e=>e};var No=m({name:"VaImageryLayer",emits:Uo,props:Fo,setup(e,{emit:t}){const i=U(),a=i.map,n=new ki({...e.defaultOptions});return f(()=>{n.url=e.url}),f(()=>{e.renderer!==void 0&&(n.renderer=e.renderer)}),h.useAddLayer(a,n,e),h.useSetLayerOptions(n,e),t("load",{layer:n,view:i}),v("vaLayer",n),v("vaImageryLayer",n),{}}}),qo=(e,t)=>{const i=e.__vccOpts||e;for(const[a,n]of t)i[a]=n;return i};function zo(e,t,i,a,n,r){return y(e.$slots,"default")}var Ze=qo(No,[["render",zo]]);Ze.install=e=>{e.component(Ze.name,Ze)};const ci={effect:{type:Object,default:void 0},blendMode:{type:String,default:void 0}},Xo=ue(ci);var Jo=Object.freeze({__proto__:null,createBindProps:Xo,props:ci});function Ko(e,t){f(()=>{t.effect!==void 0&&(e.effect=t.effect)}),f(()=>{t.blendMode!==void 0&&(e.blendMode=t.blendMode)})}var Qo=Object.freeze({__proto__:null,useSetBlendLayerOptions:Ko});const Yo={...k.props,...Jo.props,defaultOptions:{type:Object,default:()=>({})},url:{type:String,required:!0},renderer:{type:Object,default:void 0}},Zo={load:e=>e};var el=m({name:"VaImageryTileLayer",emits:Zo,props:Yo,setup(e,{emit:t}){const i=x(),a=i.map,n=new Hi({...e.defaultOptions});return f(()=>{n.url=e.url}),f(()=>{e.renderer!==void 0&&(n.renderer=e.renderer)}),Qo.useSetBlendLayerOptions(n,e),h.useAddLayer(a,n,e),t("load",{view:i,layer:n}),{}}}),tl=(e,t)=>{const i=e.__vccOpts||e;for(const[a,n]of t)i[a]=n;return i};function il(e,t,i,a,n,r){return y(e.$slots,"default")}var et=tl(el,[["render",il]]);et.install=e=>{e.component(et.name,et)};const al={...ei.props,defaultOptions:{type:Object,default:()=>({})},visible:{type:Boolean,default:!0}},nl={load:e=>e};var rl=m({name:"VaZoom",props:al,emits:nl,setup(e,{emit:t}){const i=U(),a=new Bi({view:i,...e.defaultOptions});return Ve.useAddUi(i.ui,a,e),Oe(a,e),t("load",{ui:a,view:i}),{}}}),ol=(e,t)=>{const i=e.__vccOpts||e;for(const[a,n]of t)i[a]=n;return i};function ll(e,t,i,a,n,r){return y(e.$slots,"default")}var tt=ol(rl,[["render",ll]]);tt.install=e=>{e.component(tt.name,tt)};const sl={...N.props,defaultOptions:{type:Object,default:()=>({})},url:{type:String},namespaceUri:{type:String,default:void 0},name:{type:String},geometryType:{type:String},wfsLayerInfo:{type:Object,default:void 0},customParameters:{type:Object,default:()=>({})}},cl={load:e=>e,click:e=>e,pointerMove:e=>e};var ul=m({name:"VaWfsLayer",components:{VaLayerHitEvents:G},emits:cl,props:sl,setup(e,{emit:t}){const i=U(),a=i.map,n=ie.createOnEmits(t),r=e.wfsLayerInfo?St.fromWFSLayerInfo(e.wfsLayerInfo):new St({...e.defaultOptions});return Y.useSetLayerOptions(r,e),f(()=>{e.url&&(r.url=e.url)}),f(()=>{e.name&&(r.name=e.name)}),f(()=>{e.namespaceUri&&(r.namespaceUri=e.namespaceUri)}),f(()=>{e.geometryType&&(r.geometryType=e.geometryType)}),I(()=>({...e.customParameters}),()=>{r.customParameters=e.customParameters,r.refresh()}),Y.useSetLayerSpatialReference(i,r,e),h.useAddLayer(a,r,e),v("vaLayer",r),v("vaWfsLayer",r),t("load",{view:i,layer:r}),{hitEmits:n}}}),dl=(e,t)=>{const i=e.__vccOpts||e;for(const[a,n]of t)i[a]=n;return i};function fl(e,t,i,a,n,r){const o=M("VaLayerHitEvents");return T(),b(E,null,[S(o,B(e.hitEmits),null,16),y(e.$slots,"default")],64)}var it=dl(ul,[["render",fl]]);it.install=e=>{e.component(it.name,it)};const pl={...k.props,defaultOptions:{type:Object,default:()=>({})},url:{type:String,default:""},sublayers:{type:Array},customParameters:{type:Object,default:()=>({})}},ml={load:e=>e};var yl=m({name:"VaWmsLayer",props:pl,emits:ml,setup(e,{emit:t}){const i=U(),a=i.map,n=new Gi({...e.defaultOptions});f(()=>{n.url=e.url}),f(()=>{n.customParameters=e.customParameters,n.refresh()}),f(()=>{e.sublayers&&(n.sublayers=e.sublayers,r())}),n.when(r),h.useSetLayerOptions(n,e),h.useAddLayer(a,n,e),v("vaLayer",n),v("vaWmsLayer",n),t("load",{layer:n,view:i});function r(){if(console.log("setInfoToSublayer",n.resourceInfo),e.sublayers?.length&&n.resourceInfo){const o=n.resourceInfo.layers.reduce((l,s)=>(l[s.name]=s,l),{}),c=n.resourceInfo.layers.reduce((l,s)=>(l[s.title]=s,l),{});n.sublayers.forEach(l=>{let s=l.name;s.includes(":")&&(s=s.split(":")[1]);const d=o[s];d&&(l.title||(l.title=d.title),l.maxScale||(l.maxScale=d.maxScale),l.minScale||(l.minScale=d.minScale),l.fullExtent||(l.fullExtent=new we(d.extent)));const u=c[s];u&&(l.maxScale||(l.maxScale=u.maxScale),l.minScale||(l.minScale=u.minScale),l.fullExtent||(l.fullExtent=new we(u.extent)))})}}return{layer:n}}}),vl=(e,t)=>{const i=e.__vccOpts||e;for(const[a,n]of t)i[a]=n;return i};function hl(e,t,i,a,n,r){return y(e.$slots,"default")}var at=vl(yl,[["render",hl]]);at.install=e=>{e.component(at.name,at)};const Tl={...k.props,defaultOptions:{type:Object,default:()=>({})},url:{type:String,required:!0},serviceMode:{type:String,default:"RESTful"},customParameters:{type:Object,default:()=>({})},sublayers:{type:Array,default:void 0},activeLayer:{type:Object,default:void 0},overwriteCapabilities:{type:Object,default:void 0},subDomains:{type:Array,default:void 0}},gl={load:e=>e},wl=function(e=new we({xmin:-180,ymin:-90,xmax:180,ymax:90,spatialReference:{wkid:4326}})){const t=document.createElement("ows:WGS84BoundingBox"),i=document.createElement("ows:LowerCorner");i.textContent=e.xmin+" "+e.ymin;const a=document.createElement("ows:UpperCorner");return a.textContent=e.xmax+" "+e.ymax,t.appendChild(i),t.appendChild(a),t},Ml=(e="PM")=>`<Capabilities xmlns="http://www.opengis.net/wmts/1.0" xmlns:gml="http://www.opengis.net/gml" xmlns:ows="http://www.opengis.net/ows/1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" version="1.0.0" xsi:schemaLocation="http://www.opengis.net/wmts/1.0 http://schemas.opengis.net/wmts/1.0/wmtsGetCapabilities_response.xsd">
<TileMatrixSet>
<ows:Identifier>${e}</ows:Identifier>
<ows:SupportedCRS>EPSG:3857</ows:SupportedCRS>
<TileMatrix>
<ows:Identifier>0</ows:Identifier>
<ScaleDenominator>559082264.0287178958533332</ScaleDenominator>
<TopLeftCorner>-20037508.3427892476320267 20037508.3427892476320267</TopLeftCorner>
<TileWidth>256</TileWidth>
<TileHeight>256</TileHeight>
<MatrixWidth>1</MatrixWidth>
<MatrixHeight>1</MatrixHeight>
</TileMatrix>
<TileMatrix>
<ows:Identifier>1</ows:Identifier>
<ScaleDenominator>279541132.0143588959472254</ScaleDenominator>
<TopLeftCorner>-20037508.3427892476320267 20037508.3427892476320267</TopLeftCorner>
<TileWidth>256</TileWidth>
<TileHeight>256</TileHeight>
<MatrixWidth>2</MatrixWidth>
<MatrixHeight>2</MatrixHeight>
</TileMatrix>
<TileMatrix>
<ows:Identifier>2</ows:Identifier>
<ScaleDenominator>139770566.0071793960087234</ScaleDenominator>
<TopLeftCorner>-20037508.3427892476320267 20037508.3427892476320267</TopLeftCorner>
<TileWidth>256</TileWidth>
<TileHeight>256</TileHeight>
<MatrixWidth>4</MatrixWidth>
<MatrixHeight>4</MatrixHeight>
</TileMatrix>
<TileMatrix>
<ows:Identifier>3</ows:Identifier>
<ScaleDenominator>69885283.0035897239868063</ScaleDenominator>
<TopLeftCorner>-20037508.3427892476320267 20037508.3427892476320267</TopLeftCorner>
<TileWidth>256</TileWidth>
<TileHeight>256</TileHeight>
<MatrixWidth>8</MatrixWidth>
<MatrixHeight>8</MatrixHeight>
</TileMatrix>
<TileMatrix>
<ows:Identifier>4</ows:Identifier>
<ScaleDenominator>34942641.5017948619934032</ScaleDenominator>
<TopLeftCorner>-20037508.3427892476320267 20037508.3427892476320267</TopLeftCorner>
<TileWidth>256</TileWidth>
<TileHeight>256</TileHeight>
<MatrixWidth>16</MatrixWidth>
<MatrixHeight>16</MatrixHeight>
</TileMatrix>
<TileMatrix>
<ows:Identifier>5</ows:Identifier>
<ScaleDenominator>17471320.7508974309967016</ScaleDenominator>
<TopLeftCorner>-20037508.3427892476320267 20037508.3427892476320267</TopLeftCorner>
<TileWidth>256</TileWidth>
<TileHeight>256</TileHeight>
<MatrixWidth>32</MatrixWidth>
<MatrixHeight>32</MatrixHeight>
</TileMatrix>
<TileMatrix>
<ows:Identifier>6</ows:Identifier>
<ScaleDenominator>8735660.3754487154983508</ScaleDenominator>
<TopLeftCorner>-20037508.3427892476320267 20037508.3427892476320267</TopLeftCorner>
<TileWidth>256</TileWidth>
<TileHeight>256</TileHeight>
<MatrixWidth>64</MatrixWidth>
<MatrixHeight>64</MatrixHeight>
</TileMatrix>
<TileMatrix>
<ows:Identifier>7</ows:Identifier>
<ScaleDenominator>4367830.1877243577491754</ScaleDenominator>
<TopLeftCorner>-20037508.3427892476320267 20037508.3427892476320267</TopLeftCorner>
<TileWidth>256</TileWidth>
<TileHeight>256</TileHeight>
<MatrixWidth>128</MatrixWidth>
<MatrixHeight>128</MatrixHeight>
</TileMatrix>
<TileMatrix>
<ows:Identifier>8</ows:Identifier>
<ScaleDenominator>2183915.0938621788745877</ScaleDenominator>
<TopLeftCorner>-20037508.3427892476320267 20037508.3427892476320267</TopLeftCorner>
<TileWidth>256</TileWidth>
<TileHeight>256</TileHeight>
<MatrixWidth>256</MatrixWidth>
<MatrixHeight>256</MatrixHeight>
</TileMatrix>
<TileMatrix>
<ows:Identifier>9</ows:Identifier>
<ScaleDenominator>1091957.5469310886252288</ScaleDenominator>
<TopLeftCorner>-20037508.3427892476320267 20037508.3427892476320267</TopLeftCorner>
<TileWidth>256</TileWidth>
<TileHeight>256</TileHeight>
<MatrixWidth>512</MatrixWidth>
<MatrixHeight>512</MatrixHeight>
</TileMatrix>
<TileMatrix>
<ows:Identifier>10</ows:Identifier>
<ScaleDenominator>545978.7734655447186469</ScaleDenominator>
<TopLeftCorner>-20037508.3427892476320267 20037508.3427892476320267</TopLeftCorner>
<TileWidth>256</TileWidth>
<TileHeight>256</TileHeight>
<MatrixWidth>1024</MatrixWidth>
<MatrixHeight>1024</MatrixHeight>
</TileMatrix>
<TileMatrix>
<ows:Identifier>11</ows:Identifier>
<ScaleDenominator>272989.3867327723085907</ScaleDenominator>
<TopLeftCorner>-20037508.3427892476320267 20037508.3427892476320267</TopLeftCorner>
<TileWidth>256</TileWidth>
<TileHeight>256</TileHeight>
<MatrixWidth>2048</MatrixWidth>
<MatrixHeight>2048</MatrixHeight>
</TileMatrix>
<TileMatrix>
<ows:Identifier>12</ows:Identifier>
<ScaleDenominator>136494.6933663861796617</ScaleDenominator>
<TopLeftCorner>-20037508.3427892476320267 20037508.3427892476320267</TopLeftCorner>
<TileWidth>256</TileWidth>
<TileHeight>256</TileHeight>
<MatrixWidth>4096</MatrixWidth>
<MatrixHeight>4096</MatrixHeight>
</TileMatrix>
<TileMatrix>
<ows:Identifier>13</ows:Identifier>
<ScaleDenominator>68247.3466831930771477</ScaleDenominator>
<TopLeftCorner>-20037508.3427892476320267 20037508.3427892476320267</TopLeftCorner>
<TileWidth>256</TileWidth>
<TileHeight>256</TileHeight>
<MatrixWidth>8192</MatrixWidth>
<MatrixHeight>8192</MatrixHeight>
</TileMatrix>
<TileMatrix>
<ows:Identifier>14</ows:Identifier>
<ScaleDenominator>34123.6733415965449154</ScaleDenominator>
<TopLeftCorner>-20037508.3427892476320267 20037508.3427892476320267</TopLeftCorner>
<TileWidth>256</TileWidth>
<TileHeight>256</TileHeight>
<MatrixWidth>16384</MatrixWidth>
<MatrixHeight>16384</MatrixHeight>
</TileMatrix>
<TileMatrix>
<ows:Identifier>15</ows:Identifier>
<ScaleDenominator>17061.8366707982724577</ScaleDenominator>
<TopLeftCorner>-20037508.3427892476320267 20037508.3427892476320267</TopLeftCorner>
<TileWidth>256</TileWidth>
<TileHeight>256</TileHeight>
<MatrixWidth>32768</MatrixWidth>
<MatrixHeight>32768</MatrixHeight>
</TileMatrix>
<TileMatrix>
<ows:Identifier>16</ows:Identifier>
<ScaleDenominator>8530.9183353991362289</ScaleDenominator>
<TopLeftCorner>-20037508.3427892476320267 20037508.3427892476320267</TopLeftCorner>
<TileWidth>256</TileWidth>
<TileHeight>256</TileHeight>
<MatrixWidth>65536</MatrixWidth>
<MatrixHeight>65536</MatrixHeight>
</TileMatrix>
<TileMatrix>
<ows:Identifier>17</ows:Identifier>
<ScaleDenominator>4265.4591676995681144</ScaleDenominator>
<TopLeftCorner>-20037508.3427892476320267 20037508.3427892476320267</TopLeftCorner>
<TileWidth>256</TileWidth>
<TileHeight>256</TileHeight>
<MatrixWidth>131072</MatrixWidth>
<MatrixHeight>131072</MatrixHeight>
</TileMatrix>
<TileMatrix>
<ows:Identifier>18</ows:Identifier>
<ScaleDenominator>2132.7295838497840572</ScaleDenominator>
<TopLeftCorner>-20037508.3427892476320267 20037508.3427892476320267</TopLeftCorner>
<TileWidth>256</TileWidth>
<TileHeight>256</TileHeight>
<MatrixWidth>262144</MatrixWidth>
<MatrixHeight>262144</MatrixHeight>
</TileMatrix>
<TileMatrix>
<ows:Identifier>19</ows:Identifier>
<ScaleDenominator>1066.3647919248918304</ScaleDenominator>
<TopLeftCorner>-20037508.3427892476320267 20037508.3427892476320267</TopLeftCorner>
<TileWidth>256</TileWidth>
<TileHeight>256</TileHeight>
<MatrixWidth>524288</MatrixWidth>
<MatrixHeight>524288</MatrixHeight>
</TileMatrix>
<TileMatrix>
<ows:Identifier>20</ows:Identifier>
<ScaleDenominator>533.1823959624461134</ScaleDenominator>
<TopLeftCorner>-20037508.3427892476320267 20037508.3427892476320267</TopLeftCorner>
<TileWidth>256</TileWidth>
<TileHeight>256</TileHeight>
<MatrixWidth>1048576</MatrixWidth>
<MatrixHeight>1048576</MatrixHeight>
</TileMatrix>
<TileMatrix>
<ows:Identifier>21</ows:Identifier>
<ScaleDenominator>266.5911979812228585</ScaleDenominator>
<TopLeftCorner>-20037508.3427892476320267 20037508.3427892476320267</TopLeftCorner>
<TileWidth>256</TileWidth>
<TileHeight>256</TileHeight>
<MatrixWidth>2097152</MatrixWidth>
<MatrixHeight>2097152</MatrixHeight>
</TileMatrix>
</TileMatrixSet>
</Capabilities>
`,xl=(e="PM")=>`<Capabilities xmlns="http://www.opengis.net/wmts/1.0" xmlns:ows="http://www.opengis.net/ows/1.1" xmlns:gml="http://www.opengis.net/gml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xlink="http://www.w3.org/1999/xlink" xsi:schemaLocation="http://www.opengis.net/wmts/1.0 http://schemas.opengis.net/wmts/1.0.0/wmtsGetCapabilities_response.xsd" version="1.0.0">
<TileMatrixSetLink>
<TileMatrixSet>${e}</TileMatrixSet>
<TileMatrixSetLimits>
<TileMatrixLimits>
<TileMatrix>0</TileMatrix>
<MinTileRow>0</MinTileRow>
<MaxTileRow>1</MaxTileRow>
<MinTileCol>0</MinTileCol>
<MaxTileCol>1</MaxTileCol>
</TileMatrixLimits>
<TileMatrixLimits>
<TileMatrix>1</TileMatrix>
<MinTileRow>0</MinTileRow>
<MaxTileRow>2</MaxTileRow>
<MinTileCol>0</MinTileCol>
<MaxTileCol>2</MaxTileCol>
</TileMatrixLimits>
<TileMatrixLimits>
<TileMatrix>2</TileMatrix>
<MinTileRow>0</MinTileRow>
<MaxTileRow>4</MaxTileRow>
<MinTileCol>0</MinTileCol>
<MaxTileCol>4</MaxTileCol>
</TileMatrixLimits>
<TileMatrixLimits>
<TileMatrix>3</TileMatrix>
<MinTileRow>0</MinTileRow>
<MaxTileRow>8</MaxTileRow>
<MinTileCol>0</MinTileCol>
<MaxTileCol>8</MaxTileCol>
</TileMatrixLimits>
<TileMatrixLimits>
<TileMatrix>4</TileMatrix>
<MinTileRow>0</MinTileRow>
<MaxTileRow>16</MaxTileRow>
<MinTileCol>0</MinTileCol>
<MaxTileCol>16</MaxTileCol>
</TileMatrixLimits>
<TileMatrixLimits>
<TileMatrix>5</TileMatrix>
<MinTileRow>0</MinTileRow>
<MaxTileRow>32</MaxTileRow>
<MinTileCol>0</MinTileCol>
<MaxTileCol>32</MaxTileCol>
</TileMatrixLimits>
<TileMatrixLimits>
<TileMatrix>6</TileMatrix>
<MinTileRow>0</MinTileRow>
<MaxTileRow>64</MaxTileRow>
<MinTileCol>0</MinTileCol>
<MaxTileCol>64</MaxTileCol>
</TileMatrixLimits>
<TileMatrixLimits>
<TileMatrix>7</TileMatrix>
<MinTileRow>0</MinTileRow>
<MaxTileRow>128</MaxTileRow>
<MinTileCol>0</MinTileCol>
<MaxTileCol>128</MaxTileCol>
</TileMatrixLimits>
<TileMatrixLimits>
<TileMatrix>8</TileMatrix>
<MinTileRow>0</MinTileRow>
<MaxTileRow>256</MaxTileRow>
<MinTileCol>0</MinTileCol>
<MaxTileCol>256</MaxTileCol>
</TileMatrixLimits>
<TileMatrixLimits>
<TileMatrix>9</TileMatrix>
<MinTileRow>0</MinTileRow>
<MaxTileRow>512</MaxTileRow>
<MinTileCol>0</MinTileCol>
<MaxTileCol>512</MaxTileCol>
</TileMatrixLimits>
<TileMatrixLimits>
<TileMatrix>10</TileMatrix>
<MinTileRow>0</MinTileRow>
<MaxTileRow>1024</MaxTileRow>
<MinTileCol>0</MinTileCol>
<MaxTileCol>1024</MaxTileCol>
</TileMatrixLimits>
<TileMatrixLimits>
<TileMatrix>11</TileMatrix>
<MinTileRow>0</MinTileRow>
<MaxTileRow>2048</MaxTileRow>
<MinTileCol>0</MinTileCol>
<MaxTileCol>2048</MaxTileCol>
</TileMatrixLimits>
<TileMatrixLimits>
<TileMatrix>12</TileMatrix>
<MinTileRow>0</MinTileRow>
<MaxTileRow>4096</MaxTileRow>
<MinTileCol>0</MinTileCol>
<MaxTileCol>4096</MaxTileCol>
</TileMatrixLimits>
<TileMatrixLimits>
<TileMatrix>13</TileMatrix>
<MinTileRow>2736</MinTileRow>
<MaxTileRow>4639</MaxTileRow>
<MinTileCol>32</MinTileCol>
<MaxTileCol>7935</MaxTileCol>
</TileMatrixLimits>
<TileMatrixLimits>
<TileMatrix>14</TileMatrix>
<MinTileRow>5472</MinTileRow>
<MaxTileRow>9263</MaxTileRow>
<MinTileCol>80</MinTileCol>
<MaxTileCol>15855</MaxTileCol>
</TileMatrixLimits>
<TileMatrixLimits>
<TileMatrix>15</TileMatrix>
<MinTileRow>10944</MinTileRow>
<MaxTileRow>18527</MaxTileRow>
<MinTileCol>160</MinTileCol>
<MaxTileCol>31695</MaxTileCol>
</TileMatrixLimits>
<TileMatrixLimits>
<TileMatrix>16</TileMatrix>
<MinTileRow>21904</MinTileRow>
<MaxTileRow>37039</MaxTileRow>
<MinTileCol>320</MinTileCol>
<MaxTileCol>63391</MaxTileCol>
</TileMatrixLimits>
<TileMatrixLimits>
<TileMatrix>17</TileMatrix>
<MinTileRow>43808</MinTileRow>
<MaxTileRow>74063</MaxTileRow>
<MinTileCol>656</MinTileCol>
<MaxTileCol>126767</MaxTileCol>
</TileMatrixLimits>
<TileMatrixLimits>
<TileMatrix>18</TileMatrix>
<MinTileRow>87616</MinTileRow>
<MaxTileRow>148111</MaxTileRow>
<MinTileCol>1312</MinTileCol>
<MaxTileCol>253535</MaxTileCol>
</TileMatrixLimits>
<TileMatrixLimits>
<TileMatrix>19</TileMatrix>
<MinTileRow>175248</MinTileRow>
<MaxTileRow>294063</MaxTileRow>
<MinTileCol>170144</MinTileCol>
<MaxTileCol>343487</MaxTileCol>
</TileMatrixLimits>
<TileMatrixLimits>
<TileMatrix>20</TileMatrix>
<MinTileRow>357008</MinTileRow>
<MaxTileRow>384687</MaxTileRow>
<MinTileCol>524400</MinTileCol>
<MaxTileCol>540927</MaxTileCol>
</TileMatrixLimits>
<TileMatrixLimits>
<TileMatrix>21</TileMatrix>
<MinTileRow>714032</MinTileRow>
<MaxTileRow>768783</MaxTileRow>
<MinTileCol>1048816</MinTileCol>
<MaxTileCol>1081775</MaxTileCol>
</TileMatrixLimits>
</TileMatrixSetLimits>
</TileMatrixSetLink>
</Capabilities>
`,$l=(e="PM")=>{const t=new DOMParser().parseFromString(Ml(e),"text/xml").getElementsByTagName("TileMatrixSet")[0],i=new DOMParser().parseFromString(xl(e),"text/xml").getElementsByTagName("TileMatrixSetLink")[0];return{TileMatrixSet:t,TileMatrixSetLink:i}},_l={PM:$l};var bl=m({name:"VaWmtsLayer",props:Tl,emits:gl,setup(e,{emit:t}){const i=U(),a=i.map,n=P(()=>e.overwriteCapabilities?.replaceTileMatrixSets.reduce((l,s)=>(l[s.find]=_l[s.replacement](s.find),l),{})??{}),{interceptorToggle:r}=Zi({urls:[new RegExp(`${e.url}.*VUESRI=VaWmtsLayer`)],before(l){const s=e.subDomains;s&&(l.url=l.url.replace("{subDomain}",s[Math.floor(Math.random()*s.length)]))},after(l){if(l.url?.includes("request=GetCapabilities")){const s=l.data,u=new DOMParser().parseFromString(s,"application/xml"),p=u.getElementsByTagName("Contents")[0],$=u.getElementsByTagName("Layer");for(let g=0;g<$.length;g++){const O=$[g],j=O.getElementsByTagName("TileMatrixSetLink");for(let q=0;q<j.length;q++){const z=j[q];z.textContent&&n.value[z.textContent]&&z.replaceWith(n.value[z.textContent].TileMatrixSetLink)}const ae=O.getElementsByTagName("ows:Identifier")[0];ae&&e.activeLayer?.id&&e.overwriteCapabilities?.extend&&e.activeLayer.id===ae.textContent&&O.getElementsByTagName("ows:WGS84BoundingBox")[0].replaceWith(wl(e.overwriteCapabilities.extend))}const _=p.getElementsByTagName("TileMatrixSet");for(let g=0;g<_.length;g++){const O=_[g],j=O.getElementsByTagName("ows:Identifier")[0];j&&n.value[j.textContent]&&O.replaceWith(n.value[j.textContent].TileMatrixSet)}l.data=u.documentElement.outerHTML}}});r.add();const o=new Pi({...e.activeLayer?{activeLayer:e.activeLayer}:{},...e.defaultOptions}),c=Se({});return o.when(()=>{c.value=o.sublayers.reduce((l,s)=>(l[s.id]=s,l),{})}),f(()=>{o.url=e.url}),f(()=>{o.serviceMode=e.serviceMode}),f(()=>{o.customParameters={...e.customParameters,VUESRI:"VaWmtsLayer"}}),f(()=>{e.sublayers&&(o.sublayers=e.sublayers)}),I(()=>[e.activeLayer?.id,e.activeLayer?.imageFormat],([l,s])=>{l&&o.when().then(()=>{const d=c.value[l];console.warn("sublayers can not find the id: ",l),d&&s&&(d.imageFormat=s),o.activeLayer=d,o.refresh()})},{immediate:!0}),f(()=>{o.title=e.title}),h.useSetLayerOptions(o,e),h.useAddLayer(a,o,e),v("vaLayer",o),v("vaWmtsLayer",o),t("load",{view:i,layer:o}),{}}}),Sl=(e,t)=>{const i=e.__vccOpts||e;for(const[a,n]of t)i[a]=n;return i};function Ll(e,t,i,a,n,r){return y(e.$slots,"default")}var nt=Sl(bl,[["render",Ll]]);nt.install=e=>{e.component(nt.name,nt)};const Ol={...ei.props,defaultOptions:{type:Object,default:()=>({})},viewModel:{type:Object,default:()=>({})}},Vl={load:e=>e};var Cl=m({name:"VaSlice",props:Ol,emits:Vl,setup(e,{emit:t}){const i=Ki(),a=new Ai({view:i,...e.defaultOptions});return I(()=>({...e.viewModel}),()=>{Reflect.ownKeys(e.viewModel).forEach(n=>{a.viewModel[n]=e.viewModel[n]})},{immediate:!0}),Ve.useAddUi(i.ui,a,e),{}}}),Rl=(e,t)=>{const i=e.__vccOpts||e;for(const[a,n]of t)i[a]=n;return i};function El(e,t,i,a,n,r){return y(e.$slots,"default")}var rt=Rl(Cl,[["render",El]]);rt.install=e=>{e.component(rt.name,rt)};export{Ie as V,le as a,Ge as b,Ee as c,Ae as d};
