const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/chunks/chunk-DCfYb5Y0.js","assets/chunks/chunk-DsYbGKja.js","assets/chunks/chunk-B0S82j6z.js","assets/chunks/chunk-BuZVacDv.js","assets/static/style-35e9a516.OCMtRbrJ.css","assets/chunks/chunk-BOR6-l-h.js","assets/chunks/chunk-DE0iSycl.js","assets/chunks/chunk-DbVzef6r.js","assets/chunks/chunk-BoQ6PaFT.js","assets/chunks/chunk-Ctk0asU8.js","assets/chunks/chunk-DYoRgzyy.js","assets/chunks/chunk-BZFSP8LM.js","assets/chunks/chunk-DaEGpryb.js"])))=>i.map(i=>d[i]);
import{_ as c}from"./chunk-BuZVacDv.js";import{_ as a}from"./chunk-DsYbGKja.js";import{as as d,fV as u,au as m,br as w,bs as _,at as y,aK as g,fL as f,aF as v,aL as V,N as H,fW as G,fX as $,ak as o,am as L}from"./chunk-B0S82j6z.js";import{i as b}from"./chunk-DH7Uqd89.js";let r=class extends d{get updating(){return this.graphicsView?.updating??!1}constructor(i){super(i),this._highlightCounts=new Map,this._graphicsViewLoader=null,this.graphics=new u,this.graphicsView=null,this.suspended=!1;const e=new m([255,255,255,1/255]);this._symbols=new Map([["point",new w({size:"2px",style:"square",color:e})],["polyline",new _({width:"2px",color:e})],["polygon",new y({outline:null,color:e})]])}highlight(i,e){const s=b(i);if(s.length===0)return g();let n,t=!1;return this.updatingHandles.addPromise(Promise.all([this._createHighlightGraphics(s),this._ensureGraphicsView3D()]).then(([h,p])=>{!t&&p&&(n=this._addHighlightGraphics(p,h,e))})),g(()=>{t=!0,n?.remove()})}preload(){this._ensureGraphicsView3D()}_addHighlightGraphics(i,e,s){for(const t of e)this._highlightCounts.set(t,(this._highlightCounts.get(t)??0)+1);this.graphics.addMany(e);const n=i.highlight(e,s);return g(()=>{this._removeHighlightGraphics(e),n.remove()})}_removeHighlightGraphics(i){this.graphics.removeMany(i.filter(e=>{const s=Math.max(0,(this._highlightCounts.get(e)??0)-1);return s===0?(this._highlightCounts.delete(e),!0):(this._highlightCounts.set(e,s),!1)}))}async _ensureGraphicsView3D(){if(this.graphicsView)return this.graphicsView;this._graphicsViewLoader||(this._graphicsViewLoader=c(()=>import("./chunk-DCfYb5Y0.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12])));const{default:i}=await this._graphicsViewLoader;if(this.destroyed)return null;const e=new i({view:this.view,layer:{type:"graphics-view-3d-dummy",id:this.layer.id,uid:this.layer.uid,elevationInfo:{mode:"on-the-ground"}},getGraphics:()=>this.graphics,drapeSourcePriorityOffset:.5});return this._set("graphicsView",e),this.addHandles([f(this.graphicsView),v(()=>this.suspended,s=>{e.suspended=s},V)]),e}async _createHighlightGraphics(i){const e=i.map(({geometry:t})=>t?.spatialReference).filter(H).reduce((t,h)=>(t.length!==0&&t.at(-1)?.equals(h)||t.push(h),t),[]),s=this.view.spatialReference,n=e.map(t=>({source:t,dest:s}));try{await G(n)}catch{return[]}return i.map(t=>{const{geometry:h}=t;try{const p=h?$(h,s):null,l=t.cloneShallow();return l.geometry=p,l.symbol=this._symbols.get(p?.type),l}catch{return t}})}};a([o()],r.prototype,"graphics",void 0),a([o()],r.prototype,"graphicsView",void 0),a([o()],r.prototype,"view",void 0),a([o()],r.prototype,"layer",void 0),a([o()],r.prototype,"updatingHandles",void 0),a([o()],r.prototype,"suspended",void 0),a([o()],r.prototype,"updating",null),r=a([L("esri.views.3d.layers.support.ImageHighlightHelper3D")],r);export{r as w};
