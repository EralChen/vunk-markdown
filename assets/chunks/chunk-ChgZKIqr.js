import{ar as s,as as i,au as v,s as g,f2 as x,F as E,aW as $,b9 as p,f3 as F,f4 as b}from"./chunk-CxUoqtmM.js";import{i as D}from"./chunk-CEobgZpQ.js";const O=c=>{let e=class extends c{constructor(){super(...arguments),this.view=null}get timeExtent(){return D(this.layer,this.view?.timeExtent,this._get("timeExtent"))}async fetchPopupFeaturesAtLocation(o,n){const{layer:r}=this;if(!o)throw new g("imagerylayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:r});const{popupEnabled:m}=r,u=x(r,n);if(!m||u==null)return[];const y=await u.getRequiredFields();E(n);const t=new $;t.timeExtent=this.timeExtent,t.geometry=o,t.outFields=y,t.outSpatialReference=o.spatialReference;const{resolution:a,spatialReference:l}=this.view,h=this.view.type==="2d"?new p(a,a,l):new p(.5*a,.5*a,l),{returnTopmostRaster:w,showNoDataRecords:d}=u.layerOptions||{returnTopmostRaster:!0,showNoDataRecords:!1},f={returnDomainValues:!0,returnTopmostRaster:w,pixelSize:h,showNoDataRecords:d,signal:n?.signal};return r.queryVisibleRasters(t,f).then(R=>R)}async getSourceScale(){return await b(),await this.layer.load(),F(this.layer.serviceRasterInfo,this.view.spatialReference)}canResume(){return!!super.canResume()&&!this.timeExtent?.isEmpty}};return s([i()],e.prototype,"layer",void 0),s([i()],e.prototype,"suspended",void 0),s([i({readOnly:!0})],e.prototype,"timeExtent",null),s([i()],e.prototype,"view",void 0),e=s([v("esri.views.layers.ImageryLayerView")],e),e};export{O as m};
