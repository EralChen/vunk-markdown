const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/chunks/chunk-DbiObNSB.js","assets/chunks/chunk-DsYbGKja.js","assets/chunks/chunk-BBnM6NiO.js","assets/static/style-35e9a516.OCMtRbrJ.css"])))=>i.map(i=>d[i]);
import{_ as g}from"./chunk-BBnM6NiO.js";import{dJ as b,dG as E,dH as F,dI as V,bs as N,rJ as x,rK as R,dE as $,rL as M,N as U,au as A,rM as O}from"./chunk-DbiObNSB.js";const T=/^-?(\d+)(\.(\d+))?$/i;function _(n,e){return n-e}function B(n,e){let t,o;return t=Number(n.toFixed(e)),t<n?o=t+1/10**e:(o=t,t-=1/10**e),t=Number(t.toFixed(e)),o=Number(o.toFixed(e)),[t,o]}function Q(n,e,t,o,l){const r=L(n,e,t,o),i=r.previous==null||r.previous<=l,a=r.next==null||r.next<=l;return i&&a||r.previous+r.next<=2*l}function y(n){const e=String(n),t=e.match(T);if(t?.[1])return{integer:t[1].split("").length,fractional:t[3]?t[3].split("").length:0};if(e.toLowerCase().includes("e")){const o=e.split("e"),l=o[0],r=o[1];if(l&&r){const i=Number(l);let a=Number(r);const s=a>0;s||(a=Math.abs(a));const u=y(i);return s?(u.integer+=a,a>u.fractional?u.fractional=0:u.fractional-=a):(u.fractional+=a,a>u.integer?u.integer=1:u.integer-=a),u}}return{integer:0,fractional:0}}function L(n,e,t,o){const l={previous:null,next:null};if(t!=null){const r=n-t,i=e-t-r;l.previous=Math.floor(Math.abs(100*i/r))}if(o!=null){const r=o-n,i=o-e-r;l.next=Math.floor(Math.abs(100*i/r))}return l}function tn(n,e={}){const t=n.slice(),{tolerance:o=2,strictBounds:l=!1,indexes:r=t.map((i,a)=>a)}=e;r.sort(_);for(let i=0;i<r.length;i++){const a=r[i],s=t[a],u=a===0?null:t[a-1],c=a===t.length-1?null:t[a+1],f=y(s).fractional;if(f){let m,p=0,d=!1;for(;p<=f&&!d;){const w=B(s,p);m=l&&i===0?w[1]:w[0],d=Q(s,m,u,c,o),p++}d&&(t[a]=m)}}return t}const S={maximumFractionDigits:20};function W(n){return b(n,S)}const q="<",D=">";function k(n,e,t,o){let l="";e===0?l=`${q} `:e===t&&(l=`${D} `);const r=j(n,o);return r==null?"":l+r}function K(n){const{format:e,fieldFormat:t}=n||{};return t?.type==="number"||!!e&&e.dateFormat==null&&(e.places!=null||e.digitSeparator!=null)}function j(n,e){if(n==null)return n;const{fieldType:t,format:o,fieldFormat:l,timeZoneOptions:r}=e||{};if(h(t))return E(n,{fieldType:t,format:o?.dateFormat,fieldFormat:l?.type==="date-time"?l:void 0,timeZoneOptions:r});if(typeof n=="string"&&K(e)){const a=Number(n);isNaN(a)||(n=a)}if(typeof n=="string")return n;const i=l?.type==="number"?F(l):o?V(o):void 0;return i?b(n,i):W(n)}const on=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII="];async function G(n){if(!("visualVariables"in n)||!n.visualVariables)return null;const e=n.visualVariables.find(i=>i.type==="color");if(!e)return null;let t=null,o=null;if(e.stops){if(e.stops.length===1)return e.stops[0].color;t=e.stops[0].value,o=e.stops[e.stops.length-1].value}const l=t!=null&&o!=null?t+(o-t)/2:0,{getColor:r}=await g(async()=>{const{getColor:i}=await import("./chunk-DbiObNSB.js").then(a=>a.MW);return{getColor:i}},__vite__mapDeps([0,1,2,3]));return r(e,l)??null}async function ln(n,e){const t=n.trailCap,o=n.trailWidth||1,l=e||await G(n)||n.color;return new N({cap:t,color:l,width:o})}function Z(n,e){if(!e)return null;if("featureReduction"in n)switch(n.featureReduction?.type){case"cluster":case"binning":{const t=n.featureReduction.fields.find(({name:o})=>o.toLowerCase()===e.toLowerCase());return t&&"getField"in n?n.getField(t.onStatisticField):null}}return"getField"in n?n.getField?.(e):null}function H(n,e){const t="popupTemplate"in n?n.popupTemplate?.fieldInfos:null;if(t?.length&&e)return t.find(o=>o.fieldName?.toLowerCase()===e.toLowerCase())}function v(n){let e=0,t=0;return n.stops?(e=n.stops?.at(0)?.value??e,t=n.stops?.at(-1)?.value??t):"minDataValue"in n&&"maxDataValue"in n&&(e=n.minDataValue??e,t=n.maxDataValue??t),t-e>2*M.days?"short-date":"short-date-short-time"}function h(n){return["date","date-only","time-only","timestamp-offset"].includes(n||"")}function I(n){return $(n)&&!("featureReduction"in n&&n.featureReduction)}function rn(n,e,t){const o=P(n,e.field,t);return o?(h(o.fieldType)&&(I(n)?o.fieldFormat??=new x({dateStyle:"short",timeStyle:v(e)==="short-date-short-time"?"short":null}):o.format??=new R({dateFormat:v(e)})),o):null}function P(n,e,t){const o=Z(n,e),l=o?.name;if(!l)return null;const r=o?.type,i=I(n);return{fieldType:r,format:i?null:H(n,l)?.format,fieldFormat:i?n.getFieldConfiguration(l)?.fieldFormat:null,timeZoneOptions:h(r)?{layerTimeZone:"preferredTimeZone"in n?n.preferredTimeZone:null,viewTimeZone:t,datesInUnknownTimezone:"datesInUnknownTimezone"in n&&n.datesInUnknownTimezone}:null}}function an(n,e){if("authoringInfo"in n)return n.authoringInfo?.visualVariables?.find(({theme:t})=>t===e)}function un(n,e){let t=n??"";return e!=null&&e&&(t=t?"("+t+") AND ("+e+")":e),t}const z=new A([64,64,64]);function C(n,e){const t=[],o=n.length-1;return n.length===5?t.push(0,2,4):t.push(0,o),n.map((l,r)=>t.includes(r)?k(l,r,o,e):null)}async function sn(n,e,t){let o=!1,l=[],r=[];if(n.stops){const u=n.stops;l=u.map(c=>c.value),o=u.some(c=>!!c.label),o&&(r=u.map(c=>c.label))}const i=l[0],a=l[l.length-1];if(i==null&&a==null)return null;const s=o?null:C(l,t);return(await Promise.all(l.map(async(u,c)=>{const f=n.type==="opacity"?await X(u,n,e):(await g(async()=>{const{getColor:p}=await import("./chunk-DbiObNSB.js").then(d=>d.MW);return{getColor:p}},__vite__mapDeps([0,1,2,3]))).getColor(n,u),m=o?r[c]:s?.[c]??"";return f==null?null:{value:u,color:f,label:m}}))).filter(U).reverse()}async function X(n,e,t){const o=new A(t??z),l=(await g(async()=>{const{getOpacity:r}=await import("./chunk-DbiObNSB.js").then(i=>i.MW);return{getOpacity:r}},__vite__mapDeps([0,1,2,3]))).getOpacity(e,n);return l!=null&&(o.a=l),o}function cn(n){let e=!1,t=[],o=[];t=n.map(a=>a.value),e=n.some(a=>!!a.label),e&&(o=n.map(a=>a.label??""));const l=t[0],r=t[t.length-1];if(l==null&&r==null)return null;const i=e?null:C(t);return t.map((a,s)=>({value:a,color:Y(a,n),label:e?o[s]:i?.[s]??""})).reverse()}function Y(n,e){const{startIndex:t,endIndex:o,weight:l}=J(n,e);if(t===o)return e[t].color;const r=A.blendColors(e[t].color,e[o].color,l);return new A(r)}function J(n,e){let t=0,o=e.length-1;return e.some((l,r)=>n<l.value?(o=r,!0):(t=r,!1)),{startIndex:t,endIndex:o,weight:(n-e[t].value)/(e[o].value-e[t].value)}}function An(n,e){let t=[];if(n&&n.type==="multipart")n.colorRamps.reverse().forEach((o,l)=>{l===0?t.push({value:e.max,color:new A(o.toColor),label:"high"}):t.push({value:null,color:new A(o.toColor),label:""}),l===n.colorRamps.length-1?t.push({value:e.min,color:new A(o.fromColor),label:"low"}):t.push({value:null,color:new A(o.fromColor),label:""})});else{let o,l;n&&n.type==="algorithmic"?(o=n.fromColor,l=n.toColor):(o=[0,0,0,1],l=[255,255,255,1]),t=[{value:e.max,color:new A(l),label:"high"},{value:e.min,color:new A(o),label:"low"}]}return t}function fn(n){if(!n.colorStops)return[];const e=[...n.colorStops].filter(o=>o.color?.a>0);let t=e.length-1;if(e&&e[0]){const o=e[t];o&&o.ratio!==1&&(e.push(new O({ratio:1,color:o.color})),t++)}return e.map((o,l)=>{let r="";return l===0?r=n.legendOptions?.minLabel||"low":l===t&&(r=n.legendOptions?.maxLabel||"high"),{color:o.color,label:r,ratio:o.ratio}}).reverse()}export{an as C,rn as V,q as a,cn as b,un as c,j as d,An as e,D as f,G as g,on as h,y as i,P as j,L as l,k as m,fn as r,Y as s,sn as t,tn as u,ln as w};
