import{bN as T,bO as E,bP as I,bQ as R,bR as c,bS as b,bT as w,bU as g,bV as A,bW as F,bX as O,bY as p,bf as D,bZ as d}from"./chunk-B_I7Twk5.js";function Z(t,a,e=null){const n=[],l=a.mapPositions;m(a,n);const o=n[0][1].data,u=n[0][1].indices.length,r=E(u);return y(a,n,r),U(a,n,r),S(a,n,r),v(a,n,r),C(a,n,r),N(a,n,r),z(a,n,o),new I(t,n,l,R.Line,e)}function m(t,a){const{attributeData:{position:e},removeDuplicateStartEnd:n}=t,l=L(e)&&n,o=e.length/3-(l?1:0),u=new Array(2*(o-1)),r=l?e.slice(0,-3):e;let i=0;for(let f=0;f<o-1;f++)u[i++]=f,u[i++]=f+1;a.push([c.POSITION,new b(r,u,3,l)])}function y(t,a,e){if(t.attributeData.colorFeature!=null)return;const n=t.attributeData.color;a.push([c.COLOR,new b(n??w,e,4)])}function S(t,a,e){t.attributeData.normal&&a.push([c.NORMAL,new b(t.attributeData.normal,e,3)])}function v(t,a,e){t.attributeData.colorFeature!=null&&a.push([c.COLORFEATUREATTRIBUTE,new b([t.attributeData.colorFeature],e,1,!0)])}function U(t,a,e){t.attributeData.sizeFeature==null&&a.push([c.SIZE,new b([t.attributeData.size??1],e,1,!0)])}function C(t,a,e){t.attributeData.sizeFeature!=null&&a.push([c.SIZEFEATUREATTRIBUTE,new b([t.attributeData.sizeFeature],e,1,!0)])}function N(t,a,e){t.attributeData.opacityFeature!=null&&a.push([c.OPACITYFEATUREATTRIBUTE,new b([t.attributeData.opacityFeature],e,1,!0)])}function z(t,a,e){if(t.overlayInfo==null||t.overlayInfo.renderCoordsHelper.viewingMode!==g.Global||!t.overlayInfo.spatialReference.isGeographic)return;const n=T(e.length),l=A(t.overlayInfo.spatialReference);for(let s=0;s<n.length;s+=3)F(e,s,n,s,l);const o=e.length/3,u=O(o+1);let r=P,i=B,f=0,h=0;p(r,n[h++],n[h++]),h++,u[0]=0;for(let s=1;s<o+1;++s)s===o&&(h=0),p(i,n[h++],n[h++]),h++,f+=d(r,i),u[s]=f,[r,i]=[i,r];a.push([c.DISTANCETOSTART,new b(u,a[0][1].indices,1,!0)])}function L(t){const a=t.length;return t[0]===t[a-3]&&t[1]===t[a-2]&&t[2]===t[a-1]}const P=D(),B=D();function j(t,a){if(t==null||t.length===0)return[];const e=[];return t.forEach(n=>{const l=n.length,o=T(3*l);n.forEach((r,i)=>{o[3*i]=r[0],o[3*i+1]=r[1],o[3*i+2]=r[2]});const u={attributeData:{position:o,normal:a},removeDuplicateStartEnd:!1};e.push(u)}),e}export{j as R,Z as b};
