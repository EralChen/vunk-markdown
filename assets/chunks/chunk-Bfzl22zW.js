import{d as c,j as T,k as h,s as U,g as C,a0 as w,a1 as V,l as N,p as P,h as Y,i as q}from"./chunk-DyqHK6XP.js";const i="vkStrategyRenderer";function x(e){return`${e}__data`}function B(e,n,t=i){const s=C(()=>e.data),p={data:s,emitSetData:u=>{n.emit("setData",{intoUndefined:V,...u})},getDataValue:u=>w(s.value,u,V,!0)};return P(x(t),p),p}function b(e=i){const n=`${e}__data`;return h(n,{})}const S=Symbol("PARENT_KEY");function A(e){return`${e}__templateInstances`}function m(e=i){return h(A(e),null)}function z(e=i){const n=m(e),t=U({});return t[S]=n,P(A(e),t),t}function G(e=i){const n=m(e),t=a=>a?.[S];return{templateInstances:n,getTemplateInstance:a=>{let o=n?.[a];if(o)return o;let p=t(n);for(;p;){if(o=p?.[a],o)return o;p=t(p)}return null},getParent:t}}function K(e){return c({setup(n,{slots:t}){const s=m(e),a=z(e);return s?()=>t.default?.({templateInstances:a}):()=>[t.placeholder?.(),t.default?.({templateInstances:a})]}})}function H(e){return e instanceof Function||typeof e=="function"}const J=e=>{if(typeof e=="boolean"){const n=e;return()=>n}else{if(typeof e=="string")return new Function("data",e);if(typeof e=="function")return e}return()=>!0},_={source:{type:Array,default:()=>[]},templateInstances:{type:Object,default:void 0},k:{type:Array,default:()=>[]}};function L(e){const n=c({props:_,inheritAttrs:!1,setup(t,s){const{templateInstances:a,getTemplateInstance:o}=G(e),{emitSetData:p,data:u,getDataValue:D}=b(e),$=d=>T(n,{templateInstances:a,...s.attrs,...d}),j=(d,E=[])=>d.reduce((f,r,F)=>{r.key=r.key??(Array.isArray(r.prop)?r.prop.join():r.prop);const g=[...t.k,...E,F],k=()=>{N(()=>{r.templateType&&!o(r.templateType)&&console.warn(r.templateType,"templateType不存在将跳过")})};if(r.templateType&&o(r.templateType)){const I=J(r.templateIf);if(!(u?I(u.value):!0))return f;const l={...r};Object.assign(l,H(r.templateProps)?r.templateProps(u?.value):r.templateProps),Reflect.deleteProperty(l,"templateType"),Reflect.deleteProperty(l,"templateIf"),Reflect.deleteProperty(l,"templateProps");const O=`${g.join(",")}-${r.templateType}-${r.prop||"no-prop"}`,R=C({get:()=>r.prop&&D?.(r.prop),set:y=>p?.({k:r.prop,v:y})}),v=o(r.templateType)?.slots.default?.({...s.attrs,raw:r,props:l,k:g,key:O,value:R.value,input:y=>R.value=y,templateIf:I,Renderer:$,getDataValue:D,emitSetData:p});v&&f.push(v)}else k();return f},[]);return()=>[s.slots.default?.(),j(t.source)]}});return n}function M(e){const n=K(e),t=L(e);return c({props:_,inheritAttrs:!1,setup(s,{slots:a,attrs:o}){return()=>T(n,{},{default:()=>T(t,{...o,...s},a.default),placeholder:a.placeholder})}})}const Q={data:{type:Object,default:()=>({})}},W={setData:e=>e};function X(e){return c({props:Q,emits:W,setup(n,{emit:t,slots:s}){const a=B(n,{emit:t},e);return()=>s.default?.(a)}})}const Z={type:{type:String,required:!0,default:""}};function ee(e){return c({props:Z,setup(n){const t=m(e);if(!t)throw new Error("VkRendererTemplate must be used inside a VkRenderer");const s=Y(),a=t[n.type];return s&&t&&(t[n.type]=s),q(()=>{t[n.type]=a}),()=>null}})}function te(e){return{Data:X(e),Renderer:M(e),Template:ee(e),Templates:K(e),useData:()=>b(e)}}const{Template:ae}=te();export{ae as V,te as c};
