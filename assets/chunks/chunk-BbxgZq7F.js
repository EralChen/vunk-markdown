import{_ as i}from"./chunk-DsYbGKja.js";import{ak as o,am as v,s as x,gh as E,fl as $,gi as F,n as _,gj as D,_ as m,gk as I,gl as N}from"./chunk-B0S82j6z.js";import{i as S}from"./chunk-BH-Z41XX.js";const V=c=>{const y=c;let e=class extends y{constructor(...s){super(...s),this.view=null}get timeExtent(){return S(this.layer,this.view?.timeExtent,this._get("timeExtent"))}async fetchPopupFeaturesAtLocation(s,l){const{layer:t}=this;if(!s)throw new x("imagerylayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:t});const{popupEnabled:h}=t,p=E(t,l);if(!h||p==null)return[];const w=await p.getRequiredFields(null,{index:new $(t.rasterFields),partitions:new Map([["$pixel",t.rasterFields.filter(r=>r.name.startsWith(F)).map(r=>r.name)],["$imageCollectionItem",t.fields.map(r=>r.name)]])});_(l);const a=new D;a.timeExtent=this.timeExtent,a.geometry=s,a.outFields=w,a.outSpatialReference=s.spatialReference;const{resolution:n,spatialReference:u}=this.view,d=this.view.type==="2d"?new m(n,n,u):new m(.5*n,.5*n,u),{returnTopmostRaster:f,showNoDataRecords:g}=p.layerOptions||{returnTopmostRaster:!0,showNoDataRecords:!1},R={returnDomainValues:!0,returnTopmostRaster:f,pixelSize:d,showNoDataRecords:g,signal:l?.signal};return t.queryVisibleRasters(a,R)}async getSourceScale(){return await N(),await this.layer.load(),I(this.layer.serviceRasterInfo,this.view.spatialReference)}canResume(){return!!super.canResume()&&!this.timeExtent?.isEmpty}};return i([o()],e.prototype,"layer",void 0),i([o()],e.prototype,"suspended",void 0),i([o({readOnly:!0})],e.prototype,"timeExtent",null),i([o()],e.prototype,"view",void 0),e=i([v("esri.views.layers.ImageryLayerView")],e),e};export{V as y};
