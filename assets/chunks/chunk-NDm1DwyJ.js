import{eb as v,b3 as I,cZ as w,eJ as A,cl as T,ch as h,cR as q,eK as L,eL as M,eM as O}from"./chunk-CuaFhuP3.js";function Z(e,r){return f(e)===f(r)}function f(e){if(e==null)return null;const r=e.layer!=null?e.layer.id:"";let t=null;return t=e.objectId!=null?e.objectId:e.layer!=null&&"objectIdField"in e.layer&&e.layer.objectIdField!=null&&e.attributes!=null?e.attributes[e.layer.objectIdField]:e.uid,t==null?null:`o-${r}-${t}`}const k={json:{write:{writer:P,target:{"feature.layerId":{type:[Number,String],isRequired:!0},"feature.objectId":{type:[Number,String],isRequired:!0}}},origins:{"web-scene":{read:x}}}};function P(e,r){e?.layer?.objectIdField!=null&&e.attributes!=null&&(r.feature={layerId:e.layer.id,objectId:e.attributes[e.layer.objectIdField]})}function x(e){if(e.layerId!=null&&e.objectId!=null)return{uid:null,layer:{id:e.layerId,objectIdField:"ObjectId"},attributes:{ObjectId:e.objectId}}}function z(e,r,t,l){const{sceneIntersectionHelper:R}=e,{observer:j,observerFeatureId:i,targetFeatureId:s,target:y}=t;if(i==null&&s==null)return;l||(l=n=>n),v(o,j,y);const u=w(o),a=1;A(o,j,o,a/u);const $=T(o,y,J);r.options.store=q.ALL,R.intersectToolIntersectorRay($,r);let g=null,m=null,d=null,c=null;for(const n of r.results.all){const S=L(n,e);if(S==null||n.distanceInRenderSpace==null)continue;const b=f(S);b!=null&&(i!=null&&b===i&&(g??=l(p(n,e,u)),n.distanceInRenderSpace-a<g&&(d=n)),s!=null&&b===s&&(m??=l(p(n,e,u)),c==null&&n.distanceInRenderSpace-a<u&&u-n.distanceInRenderSpace+a<m&&(c=n)))}const{observerAdjusted:F,targetAdjusted:N}=t;d?.getIntersectionPoint(F)?t.observerSurfaceNormal=d.getTransformedNormal(I()):t.observerSurfaceNormal=null,c?.getIntersectionPoint(N)?t.targetSurfaceNormal=c.getTransformedNormal(I()):t.targetSurfaceNormal=null}function p(e,r,t){if(M(e)){const l=O(e,r);if(l!=null)return Math.min(l*H,t)}return 1e-5*t}const H=.05,J=h(),o=I();export{k as b,Z as c,f as d,z as m};
