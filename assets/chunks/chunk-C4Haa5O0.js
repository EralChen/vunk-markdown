import{ai as s,aj as i,al as g,s as v,gi as x,n as E,aO as $,a2 as p,gj as D,gk as F}from"./chunk-Dx0VeHfy.js";import{i as N}from"./chunk-T1gcu7De.js";const T=c=>{let e=class extends c{constructor(){super(...arguments),this.view=null}get timeExtent(){return N(this.layer,this.view?.timeExtent,this._get("timeExtent"))}async fetchPopupFeaturesAtLocation(o,n){const{layer:a}=this;if(!o)throw new v("imagerylayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:a});const{popupEnabled:m}=a,l=x(a,n);if(!m||l==null)return[];const y=await l.getRequiredFields();E(n);const t=new $;t.timeExtent=this.timeExtent,t.geometry=o,t.outFields=y,t.outSpatialReference=o.spatialReference;const{resolution:r,spatialReference:u}=this.view,h=this.view.type==="2d"?new p(r,r,u):new p(.5*r,.5*r,u),{returnTopmostRaster:w,showNoDataRecords:d}=l.layerOptions||{returnTopmostRaster:!0,showNoDataRecords:!1},R={returnDomainValues:!0,returnTopmostRaster:w,pixelSize:h,showNoDataRecords:d,signal:n?.signal};return a.queryVisibleRasters(t,R).then((f=>f))}async getSourceScale(){return await F(),await this.layer.load(),D(this.layer.serviceRasterInfo,this.view.spatialReference)}canResume(){return!!super.canResume()&&!this.timeExtent?.isEmpty}};return s([i()],e.prototype,"layer",void 0),s([i()],e.prototype,"suspended",void 0),s([i({readOnly:!0})],e.prototype,"timeExtent",null),s([i()],e.prototype,"view",void 0),e=s([g("esri.views.layers.ImageryLayerView")],e),e};export{T as m};
