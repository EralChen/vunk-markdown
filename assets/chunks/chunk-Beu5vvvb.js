import{A as ue,s as z,_ as g,I as P,v as p,G as v,Y as y,L as K,e as V,a as fe,n as h,C as S,D as Y,b as f,y as A,c as pe,m as G,d as we,W as D,f as L,g as O,H as J,h as de,i as q,r as he,j as _,B as Q,U as X,k as $,l as me,E as ge,o as ye,p as be,q as ve,t as Se,u as T,w as xe,x as Ie}from"./chunk-_29cwqVn.js";import{a as i,r as l,u as ee}from"./chunk-3soI_HCn.js";import{registerFunctions as Fe}from"./chunk-DZwSKTsF.js";import{bc as re,a_ as ke,hd as d,he as k,hf as H,hg as N,fu as C}from"./chunk-CxUoqtmM.js";import"./chunk-BU9ye7sd.js";import"./chunk-BPVd6ESQ.js";import"./chunk-Csk7GidS.js";import"./chunk-CyAL0fYB.js";import"./chunk-iXaaBraQ.js";import"./chunk-Di8CcnDC.js";import"./chunk-CcEbRgUF.js";import"./chunk-BmvPW8CJ.js";import"./chunk-Cvu9Eul1.js";import"./chunk-RlmIMeXG.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */async function j(r,e){const o=[];for(let n=0;n<e.arguments.length;n++)o.push(await u(r,e.arguments[n]));return o}async function F(r,e,o){return e.preparsed===!0?o(r,null,e.arguments):o(r,e,await j(r,e))}class Me extends he{constructor(e,o){super(),this.definition=null,this.context=null,this.definition=e,this.context=o}createFunction(e){return(...o)=>{const n={spatialReference:this.context.spatialReference,console:this.context.console,lrucache:this.context.lrucache,timeZone:this.context.timeZone??null,exports:this.context.exports,libraryResolver:this.context.libraryResolver,interceptor:this.context.interceptor,localScope:{},depthCounter:{depth:e.depthCounter+1},globalScope:this.context.globalScope};if(n.depthCounter.depth>64)throw new i(e,l.MaximumCallDepth,null);return Z(this.definition,n,o,null)}}call(e,o){return B(e,o,(n,t,a)=>{const s={spatialReference:e.spatialReference,services:e.services,console:e.console,libraryResolver:e.libraryResolver,exports:e.exports,lrucache:e.lrucache,timeZone:e.timeZone??null,interceptor:e.interceptor,localScope:{},abortSignal:e.abortSignal,globalScope:e.globalScope,depthCounter:{depth:e.depthCounter.depth+1}};if(s.depthCounter.depth>64)throw new i(e,l.MaximumCallDepth,o);return Z(this.definition,s,a,o)})}marshalledCall(e,o,n,t){return t(e,o,async(a,s,c)=>{const x={spatialReference:e.spatialReference,globalScope:n.globalScope,depthCounter:{depth:e.depthCounter.depth+1},libraryResolver:e.libraryResolver,exports:e.exports,console:e.console,abortSignal:e.abortSignal,lrucache:e.lrucache,timeZone:e.timeZone??null,interceptor:e.interceptor,localScope:{}};return c=c.map(b=>!v(b)||b instanceof q?b:_(b,e,t)),_(await Z(this.definition,x,c,o),n,t)})}}class M extends de{constructor(e){super(),this.source=e}global(e){const o=this.executingContext.globalScope[h(e)];if(v(o.value)&&!(o.value instanceof q)){const n=new q;n.fn=o.value,n.parameterEvaluator=B,n.context=this.executingContext,o.value=n}return o.value}setGlobal(e,o){if(v(o))throw new i(null,l.AssignModuleFunction,null);this.executingContext.globalScope[h(e)]={value:o}}hasGlobal(e){return this.executingContext.exports[e]===void 0&&(e=h(e)),this.executingContext.exports[e]!==void 0}async loadModule(e){let o=e.spatialReference;o==null&&(o=new re({wkid:102100})),this.moduleScope=se({},e.customfunctions,e.timeZone),this.executingContext={spatialReference:o,services:e.services,libraryResolver:new z(e.libraryResolver._moduleSingletons,this.source.syntax.loadedModules),exports:{},abortSignal:e.abortSignal===void 0||e.abortSignal===null?{aborted:!1}:e.abortSignal,globalScope:this.moduleScope,console:e.console??ce,lrucache:e.lrucache,timeZone:e.timeZone??null,interceptor:e.interceptor,localScope:null,depthCounter:{depth:1}},await W(this.executingContext,this.source.syntax)}}async function B(r,e,o){return e.preparsed===!0?o(r,null,e.arguments):o(r,e,await j(r,e))}async function u(r,e){e.breakpoint&&await e.breakpoint();try{switch(e.type){case"UpdateExpression":return await De(r,e);case"AssignmentExpression":return await Ke(r,e);case"TemplateLiteral":return await Ye(r,e);case"Identifier":return U(r,e);case"MemberExpression":return await je(r,e);case"Literal":return e.value;case"CallExpression":return await ze(r,e);case"UnaryExpression":return await We(r,e);case"BinaryExpression":return await Te(r,e);case"LogicalExpression":return await He(r,e);case"ArrayExpression":return await _e(r,e);case"ObjectExpression":return await Ce(r,e);default:throw new i(r,l.Unrecognized,e)}}catch(o){throw ee(r,e,o)}}async function m(r,e){e.breakpoint&&await e.breakpoint();try{switch(e.type){case"ImportDeclaration":return await qe(r,e);case"ExportNamedDeclaration":return await Pe(r,e);case"VariableDeclaration":return await ae(r,e,0);case"BlockStatement":return await W(r,e);case"FunctionDeclaration":return await Le(r,e);case"ReturnStatement":return await Ge(r,e);case"IfStatement":return await Ze(r,e);case"ExpressionStatement":return await Ue(r,e);case"ForStatement":return await Ae(r,e);case"WhileStatement":return await Re(r,e);case"ForInStatement":return await Be(r,e);case"ForOfStatement":return await Ee(r,e);case"BreakStatement":return y;case"EmptyStatement":return p;case"ContinueStatement":return K;default:throw new i(r,l.Unrecognized,e)}}catch(o){throw ee(r,e,o)}}async function Ce(r,e){const o=[];for(let s=0;s<e.properties.length;s++){const c=e.properties[s],x=await u(r,c.value),b=c.key.type==="Identifier"?c.key.name:await u(r,c.key);o[s]={key:b,value:x}}const n={},t=new Map;for(let s=0;s<o.length;s++){const c=o[s];if(v(c.value))throw new i(r,l.NoFunctionInDictionary,e);if(d(c.key)===!1)throw new i(r,l.KeyMustBeString,e);let x=c.key.toString();const b=x.toLowerCase();t.has(b)?x=t.get(b):t.set(b,x),c.value===p?n[x]=null:n[x]=c.value}const a=new S(n);return a.immutable=!1,a}async function Re(r,e){let o=await u(r,e.test);if(o===!1)return p;if(o!==!0)throw new i(r,l.BooleanConditionRequired,e);for(;o===!0;){const n=await m(r,e.body);if(n===y)break;if(n instanceof g)return n;if(o=await u(r,e.test),o!==!0&&o!==!1)throw new i(r,l.BooleanConditionRequired,e)}return p}async function Ae(r,e){try{for(e.init!==null&&(e.init.type==="VariableDeclaration"?await m(r,e.init):await u(r,e.init));;){if(e.test!==null){const n=await u(r,e.test);if(r.abortSignal?.aborted===!0)throw new i(r,l.Cancelled,e);if(n===!1)break;if(n!==!0)throw new i(r,l.BooleanConditionRequired,e)}const o=await m(r,e.body);if(o===y)break;if(o instanceof g)return o;e.update!==null&&await u(r,e.update)}return p}catch(o){throw o}}async function E(r,e,o,n,t="i"){const a=o.length;for(let s=0;s<a;s++){if(t==="k"){if(s>=o.length)throw new i(r,l.OutOfBounds,e);n.value=o[s]}else n.value=s;const c=await m(r,e.body);if(c===y)break;if(c instanceof g)return c}return p}async function oe(r,e,o,n,t="i"){const a=o.length();for(let s=0;s<a;s++){n.value=t==="k"?o.get(s):s;const c=await m(r,e.body);if(c===y)break;if(c instanceof g)return c}return p}async function ne(r,e,o,n){const t=o.iterator(r.abortSignal);let a;for(;(a=await t.next())!=null;){const s=Y.createFromGraphicLikeObject(a.geometry,a.attributes,o,r.timeZone);s._underlyingGraphic=a,n.value=s;const c=await m(r,e.body);if(c===y)break;if(c instanceof g)return c}return p}async function Oe(r,e,o,n){for(const t of o.keys()){const a=o.field(t);n.value=new S({key:t,value:a});const s=await m(r,e.body);if(s===y)break;if(s instanceof g)return s}return p}async function Ne(r,e,o,n){for(const t of $(o)){const a=L(o,t,r,e,1);n.value=new S({key:t,value:a});const s=await m(r,e.body);if(s===y)break;if(s instanceof g)return s}return p}async function Be(r,e){const o=await u(r,e.right);e.left.type==="VariableDeclaration"&&await m(r,e.left);const n=h(e.left.type==="VariableDeclaration"?e.left.declarations[0].id:e.left);let t=null;if(r.localScope!=null&&r.localScope[n]!==void 0&&(t=r.localScope[n]),t===null&&r.globalScope[n]!==void 0&&(t=r.globalScope[n]),t===null)throw new i(r,l.InvalidIdentifier,e);return N(o)||d(o)?await E(r,e,o,t):O(o)?await oe(r,e,o,t):o instanceof S||D(o)?await E(r,e,o.keys(),t,"k"):Q(o)?await ne(r,e,o,t):X(o)?await E(r,e,$(o),t,"k"):p}async function Ee(r,e){const o=await u(r,e.right);e.left.type==="VariableDeclaration"&&await m(r,e.left);const n=h(e.left.type==="VariableDeclaration"?e.left.declarations[0].id:e.left);let t=null;if(r.localScope!=null&&r.localScope[n]!==void 0&&(t=r.localScope[n]),t===null&&r.globalScope[n]!==void 0&&(t=r.globalScope[n]),t===null)throw new i(r,l.InvalidIdentifier,e);return N(o)||d(o)?await E(r,e,o,t,"k"):O(o)?await oe(r,e,o,t,"k"):o instanceof S||D(o)?await Oe(r,e,o,t):Q(o)?await ne(r,e,o,t):X(o)?await Ne(r,e,o,t):p}async function De(r,e){const o=e.argument;if(o.type==="CallExpression")throw new i(r,l.NeverReach,e);if(o.type==="MemberExpression"){const a=await u(r,o.object);let s,c;if(o.computed===!0)s=await u(r,o.property);else{if(o.property.type!=="Identifier")throw new i(r,l.Unrecognized,e);s=o.property.name}if(N(a)){if(!C(s))throw new i(r,l.ArrayAccessorMustBeNumber,e);if(s<0&&(s=a.length+s),s<0||s>=a.length)throw new i(r,l.OutOfBounds,e);c=f(a[s]),a[s]=e.operator==="++"?c+1:c-1}else if(a instanceof S){if(d(s)===!1)throw new i(r,l.KeyAccessorMustBeString,e);if(a.hasField(s)!==!0)throw new i(r,l.FieldNotFound,e,{key:s});c=f(a.field(s)),a.setField(s,e.operator==="++"?c+1:c-1)}else if(a instanceof M){if(d(s)===!1)throw new i(r,l.ModuleAccessorMustBeString,e);if(a.hasGlobal(s)!==!0)throw new i(r,l.ModuleExportNotFound,e);c=f(a.global(s)),a.setGlobal(s,e.operator==="++"?c+1:c-1)}else{if(!J(a))throw O(a)?new i(r,l.Immutable,e):new i(r,l.InvalidParameter,e);if(d(s)===!1)throw new i(r,l.KeyAccessorMustBeString,e);if(a.hasField(s)!==!0)throw new i(r,l.FieldNotFound,e,{key:s});c=f(a.field(s)),a.setField(s,e.operator==="++"?c+1:c-1)}return e.prefix===!1?c:e.operator==="++"?c+1:c-1}const n=h(o);let t;if(r.localScope!=null&&r.localScope[n]!==void 0)return t=f(r.localScope[n].value),r.localScope[n]={value:e.operator==="++"?t+1:t-1},e.prefix===!1?t:e.operator==="++"?t+1:t-1;if(r.globalScope[n]!==void 0)return t=f(r.globalScope[n].value),r.globalScope[n]={value:e.operator==="++"?t+1:t-1},e.prefix===!1?t:e.operator==="++"?t+1:t-1;throw new i(r,l.InvalidIdentifier,e)}function I(r,e,o,n,t){switch(e){case"=":return r===p?null:r;case"/=":return f(o)/f(r);case"*=":return f(o)*f(r);case"-=":return f(o)-f(r);case"+=":return d(o)||d(r)?A(o)+A(r):f(o)+f(r);case"%=":return f(o)%f(r);default:throw new i(t,l.UnsupportedOperator,n)}}async function Ke(r,e){const o=e.left;if(o.type==="MemberExpression"){const t=await u(r,o.object);let a;if(o.computed===!0)a=await u(r,o.property);else{if(o.property.type!=="Identifier")throw new i(r,l.InvalidIdentifier,e);a=o.property.name}const s=await u(r,e.right);if(N(t)){if(!C(a))throw new i(r,l.ArrayAccessorMustBeNumber,e);if(a<0&&(a=t.length+a),a<0||a>t.length)throw new i(r,l.OutOfBounds,e);if(a===t.length){if(e.operator!=="=")throw new i(r,l.OutOfBounds,e);t[a]=I(s,e.operator,t[a],e,r)}else t[a]=I(s,e.operator,t[a],e,r)}else if(t instanceof S){if(d(a)===!1)throw new i(r,l.KeyAccessorMustBeString,e);if(t.hasField(a)===!0)t.setField(a,I(s,e.operator,t.field(a),e,r));else{if(e.operator!=="=")throw new i(r,l.FieldNotFound,e,{key:a});t.setField(a,I(s,e.operator,null,e,r))}}else if(t instanceof M){if(d(a)===!1)throw new i(r,l.KeyAccessorMustBeString,e);if(t.hasGlobal(a)!==!0)throw new i(r,l.ModuleExportNotFound,e);t.setGlobal(a,I(s,e.operator,t.global(a),e,r))}else{if(!J(t))throw O(t)?new i(r,l.Immutable,e):new i(r,l.InvalidParameter,e);if(d(a)===!1)throw new i(r,l.KeyAccessorMustBeString,e);if(t.hasField(a)===!0)t.setField(a,I(s,e.operator,t.field(a),e,r));else{if(e.operator!=="=")throw new i(r,l.FieldNotFound,e,{key:a});t.setField(a,I(s,e.operator,null,e,r))}}return p}const n=h(o);if(r.localScope!=null&&r.localScope[n]!==void 0){const t=await u(r,e.right);return r.localScope[n]={value:I(t,e.operator,r.localScope[n].value,e,r)},p}if(r.globalScope[n]!==void 0){const t=await u(r,e.right);return r.globalScope[n]={value:I(t,e.operator,r.globalScope[n].value,e,r)},p}throw new i(r,l.InvalidIdentifier,e)}async function Ue(r,e){const o=await u(r,e.expression);return o===p?p:new P(o)}async function Ze(r,e){const o=await u(r,e.test);if(o===!0)return m(r,e.consequent);if(o===!1)return e.alternate!==null?m(r,e.alternate):p;throw new i(r,l.BooleanConditionRequired,e)}async function W(r,e){return te(r,e,0)}async function te(r,e,o){if(o>=e.body.length)return p;const n=await m(r,e.body[o]);return n instanceof g||n===y||n===K||o===e.body.length-1?n:te(r,e,o+1)}async function Ge(r,e){if(e.argument===null)return new g(p);const o=await u(r,e.argument);return new g(o)}async function Le(r,e){const o=h(e.id);return r.globalScope[o]={value:new Me(e,r)},p}async function qe(r,e){const o=h(e.specifiers[0].local),n=r.libraryResolver.loadLibrary(o);let t;return r.libraryResolver._moduleSingletons?.has(n.uri)?t=r.libraryResolver._moduleSingletons.get(n.uri):(t=new M(n),await t.loadModule(r),r.libraryResolver._moduleSingletons?.set(n.uri,t)),r.globalScope[o]={value:t},p}async function Pe(r,e){if(await m(r,e.declaration),e.declaration.type==="FunctionDeclaration")r.exports[h(e.declaration.id)]="function";else if(e.declaration.type==="VariableDeclaration")for(const o of e.declaration.declarations)r.exports[h(o.id)]="variable";return p}async function ae(r,e,o){return o>=e.declarations.length?p:(await Ve(r,e.declarations[o]),o===e.declarations.length-1||await ae(r,e,o+1),p)}async function Ve(r,e){let o=null;if(o=e.init===null?null:await u(r,e.init),r.localScope!==null){if(o===p&&(o=null),e.id.type!=="Identifier")throw new i(r,l.InvalidIdentifier,e);const t=h(e.id);return void(r.localScope!=null&&(r.localScope[t]={value:o}))}if(e.id.type!=="Identifier")throw new i(r,l.InvalidIdentifier,e);const n=h(e.id);o===p&&(o=null),r.globalScope[n]={value:o}}async function je(r,e){const o=await u(r,e.object);if(o===null)throw new i(r,l.MemberOfNull,e);if(e.computed===!1){if(e.property.type==="Identifier"){if(o instanceof S||D(o))return o.field(e.property.name);if(o instanceof H)return L(o,e.property.name,r,e);if(o instanceof M){if(!o.hasGlobal(e.property.name))throw new i(r,l.InvalidIdentifier,e);return o.global(e.property.name)}throw new i(r,l.InvalidMemberAccessKey,e)}throw new i(r,l.InvalidMemberAccessKey,e)}let n=await u(r,e.property);if(o instanceof S||D(o)){if(d(n))return o.field(n);throw new i(r,l.InvalidMemberAccessKey,e)}if(o instanceof M){if(d(n))return o.global(n);throw new i(r,l.InvalidMemberAccessKey,e)}if(o instanceof H){if(d(n))return L(o,n,r,e);throw new i(r,l.InvalidMemberAccessKey,e)}if(N(o)){if(C(n)&&isFinite(n)&&Math.floor(n)===n){if(n<0&&(n=o.length+n),n>=o.length||n<0)throw new i(r,l.OutOfBounds,e);return o[n]}throw new i(r,l.InvalidMemberAccessKey,e)}if(O(o)){if(C(n)&&isFinite(n)&&Math.floor(n)===n){if(n<0&&(n=o.length()+n),n>=o.length()||n<0)throw new i(r,l.OutOfBounds,e);return o.get(n)}throw new i(r,l.InvalidMemberAccessKey,e)}if(d(o)){if(C(n)&&isFinite(n)&&Math.floor(n)===n){if(n<0&&(n=o.length+n),n>=o.length||n<0)throw new i(r,l.OutOfBounds,e);return o[n]}throw new i(r,l.InvalidMemberAccessKey,e)}throw new i(r,l.InvalidMemberAccessKey,e)}async function We(r,e){const o=await u(r,e.argument);if(k(o)){if(e.operator==="!")return!o;if(e.operator==="-")return-1*f(o);if(e.operator==="+")return 1*f(o);if(e.operator==="~")return~f(o);throw new i(r,l.UnsupportedUnaryOperator,e)}if(e.operator==="-")return-1*f(o);if(e.operator==="+")return 1*f(o);if(e.operator==="~")return~f(o);throw new i(r,l.UnsupportedUnaryOperator,e)}async function _e(r,e){const o=[];for(let n=0;n<e.elements.length;n++)o.push(await u(r,e.elements[n]));for(let n=0;n<o.length;n++){if(v(o[n]))throw new i(r,l.NoFunctionInArray,e);o[n]===p&&(o[n]=null)}return o}async function Te(r,e){const o=await u(r,e.left),n=await u(r,e.right);switch(e.operator){case"|":case"<<":case">>":case">>>":case"^":case"&":return we(f(o),f(n),e.operator);case"==":return G(o,n);case"!=":return!G(o,n);case"<":case">":case"<=":case">=":return pe(o,n,e.operator);case"+":return d(o)||d(n)?A(o)+A(n):f(o)+f(n);case"-":return f(o)-f(n);case"*":return f(o)*f(n);case"/":return f(o)/f(n);case"%":return f(o)%f(n);default:throw new i(r,l.UnsupportedOperator,e)}}async function He(r,e){const o=await u(r,e.left);if(!k(o))throw new i(r,l.LogicalExpressionOnlyBoolean,e);switch(e.operator){case"||":{if(o===!0)return o;const n=await u(r,e.right);if(k(n))return n;throw new i(r,l.LogicExpressionOrAnd,e)}case"&&":{if(o===!1)return o;const n=await u(r,e.right);if(k(n))return n;throw new i(r,l.LogicExpressionOrAnd,e)}default:throw new i(r,l.LogicExpressionOrAnd,e)}}function U(r,e){const o=h(e);if(r.localScope!=null&&r.localScope[o]!==void 0)return r.localScope[o].value;if(r.globalScope[o]!==void 0)return r.globalScope[o].value;throw new i(r,l.InvalidIdentifier,e)}async function ze(r,e){if(e.callee.type==="MemberExpression"){const n=await u(r,e.callee.object);if(!(n instanceof M))throw new i(r,l.FunctionNotFound,e);const t=e.callee.computed===!1?e.callee.property.name:await u(r,e.callee.property);if(!n.hasGlobal(t))throw new i(r,l.FunctionNotFound,e);const a=n.global(t);if(!v(a))throw new i(r,l.CallNonFunction,e);return a.call(r,e)}if(e.callee.type!=="Identifier")throw new i(r,l.FunctionNotFound,e);const o=h(e.callee);if(r.localScope!=null&&r.localScope[o]!==void 0){const n=r.localScope[o];if(v(n.value))return n.value.call(r,e);throw new i(r,l.CallNonFunction,e)}if(r.globalScope[o]!==void 0){const n=r.globalScope[o];if(v(n.value))return n.value.call(r,e);throw new i(r,l.CallNonFunction,e)}throw new i(r,l.FunctionNotFound,e)}async function Ye(r,e){let o="",n=0;for(const t of e.quasis)if(o+=t.value?t.value.cooked:"",t.tail===!1){if(e.expressions[n]){const a=await u(r,e.expressions[n]);if(v(a))throw new i(r,l.NoFunctionInTemplateLiteral,e);o+=A(a)}n++}return o}const w={};async function ie(r,e,o,n){const t=await u(r,e.arguments[o]);if(G(t,n))return u(r,e.arguments[o+1]);const a=e.arguments.length-o;return a===1?u(r,e.arguments[o]):a===2?null:a===3?u(r,e.arguments[o+2]):ie(r,e,o+2,n)}async function le(r,e,o,n){if(n===!0)return u(r,e.arguments[o+1]);if(e.arguments.length-o===3)return u(r,e.arguments[o+2]);const t=await u(r,e.arguments[o+2]);if(k(t)===!1)throw new i(r,l.ModuleExportNotFound,e.arguments[o+2]);return le(r,e,o+2,t)}async function Z(r,e,o,n){const t=r.body;if(o.length!==r.params.length)throw new i(e,l.WrongNumberOfParameters,null);for(let s=0;s<o.length;s++){const c=r.params[s];c.type==="Identifier"&&e.localScope!=null&&(e.localScope[h(c)]={value:o[s]})}const a=await m(e,t);if(a instanceof g)return a.value;if(a===y)throw new i(e,l.UnexpectedToken,n);if(a===K)throw new i(e,l.UnexpectedToken,n);return a instanceof P?a.value:a}me(w,F),ge(w,F),ye(w,F,U),be(w,F),ve(w,F),Se(w,F),Fe({functions:w,compiled:!1,signatures:null,evaluateIdentifier:null,mode:"async",standardFunction:F,standardFunctionAsync:B}),w.iif=async function(r,e){T(e.arguments===null?[]:e.arguments,3,3,r,e);const o=await u(r,e.arguments[0]);if(k(o)===!1)throw new i(r,l.BooleanConditionRequired,e);return u(r,o?e.arguments[1]:e.arguments[2])},w.defaultvalue=async function(r,e){T(e.arguments===null?[]:e.arguments,2,3,r,e);const o=await u(r,e.arguments[0]);if(e.arguments.length===3){const n=await u(r,e.arguments[1]),t=xe(o,n);return t!=null&&t!==""?t:u(r,e.arguments[2])}return o==null||o===""?u(r,e.arguments[1]):o},w.decode=async function(r,e){if(e.arguments.length<2)throw new i(r,l.WrongNumberOfParameters,e);if(e.arguments.length===2)return u(r,e.arguments[1]);if((e.arguments.length-1)%2==0)throw new i(r,l.WrongNumberOfParameters,e);return ie(r,e,1,await u(r,e.arguments[0]))},w.when=async function(r,e){if(e.arguments.length<3)throw new i(r,l.WrongNumberOfParameters,e);if(e.arguments.length%2==0)throw new i(r,l.WrongNumberOfParameters,e);const o=await u(r,e.arguments[0]);if(k(o)===!1)throw new i(r,l.BooleanConditionRequired,e.arguments[0]);return le(r,e,0,o)};const Je={fixSpatialReference:ue,parseArguments:j,standardFunction:F,standardFunctionAsync:B,evaluateIdentifier:U};for(const r in w)w[r]={value:new V(w[r])};const R=function(){};function se(r,e,o){const n=new R;r==null&&(r={}),e==null&&(e={});const t=new S({newline:`
`,tab:"	",singlequote:"'",doublequote:'"',forwardslash:"/",backwardslash:"\\"});t.immutable=!1,n.textformatting={value:t};for(const a in e)n[a]={value:new V(e[a])};for(const a in r)n[a]={value:ke(r[a])?Y.createFromGraphic(r[a],o):r[a]};return n}function ce(r){console.log(r)}R.prototype=w,R.prototype.infinity={value:Number.POSITIVE_INFINITY},R.prototype.pi={value:Math.PI};const zr=Je;function Qe(r){const e={mode:"async",compiled:!1,functions:{},signatures:[],standardFunction:F,standardFunctionAsync:B,evaluateIdentifier:U};for(let o=0;o<r.length;o++)r[o].registerFunctions(e);for(const o in e.functions)w[o]={value:new V(e.functions[o])},R.prototype[o]=w[o];for(let o=0;o<e.signatures.length;o++)fe(e.signatures[o],"async")}async function Yr(r,e){let o=e.spatialReference;o==null&&(o=new re({wkid:102100}));let n=null;r.usesModules&&(n=new z(new Map,r.loadedModules));const t=se(e.vars,e.customfunctions,e.timeZone),a={spatialReference:o,services:e.services,exports:{},libraryResolver:n,abortSignal:e.abortSignal===void 0||e.abortSignal===null?{aborted:!1}:e.abortSignal,globalScope:t,console:e.console??ce,timeZone:e.timeZone??null,lrucache:e.lrucache,interceptor:e.interceptor,localScope:null,depthCounter:{depth:1}},s=await W(a,r);if(s instanceof g||s instanceof P){const c=s.value;if(c===p)return null;if(v(c))throw new i(a,l.IllegalResult,null);return c}if(s===p)return null;throw s===y?new i(a,l.IllegalResult,null):s===K?new i(a,l.IllegalResult,null):new i(a,l.NeverReach,null)}Qe([Ie]);export{Yr as executeScript,Qe as extend,zr as functionHelper};
